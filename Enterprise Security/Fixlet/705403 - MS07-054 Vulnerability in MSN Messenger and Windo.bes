<?xml version="1.0" encoding="UTF-8"?>
<BES xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="BES.xsd">
	<Fixlet>
		<Title>MS07-054: Vulnerability in MSN Messenger and Windows Live Messenger Could Allow Remote Code Execution - MSN Messenger 6.2/7.0/7.5/8.0 - Windows XP/2003/Vista</Title>
		<Description><![CDATA[
<DIV class=FixletMessage>
<b>Note:</b> This fixlet used to point to an install of MSN Messenger 8.1. Microsoft has taken this link down, so now the fixlet installs Windows Live Messenger 8.5 instead. <BR><BR><b>Note: </b>The standalone installer file for Windows Live Messenger is not distributed by Microsoft. Microsoft instead uses a dynamic installer. The msi files have to be manually cached on the BES Server. To get the Windows Live Messenger 8.5 files, download Windows Live Messenger 8.5 and run WLinstaller.exe and install Live Messenger. After you install messenger, the msi file should be in Program Files\Common Files\WindowsLiveInstaller\MsiSources\Install_{508CE775-4BA4-4748-82DF-FE28DA9F03B0}.msi<BR><BR>Microsoft has released an update that resolves a publicly disclosed vulnerability in MSN Messenger and Windows Live Messenger. The vulnerability could allow remote code execution when a user accepts a webcam or video chat invitation from an attacker. An attacker who successfully exploited this vulnerability could take complete control of the affected system. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.<BR><BR><b>Note: </b>Affected computers may report back as 'Pending Restart' once the patch has run successfully, but will not report back their final status until the computer has been restarted.<BR><BR><b>Note: </b>Client machines may briefly display progress windows during installation of this update.<BR><BR><b>Note: </b>Applying this patch may cause open instances of MSN Messenger to be closed. <BR><BR><b>Note:</b> This Fixlet message does not have a default action. For more information on default actions, see BigFix KB #474.
</DIV>
<DIV class=FixletProperty>
<H4>File Size:</H4>
16.3 MB
 </DIV>]]></Description>
		<Relevance>(if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )</Relevance>
		<Relevance>(language of version block of file "kernel32.dll" of system folder contains "English") OR (exists value of key "HKLM\System\CurrentControlSet\Control\Nls\MUILanguages" of registry)</Relevance>
		<Relevance>not exists key "HKLM\Software\Wow6432Node\Microsoft\Windows\CurrentVersion" whose (exists value "ProductId" of it OR exists value "CommonFilesDir" of it) of registry AND not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry</Relevance>
		<Relevance>((service pack major version of operating system = 2) AND (name of operating system as lowercase = "winxp")) OR (name of operating system = "Win2003" AND (service pack major version of operating system = 2)) OR (((name of operating system as lowercase = "winvista")))</Relevance>
		<Relevance><![CDATA[exists regapp "msnmsgr.exe" whose (version of it < "8.1.0178")]]></Relevance>
		<Relevance>exists regapp "msnmsgr.exe" AND exists file "msgslang.dll" whose (language of version block of it contains "English") of parent folder of regapp "msnmsgr.exe"</Relevance>
		<Relevance><![CDATA[if (version of client < "6.0") then (NOT pending restart) else (NOT pending restart "77eec15c8453d20260d8bf6977eeb6581bd8902f")]]></Relevance>
		<Relevance><![CDATA[exists regapp "IEXPLORE.EXE" whose (version of it >= "6.0.2800.1106")]]></Relevance>
		<Relevance><![CDATA[exists file "msiexec.exe" whose (version of it >= "3.1") of system folder]]></Relevance>
		<Category>Security Hotfix</Category>
		<DownloadSize>17167872</DownloadSize>
		<Source>Microsoft</Source>
		<SourceID>KB942099</SourceID>
		<SourceReleaseDate>2007-09-11</SourceReleaseDate>
		<SourceSeverity>Important</SourceSeverity>
		<CVENames>CVE-2007-2931</CVENames>
		<SANSID>Unspecified</SANSID>
		<MIMEField>
			<Name>x-fixlet-first-propagation</Name>
			<Value>Wed, 29 Jan 2014 06:58:01 +0000</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-component</Name>
			<Value>MSN Messenger and Live Messenger</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-product</Name>
			<Value>Win2003|WinVista|WinXP</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-product-family</Name>
			<Value>Windows</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-modification-time</Name>
			<Value>Wed, 04 Nov 2015 08:47:07 +0000</Value>
		</MIMEField>
		<Delay>PT1S</Delay>
		<Action ID="Action1">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> to initiate the deployment process.</PostLink>
			</Description>
			<ActionScript MIMEType="application/x-Fixlet-Windows-Shell">prefetch Install_WLInstaller.msi sha1:77eec15c8453d20260d8bf6977eeb6581bd8902f size:17167872 http://download.microsoft.com/MANUAL_BES_CACHING_REQUIRED/Install_WLInstaller.msi

waithidden msiexec.exe /i __download\Install_WLInstaller.msi IAGREE="YES" /quiet

action may require restart  "77eec15c8453d20260d8bf6977eeb6581bd8902f"</ActionScript>
		</Action>
		<Action ID="Link2">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> to view Microsoft Security Bulletin MS07-054.</PostLink>
			</Description>
			<ActionScript MIMEType="text/x-uri">http://www.microsoft.com/technet/security/Bulletin/MS07-054.mspx</ActionScript>
		</Action>
		<Action ID="Link3">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> to go to the download page for Windows Live Messenger 8.5.</PostLink>
			</Description>
			<ActionScript MIMEType="text/x-uri"><![CDATA[http://www.microsoft.com/downloads/details.aspx?FamilyID=7a1aae73-48cc-4f7a-b445-0487bd5e84ef&displaylang=en]]></ActionScript>
		</Action>
	</Fixlet>
</BES>
