<?xml version="1.0" encoding="UTF-8"?>
<BES xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="BES.xsd">
	<Fixlet>
		<Title>MS12-066: Vulnerability in HTML Sanitization Component Could Allow Elevation of Privilege - SharePoint Server 2007 Gold/SP2 (x64)</Title>
		<Description><![CDATA[
<DIV class=FixletMessage>
<TABLE><TBODY><TR><TD><P><STRONG>Note:</STRONG> This patch has been partially superseded by MS15-047. Whereas this Fixlet previously applied to SharePoint Server 2007 Gold/SP2/SP3 (x64), it now only applies to SharePoint Server 2007 Gold/SP2 (x64).</P>Microsoft has released a security update that resolves a publicly disclosed vulnerability in Microsoft Office, Microsoft Communications Platforms, Microsoft Server software, and Microsoft Office Web Apps. The vulnerability could allow elevation of privilege if an attacker sends specially crafted content to a user.<br><br>After downloading and installing this update, affected computers will no longer be susceptible to this vulnerability.<br><br><B>Note:</B> Affected computers may report back as 'Pending Restart' once the update has run successfully, but will not report back their final status until the computer has been restarted.<br><br><B><FONT color=#ff0000>Important Note:</FONT></B> There are known issues associated with the installation of this update. See the Known Issues section of the security bulletin for more information.<br><br><B>Note:</B> Microsoft has announced that this update may be included in a future service pack or update rollup.<br><br><B>Note:</B> This security update is also referenced under KB2687405.</TD></TR></TBODY></TABLE>
</DIV>
<DIV class=FixletProperty>
<H4>File Size:</H4>
42.7 MB
 </DIV>
]]></Description>
		<Relevance>(if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )</Relevance>
		<Relevance>x64 of operating system</Relevance>
		<Relevance>(language of version block of file "kernel32.dll" of system folder contains "English") OR (exists key "HKLM\System\CurrentControlSet\Control\Nls\MUILanguages" whose (exists value of it) of registry)</Relevance>
		<Relevance>not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry</Relevance>
		<Relevance>(exists keys ("00002109CF0100000100000000F01FEC") whose (exists key "InstallProperties" whose ((it = "12.0.4518.1016") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "E9855406F8AD1B5499231CBD9FE38630" of key "Patches" of it) of it OR exists keys ("00002109F70100001100000000F01FEC";"00002109F70100000100000000F01FEC";"00002109BF0100001100000000F01FEC";"00002109BF0100000100000000F01FEC";"00002109B40100000100000000F01FEC") whose (exists key "InstallProperties" whose ((it = "12.0.6425.1000") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "E9855406F8AD1B5499231CBD9FE38630" of key "Patches" of it) of it) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Products" of native registry</Relevance>
		<Relevance><![CDATA[((not exists key whose (exists key whose ("|CHTBRKR.DLL.X64|DOCXPAGECONVERTER.EXE|KORWBRKR.DLL.X64|MICROSOFT.OFFICE.SERVER.DLL|MICROSOFT.OFFICE.SERVER.DLL_ISAPI|MICROSOFT.SHAREPOINT.PUBLISHING.DLL_ISAPI|MSSCNTRS.DLL.X64|MSSDMN.EXE.X64|MSSEARCH.EXE.X64|MSSPH.DLL.X64|MSSRCH.DLL.X64|NATLANG6.DLL_OSSSEARCH.X64|NATLANGNLSD0000.DLL_OSSSEARCH.X64|NATLANGNLSD0007.DLL_OSSSEARCH.X64|NATLANGNLSD0009.DLL_OSSSEARCH.X64|NATLANGNLSD000C.DLL_OSSSEARCH.X64|NATLANGNLSD000D.DLL_OSSSEARCH.X64|NATLANGNLSD0010.DLL_OSSSEARCH.X64|NATLANGNLSD0013.DLL_OSSSEARCH.X64|NATLANGNL" & "SD0019.DLL_OSSSEARCH.X64|NATLANGNLSD001D.DLL_OSSSEARCH.X64|NATLANGNLSD0414.DLL_OSSSEARCH.X64|NATLANGNLSD0416.DLL_OSSSEARCH.X64|NATLANGNLSD0816.DLL_OSSSEARCH.X64|OFFFILTX.DLL.X64|OSAFEHTM.DLL|PKMEXSPH.DLL_0001.X64|PORTAL.DLL|PORTAL.DLL_001|QUERY9X.DLL_0001.X64|SEARCHOM.DLL.X64|SEARCHOM.DLL_0001.X64|SHAREPOINTPUB.DLL|SHAREPOINTPUB_GAC.DLL|SPSIMPPH.DLL.X64|SRCHPML.DLL.X64|SVRSETUP.DLL|SVRSETUP.EXE|TQUERY.DLL.X64|UPGRADE.DLL_001|" contains ("|" & value "File" of it as string as uppercase & "|")) of it) of it) OR (exists keys whose (exists key whose ((it = "12.0") of (value "ProductVersion" of it as string as version) AND (item 0 of it = "CHTBRKR.DLL.X64" AND (item 1 of it = 0 AND item 2 of it = "12.0.6600.1000" OR item 2 of it < "12.0.6600.1000") OR item 0 of it = "DOCXPAGECONVERTER.EXE" AND (item 1 of it = 0 AND item 2 of it = "12.0.6600.1000" OR item 2 of it < "12.0.6600.1000") OR item 0 of it = "KORWBRKR.DLL.X64" AND (item 1 of it = 0 AND item 2 of it = "12.0.6665.5000" OR item 2 of it < "12.0.6665.5000") OR item 0 of it = "MICROSOFT.OFFICE.SERVER.DLL" AND (item 1 of it = 0 AND item 2 of it = "12.0.6602.1000" OR item 2 of it < "12.0.6602.1000") OR item 0 of it = "MICROSOFT.OFFICE.SERVER.DLL_ISAPI" AND (item 1 of it = 0 AND item 2 of it = "12.0.6602.1000" OR item 2 of it < "12.0.6602.1000") OR item 0 of it = "MICROSOFT.SHAREPOINT.PUBLISHING.DLL_ISAPI" AND (item 1 of it = 0 AND item 2 of it = "12.0.6664.5000" OR item 2 of it < "12.0.6664.5000") OR item 0 of it = "MSSCNTRS.DLL.X64" AND (item 1 of it = 0 AND item 2 of it = "12.0.6600.1000" OR item 2 of it < "12.0.6600.1000") OR item 0 of it = "MSSDMN.EXE.X64" AND (item 1 of it = 0 AND item 2 of it = "12.0.6600.1000" OR item 2 of it < "12.0.6600.1000") OR item 0 of it = "MSSEARCH.EXE.X64" AND (item 1 of it = 0 AND item 2 of it = "12.0.6600.1000" OR item 2 of it < "12.0.6600.1000") OR item 0 of it = "MSSPH.DLL.X64" AND (item 1 of it = 0 AND item 2 of it = "12.0.6607.1000" OR item 2 of it < "12.0.6607.1000") OR item 0 of it = "MSSRCH.DLL.X64" AND (item 1 of it = 0 AND item 2 of it = "12.0.6660.5000" OR item 2 of it < "12.0.6660.5000") OR item 0 of it = "NATLANG6.DLL_OSSSEARCH.X64" AND (item 1 of it = 0 AND item 2 of it = "6.0.6600.1000" OR item 2 of it < "6.0.6600.1000") OR item 0 of it = "NATLANGNLSD0000.DLL_OSSSEARCH.X64" AND (item 1 of it = 0 AND item 2 of it = "6.0.6606.1000" OR item 2 of it < "6.0.6606.1000") OR item 0 of it = "NATLANGNLSD0007.DLL_OSSSEARCH.X64" AND (item 1 of it = 0 AND item 2 of it = "6.0.6606.1000" OR item 2 of it < "6.0.6606.1000") OR item 0 of it = "NATLANGNLSD0009.DLL_OSSSEARCH.X64" AND (item 1 of it = 0 AND item 2 of it = "6.0.6606.1000" OR item 2 of it < "6.0.6606.1000") OR item 0 of it = "NATLANGNLSD000C.DLL_OSSSEARCH.X64" AND (item 1 of it = 0 AND item 2 of it = "6.0.6606.1000" OR item 2 of it < "6.0.6606.1000") OR item 0 of it = "NATLANGNLSD000D.DLL_OSSSEARCH.X64" AND (item 1 of it = 0 AND item 2 of it = "6.0.6606.1000" OR item 2 of it < "6.0.6606.1000") OR item 0 of it = "NATLANGNLSD0010.DLL_OSSSEARCH.X64" AND (item 1 of it = 0 AND item 2 of it = "6.0.6606.1000" OR item 2 of it < "6.0.6606.1000") OR item 0 of it = "NATLANGNLSD0013.DLL_OSSSEARCH.X64" AND (item 1 of it = 0 AND item 2 of it = "6.0.6606.1000" OR item 2 of it < "6.0.6606.1000") OR item 0 of it = "NATLANGNLSD0019.DLL_OSSSEARCH.X64" AND (item 1 of it = 0 AND item 2 of it = "6.0.6606.1000" OR item 2 of it < "6.0.6606.1000") OR item 0 of it = "NATLANGNLSD001D.DLL_OSSSEARCH.X64" AND (item 1 of it = 0 AND item 2 of it = "6.0.6606.1000" OR item 2 of it < "6.0.6606.1000") OR item 0 of it = "NATLANGNLSD0414.DLL_OSSSEARCH.X64" AND (item 1 of it = 0 AND item 2 of it = "6.0.6606.1000" OR item 2 of it < "6.0.6606.1000") OR item 0 of it = "NATLANGNLSD0416.DLL_OSSSEARCH.X64" AND (item 1 of it = 0 AND item 2 of it = "6.0.6606.1000" OR item 2 of it < "6.0.6606.1000") OR item 0 of it = "NATLANGNLSD0816.DLL_OSSSEARCH.X64" AND (item 1 of it = 0 AND item 2 of it = "6.0.6606.1000" OR item 2 of it < "6.0.6606.1000") OR item 0 of it = "OFFFILTX.DLL.X64" AND (item 1 of it = 0 AND item 2 of it = "2006.1200.6605.1000" OR item 2 of it < "2006.1200.6605.1000") OR item 0 of it = "OSAFEHTM.DLL" AND (item 1 of it = 0 AND item 2 of it = "12.0.6665.5000" OR item 2 of it < "12.0.6665.5000") OR item 0 of it = "PKMEXSPH.DLL_0001.X64" AND (item 1 of it = 0 AND item 2 of it = "12.0.6600.1000" OR item 2 of it < "12.0.6600.1000") OR item 0 of it = "PORTAL.DLL" AND (item 1 of it = 0 AND item 2 of it = "12.0.6657.5000" OR item 2 of it < "12.0.6657.5000") OR item 0 of it = "PORTAL.DLL_001" AND (item 1 of it = 0 AND item 2 of it = "12.0.6657.5000" OR item 2 of it < "12.0.6657.5000") OR item 0 of it = "QUERY9X.DLL_0001.X64" AND (item 1 of it = 0 AND item 2 of it = "12.0.6600.1000" OR item 2 of it < "12.0.6600.1000") OR item 0 of it = "SEARCHOM.DLL.X64" AND (item 1 of it = 0 AND item 2 of it = "12.0.6657.5000" OR item 2 of it < "12.0.6657.5000") OR item 0 of it = "SEARCHOM.DLL_0001.X64" AND (item 1 of it = 0 AND item 2 of it = "12.0.6657.5000" OR item 2 of it < "12.0.6657.5000") OR item 0 of it = "SHAREPOINTPUB.DLL" AND (item 1 of it = 0 AND item 2 of it = "12.0.6664.5000" OR item 2 of it < "12.0.6664.5000") OR item 0 of it = "SHAREPOINTPUB_GAC.DLL" AND (item 1 of it = 0 AND item 2 of it = "12.0.6664.5000" OR item 2 of it < "12.0.6664.5000") OR item 0 of it = "SPSIMPPH.DLL.X64" AND (item 1 of it = 0 AND item 2 of it = "12.0.6600.1000" OR item 2 of it < "12.0.6600.1000") OR item 0 of it = "SRCHPML.DLL.X64" AND (item 1 of it = 0 AND item 2 of it = "12.0.6500.5000" OR item 2 of it < "12.0.6500.5000") OR item 0 of it = "SVRSETUP.DLL" AND (item 1 of it = 0 AND item 2 of it = "12.0.6657.5000" OR item 2 of it < "12.0.6657.5000") OR item 0 of it = "SVRSETUP.EXE" AND (item 1 of it = 0 AND item 2 of it = "12.0.6650.5000" OR item 2 of it < "12.0.6650.5000") OR item 0 of it = "TQUERY.DLL.X64" AND (item 1 of it = 0 AND item 2 of it = "12.0.6604.1000" OR item 2 of it < "12.0.6604.1000") OR item 0 of it = "UPGRADE.DLL_001" AND (item 1 of it = 0 AND item 2 of it = "12.0.6602.1000" OR item 2 of it < "12.0.6602.1000")) of (value "File" of it as string as uppercase, value "IsFullFile" of it as integer, value "ComponentVersion" of it as string as version) AND ((set of (((if (exists key "00002100CF0100000100000000F01FEC" of it) then (names of values of key "00002100CF0100000100000000F01FEC" of it) else (nothing) of it);(if (exists key "00002100B40100000100000000F01FEC" of it) then (names of values of key "00002100B40100000100000000F01FEC" of it) else (nothing) of it);(if (exists key "00002100F70100000100000000F01FEC" of it) then (names of values of key "00002100F70100000100000000F01FEC" of it) else (nothing) of it);(if (exists key "00002100BF0100000100000000F01FEC" of it) then (names of values of key "00002100BF0100000100000000F01FEC" of it) else (nothing) of it)) whose (set of ("00002109CF0100000100000000F01FEC";"00002109B40100000100000000F01FEC";"00002109F70100000100000000F01FEC";"00002109F70100001100000000F01FEC";"00002109BF0100000100000000F01FEC";"00002109BF0100001100000000F01FEC") contains it) of key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) contains name of it)) of it) of it)) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Components\" of native registry]]></Relevance>
		<Category>Security Hotfix</Category>
		<DownloadSize>44809472</DownloadSize>
		<Source>Microsoft</Source>
		<SourceID>KB2687405</SourceID>
		<SourceReleaseDate>2012-10-09</SourceReleaseDate>
		<SourceSeverity>Important</SourceSeverity>
		<CVENames>CVE-2012-2520</CVENames>
		<MIMEField>
			<Name>x-fixlet-first-propagation</Name>
			<Value>Wed, 29 Jan 2014 06:58:01 +0000</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-component</Name>
			<Value>HTML Sanitization Component</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-product</Name>
			<Value>Office 2007</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-cpe23-item-name</Name>
			<Value>cpe:2.3:a:microsoft:sharepoint_server:2007:gold:*:*:*:*:*:*; cpe:2.3:a:microsoft:sharepoint_server:2007:sp2:*:*:*:*:*:*</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-product-family</Name>
			<Value>Office</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-modification-time</Name>
			<Value>Wed, 22 Mar 2017 18:31:45 +0000</Value>
		</MIMEField>
		<Delay>PT1S</Delay>
		<DefaultAction ID="Action1">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> to initiate the deployment process.</PostLink>
			</Description>
			<ActionScript MIMEType="application/x-Fixlet-Windows-Shell">prefetch coreserver2007-kb2687405-fullfile-x64-glb.exe sha1:93e84a87773af9c5d6dabede7960293abf751f21 size:44809472 http://download.microsoft.com/download/5/2/3/5236A038-F810-4BFF-927D-4FB79352DCD8/coreserver2007-kb2687405-fullfile-x64-glb.exe sha256:61209429cef544d6357a099f7098d2762fce0b29e64332d37ce2f1ff6a4251a1

waithidden __Download\coreserver2007-kb2687405-fullfile-x64-glb.exe /quiet /norestart

action may require restart "93e84a87773af9c5d6dabede7960293abf751f21"
</ActionScript>
		</DefaultAction>
		<Action ID="Link2">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> to view this Security Bulletin from Microsoft.</PostLink>
			</Description>
			<ActionScript MIMEType="text/x-uri">http://technet.microsoft.com/en-us/security/bulletin/MS12-066</ActionScript>
		</Action>
	</Fixlet>
</BES>
