<?xml version="1.0" encoding="UTF-8"?>
<BES xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="BES.xsd">
	<Fixlet>
		<Title>MS09-004: Vulnerability in Microsoft SQL Server Could Allow Remote Code Execution - SQL Server 2000 Desktop Engine (WMSDE) - Windows Server 2003 Gold/SP2 (x64)</Title>
		<Description><![CDATA[
<DIV class=FixletMessage>
<TABLE><TBODY><TR><TD> <P>Microsoft has released a security update that resolves a privately reported vulnerability in Microsoft SQL Server. The vulnerability could allow remote code execution if untrusted users access an affected system or if a SQL injection attack occurs to an affected system. Systems with SQL Server 7.0 Service Pack 4, SQL Server 2005 Service Pack 3, and SQL Server 2008 are not affected by this issue.</P> <P>After downloading and installing this update, affected computers will no longer be susceptible to this vulnerability.</P> <P><B>Note:</B> Affected computers may report back as 'Pending Restart' once the update has run successfully, but will not report back their final status until the computer has been restarted.</P> <P><STRONG>Note:</STRONG> Client machines may briefly display&nbsp;an installation&nbsp;progress window during installation of this update.</P> <P><STRONG>Note:</STRONG> This security update is also referenced under KB960082.</P> <P><B><FONT color=#ff0000>Important Note:</FONT></B> There are known issues associated with the installation of this update. See the Known Issues section of the security bulletin for more information.</P> <P><FONT color=#ff0000><STRONG>Important Note:</STRONG></FONT> This update will only work on WMSDE installations with a blank SAPWD. Updates on non-blank SAPWD systems will fail and must be completed manually.</P> <P><FONT color=#ff0000><STRONG>Important Note:</STRONG></FONT> Due to the difficulty involved with distinguishing between instances of MSDE and WMSDE (please see <A href="http://support.microsoft.com/default.aspx?scid=kb;en-us;823465">this</A> link for details), the existence of a patchable WMSDE instance can only be determined at run time. As such, updates to systems with one or more of the applicable products (ADMT, ADS, SharePoint, UDDI, and WSUS) installed on top of a non-WMSDE database will fail silently and the action will report back as failed.</P> <P><STRONG>Note:</STRONG> There is no default action for this Fixlet message due to known issues associated with the installation of this patch. Please review the Known Issues section of the security bulletin prior to deploying this patch. For more information on default actions, see BigFix KB #<A href="http://support.bigfix.com/cgi-bin/kbdirect.pl?id=474">474</A>.</P> <P><STRONG>Note:</STRONG> Client machines may briefly display a progress bar during action execution.</P></TD></TR></TBODY></TABLE>
</DIV>
<DIV class=FixletProperty>
<H4>File Size:</H4>
72.1 MB
 </DIV>
]]></Description>
		<Relevance>(if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )</Relevance>
		<Relevance>x64 of operating system</Relevance>
		<Relevance>(language of version block of file "kernel32.dll" of system folder contains "English") OR (exists key "HKLM\System\CurrentControlSet\Control\Nls\MUILanguages" whose (exists value of it) of registry)</Relevance>
		<Relevance>not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry</Relevance>
		<Relevance>(name of it = "Win2003" AND (service pack major version of it = 2 OR service pack major version of it = 1)) of operating system</Relevance>
		<Relevance><![CDATA[exists files "Sqlservr.exe" whose (version of it < "2000.80.2055.0") of folders ((value "SqlProgramDir" of it as string & "MSSQL$" & value "SqlInstanceName" of it as string & "\Binn") of keys whose (name of it = "{EEE5C104-B67A-486D-947E-A209F2058E93}" OR name of it = "{B3E6E30F-7680-4DF9-A152-B5285098A5AD}" OR name of it = "{65657C59-23A8-4974-B8E0-BA04EBD04E4F}" OR name of it = "{B42339CD-9F22-4A6A-A023-D12990E0B918}" OR name of it = "{83BC1BC2-FCC4-4CED-8A3C-EB7CDFB3CF6A}" OR name of it = "{B7CF8A67-FEE5-4A41-9767-BAE0B90A732B}") of key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry)]]></Relevance>
		<Category>Security Hotfix</Category>
		<DownloadSize>75621736</DownloadSize>
		<Source>Microsoft</Source>
		<SourceID>KB959420</SourceID>
		<SourceReleaseDate>2009-02-10</SourceReleaseDate>
		<SourceSeverity>Important</SourceSeverity>
		<CVENames>CVE-2008-5416</CVENames>
		<SANSID>Unspecified</SANSID>
		<MIMEField>
			<Name>x-fixlet-first-propagation</Name>
			<Value>Wed, 29 Jan 2014 06:58:01 +0000</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-component</Name>
			<Value>N/A</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-product</Name>
			<Value>SQL Server 2000</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-product-family</Name>
			<Value>SQL Server</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-modification-time</Name>
			<Value>Fri, 12 Aug 2016 17:01:58 +0000</Value>
		</MIMEField>
		<Delay>PT1S</Delay>
		<Action ID="Action1">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> to initiate the deployment process.</PostLink>
			</Description>
			<ActionScript MIMEType="application/x-Fixlet-Windows-Shell">prefetch SQLWMSDE-KB960082-x86-ENU.exe sha1:e6560ec4a9616a5348e78dd4c20e02fe55348cb6 size:75621736 http://download.microsoft.com/download/4/4/A/44A4A986-56FA-4BB5-8C2B-F2187F99A4C5/SQLWMSDE-KB960082-x86-ENU.exe sha256:da09198eeb82caff5866aa3efd97521d6302aa07bc279f1a1706e8d7df4d89d5

// Note: All of the following actions will fail silently if WMSDE is not installed

// MS_ADMT
if {exists key whose (name of it = "%7BEEE5C104-B67A-486D-947E-A209F2058E93%7D") of key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry}
wait __Download\SQLWMSDE-KB960082-x86-ENU.exe /quiet /upgradesp sqlrun BLANKSAPWD=1 INSTANCENAME=MS_ADMT /l*v "{pathname of windows folder}\WMSDE-MS_ADMT.log" /norestart
endif

// MICROSOFTADS
if {exists key whose (name of it = "%7BB3E6E30F-7680-4DF9-A152-B5285098A5AD%7D") of key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry}
wait __Download\SQLWMSDE-KB960082-x86-ENU.exe /quiet /upgradesp sqlrun BLANKSAPWD=1 INSTANCENAME=MICROSOFTADS /l*v "{pathname of windows folder}\WMSDE-MICROSOFTADS.log" /norestart
endif

// SharePoint - Some installations have a different GUID than the bulletin
// mentions, so including it here
if {exists key whose ((it = "%7BB7CF8A67-FEE5-4A41-9767-BAE0B90A732B%7D" OR it = "%7B65657C59-23A8-4974-B8E0-BA04EBD04E4F%7D") of name of it) of key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry}
wait __Download\SQLWMSDE-KB960082-x86-ENU.exe /quiet /upgradesp sqlrun BLANKSAPWD=1 INSTANCENAME=SharePoint /l*v "{pathname of windows folder}\WMSDE-SharePoint.log" /norestart
endif

// UDDI
if {exists key whose (name of it = "%7BB42339CD-9F22-4A6A-A023-D12990E0B918%7D") of key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry}
wait __Download\SQLWMSDE-KB960082-x86-ENU.exe /quiet /upgradesp sqlrun BLANKSAPWD=1 INSTANCENAME=UDDI /l*v "{pathname of windows folder}\WMSDE-UDDI.log" /norestart
endif

// WSUS
if {exists key whose (name of it = "%7B83BC1BC2-FCC4-4CED-8A3C-EB7CDFB3CF6A%7D") of key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry}
wait __Download\SQLWMSDE-KB960082-x86-ENU.exe /quiet /upgradesp sqlrun BLANKSAPWD=1 INSTANCENAME=WSUS /l*v "{pathname of windows folder}\WMSDE-WSUS.log" /norestart
endif

action may require restart "e6560ec4a9616a5348e78dd4c20e02fe55348cb6"</ActionScript>
		</Action>
		<Action ID="Link2">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> to view Microsoft Security Bulletin MS09-004.</PostLink>
			</Description>
			<ActionScript MIMEType="text/x-uri">http://www.microsoft.com/technet/security/Bulletin/MS09-004.mspx</ActionScript>
		</Action>
	</Fixlet>
</BES>
