<?xml version="1.0" encoding="UTF-8"?>
<BES xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="BES.xsd">
	<Fixlet>
		<Title>MS04-009: Vulnerability in Microsoft Outlook 2002 Could Allow Code Execution - Windows NT/2000/XP (Administrative Installation)</Title>
		<Description><![CDATA[
<TABLE><TBODY><TR><TD><FONT size=2> <P>Microsoft has released a patch eliminating a security vulnerability in Outlook 2002. The parsing of specially crafted mailto URLs could allow Internet Explorer to execute script code in the Local Machine zone on an affected system. An attacker could exploit this vulnerability by hosting a malicious Web site or by sending a specially crafted HTML message. <BR><BR>After downloading and installing this patch, affected computers will no longer be susceptible to this vulnerability. <BR><BR><B>Note:</B> Microsoft has announced that this patch is included in Office XP Service Pack 3. </P> <P><STRONG>Note:</STRONG> In preparation for deploying this update through an Administrative Installation Point, you must apply this patch to all Administrative Installation Points in your network. For instructions on how to install this patch to your Administrative Installation Point, please browse to the following link: <A href="http://www.microsoft.com/office/ork/updates/xp/olk1007a.htm"><FONT color=#0000ff>http://www.microsoft.com/office/ork/updates/xp/olk1007a.htm</FONT></A>. Once you have updated your administrative installation point, you may deploy this patch.</P> <P><STRONG>Note: </STRONG>Some Office updates will<STRONG> force</STRONG> the affected computer to restart without displaying a warning message if Office applications are open when this update is run. To prevent this from happening, shut down all Office applications prior to applying this update.</P></FONT> <P></P><P><B>Note:</B> There is no default action for the Fixlet message because it requires additional preparation before deployment. For more information on default actions, see BigFix KB #<a href="http://support.bigfix.com/cgi-bin/kbdirect.pl?id=474">474</a>.</P><P><SPAN id=dashboardLink></SPAN><SCRIPT type=text/javascript>var isEvansOrLater = '<?relevance if (exists property "datastore inspectors") then (True) else (False)?>' == 'True'?true:false;  document.body.onload = SetOfficeOverviewLink; function SetOfficeOverviewLink() { try {if (isEvansOrLater) { dashboardLink.innerHTML = Relevance('(format "<?rxlat <b>Note:</b> For configuration controls and an overview of your Microsoft Office deployment(s), please see the {0}.?>" +  link "<?rxlat Microsoft Office Overview Dashboard?>" of bes wizard whose (dashboard id of it = "office_overview.ojo" AND id of site of it = 2) as string ) as string');} else { dashboardLink.innerHTML = EvaluateRelevance('"<b>Note:</b> For configuration controls and an overview of your Microsoft Office deployment(s), please see the " & link "Microsoft Office Overview Dashboard" of bes wizard whose (dashboard id of it = "office_overview.ojo" AND id of site of it = 2) as string & "."');} } catch (e) {if (isEvansOrLater) { dashboardLink.innerHTML ='<?jxlat <b>Note:</b> For configuration controls and an overview of your Microsoft Office deployment(s), please see the Microsoft Office Overview Dashboard.?>';} else { dashboardLink.innerHTML = '<b>Note:</b> For configuration controls and an overview of your Microsoft Office deployment(s), please see the Microsoft Office Overview Dashboard.';} } } </SCRIPT></P></TD></TR></TBODY></TABLE>
]]></Description>
		<Relevance>(if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )</Relevance>
		<Relevance>(language of version block of file "kernel32.dll" of system folder contains "English") OR (exists value of key "HKLM\System\CurrentControlSet\Control\Nls\MUILanguages" of registry)</Relevance>
		<Relevance>not exists key "HKLM\Software\Wow6432Node\Microsoft\Windows\CurrentVersion" whose (exists value "ProductId" of it OR exists value "CommonFilesDir" of it) of registry AND not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry</Relevance>
		<Relevance>name of operating system as lowercase contains "winnt" OR name of operating system = "Win2000" OR name of operating system = "WinXP"</Relevance>
		<Relevance>exists key whose ((value "ProductName" of it as string contains "Office XP") AND ((value "ProductName" of it as string = "Office XP") OR (value "ProductName" of it as string contains "Professional") OR (value "ProductName" of it as string contains "Standard") OR (value "ProductName" of it as string contains "Small Business") OR (value "ProductName" of it as string contains "Developer"))) of key "HKEY_CLASSES_ROOT\Installer\Products" of registry</Relevance>
		<Relevance><![CDATA[exists file "msiexec.exe" whose (version of it >= "2.0") of system folder]]></Relevance>
		<Relevance>(exists key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\OfficeXPControl" of registry) AND (value "DeploymentType" of key "HKEY_LOCAL_MACHINE\SOFTWARE\BigFix\EnterpriseClient\OfficeXPControl" of registry = 1)</Relevance>
		<Relevance><![CDATA[exists file "MSOINTL.DLL" whose (language of version block of it contains "English") of (folders of folder (value "CommonFilesDir" of key "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion" of registry as string & "\Microsoft Shared\Office10"))]]></Relevance>
		<Relevance><![CDATA[(version of regapp "outlook.exe" >= "10.0.4024.0" as version AND (version of regapp "outlook.exe" < "10.0.5709.0" as version))]]></Relevance>
		<Category>Security Hotfix</Category>
		<DownloadSize>0</DownloadSize>
		<Source>Microsoft</Source>
		<SourceID>KB828040</SourceID>
		<SourceReleaseDate>2004-03-09</SourceReleaseDate>
		<SourceSeverity>Critical</SourceSeverity>
		<CVENames>CVE-2004-0121</CVENames>
		<SANSID>Unspecified</SANSID>
		<MIMEField>
			<Name>x-fixlet-first-propagation</Name>
			<Value>Wed, 29 Jan 2014 06:58:01 +0000</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-component</Name>
			<Value>Outlook</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-product</Name>
			<Value>Office 2002</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-product-family</Name>
			<Value>Office</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-modification-time</Name>
			<Value>Wed, 17 Jul 2019 00:05:09 +0000</Value>
		</MIMEField>
		<Delay>PT1S</Delay>
		<Action ID="Action1">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink><![CDATA[ to initiate the deployment process.&nbsp; Please only perform this action once the patch has been delivered to the installation point.]]></PostLink>
			</Description>
			<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[wait {pathname of system folder}\msiexec.exe /i {preceding text of (first "%00" of (following text of (last ";" of ((value "LastUsedSource" of key "SourceList" of key whose ((value "ProductName" of it as string contains "Office XP") AND ((value "ProductName" of it as string = "Office XP") OR (value "ProductName" of it as string contains "Professional") OR (value "ProductName" of it as string contains "Standard") OR (value "ProductName" of it as string contains "Small Business") OR (value "ProductName" of it as string contains "Developer"))) of key "HKEY_CLASSES_ROOT\Installer\Products\" of registry as string) & "%00")))) & value "PackageName" of key "SourceList" of key whose ((value "ProductName" of it as string contains "Office XP") AND ((value "ProductName" of it as string = "Office XP") OR (value "ProductName" of it as string contains "Professional") OR (value "ProductName" of it as string contains "Standard") OR (value "ProductName" of it as string contains "Small Business") OR (value "ProductName" of it as string contains "Developer"))) of key "HKEY_CLASSES_ROOT\Installer\Products\" of registry as string} REINSTALL=OUTLOOKFiles,OUTLOOKNonBootFiles REINSTALLMODE=vomus /Q]]></ActionScript>
		</Action>
		<Action ID="Link2">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> to view Microsoft Security Bulletin MS04-009.</PostLink>
			</Description>
			<ActionScript MIMEType="text/x-uri">https://docs.microsoft.com/en-us/security-updates/securitybulletins/2004/MS04-009</ActionScript>
		</Action>
		<Action ID="Link3">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> for information on troubleshooting Office patches.</PostLink>
			</Description>
			<ActionScript MIMEType="text/x-uri">http://support.bigfix.com/cgi-bin/kbdirect.pl?id=129</ActionScript>
		</Action>
	</Fixlet>
</BES>
