<?xml version="1.0" encoding="UTF-8"?>
<BES xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="BES.xsd">
	<Fixlet>
		<Title>MS04-017: Vulnerability in Crystal Reports Web Viewer Could Allow Information Disclosure and Denial of Service - Visual Studio .NET 2003 - CORRUPT PATCH</Title>
		<Description><![CDATA[
The listed computers have faulty installations of a patch for the vulnerability described in MS bulletin MS04-017. Some files being used by these computers have versions earlier than those of the corresponding files installed by the patch. Services or applications installed after the patch was distributed may have overwritten the files, or the initial installation may have been faulty. We recommend reinstalling this patch to ensure the safety of affected computers. <BR><BR>Microsoft has released a patch to resolve a vulnerability in Crystal Reports and Crystal Enterprise Web viewers, which are components of Microsoft Visual Studio .NET 2003 and Outlook 2003 with Business Contact Manager. An attacker who successfully exploited the vulnerability could retrieve and delete files through the Crystal Reports and Crystal Enterprise Web viewers on an affected system. The number of files that are impacted by this vulnerability would depend on the security context of the affected component that is used by the Crystal Web viewer. After downloading and installing this patch, affected computers will no longer be susceptible to these vulnerabilities. <BR><BR><b>Note:</b> Affected computers may report back as 'Pending Restart' once the patch has run successfully, but will not report back their final status until the computer has been restarted. <BR><BR><b>Note:</b> Microsoft has announced that this patch will be included in Visual Studio .NET 2003 Pack 1. <BR><BR><b>File Size:</b> 2.02 MB<BR><BR><b>Note:</b> This security update is also referenced under KB841870.
]]></Description>
		<Relevance>(if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )</Relevance>
		<Relevance>(language of version block of file "kernel32.dll" of system folder contains "English") OR (exists value of key "HKLM\System\CurrentControlSet\Control\Nls\MUILanguages" of registry)</Relevance>
		<Relevance>not exists key "HKLM\Software\Wow6432Node\Microsoft\Windows\CurrentVersion" whose (exists value "ProductId" of it OR exists value "CommonFilesDir" of it) of registry AND not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry</Relevance>
		<Relevance>exists key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Active Setup\Installed Components\{981DFBF2-F25F-4C20-A2B3-AC64EAA6DD83}" of registry OR exists key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Visual Studio\7.1\M841870" of registry</Relevance>
		<Relevance><![CDATA[exists file ((value "CommonFilesDir" of key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion" of registry as string) & "\Crystal Decisions\1.1\Managed\CrystalDecisions.Web.dll") whose (version of it < "9.1.9800.9") ]]></Relevance>
		<Relevance>exists running service "IISAdmin" OR (exists service "IISAdmin" whose (start type of it != "disabled"))</Relevance>
		<Relevance>exists key whose ((name of it contains "Visual Studio .NET Professional" AND name of it contains "2003") OR (name of it contains "Visual Studio .NET Enterprise" AND name of it contains "2003")) of key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall" of registry </Relevance>
		<Category>Security Hotfix</Category>
		<DownloadSize>2119480</DownloadSize>
		<Source>Microsoft</Source>
		<SourceID>KB842689</SourceID>
		<SourceReleaseDate>2004-06-08</SourceReleaseDate>
		<SourceSeverity>Moderate</SourceSeverity>
		<CVENames>CVE-2004-0204</CVENames>
		<MIMEField>
			<Name>x-fixlet-first-propagation</Name>
			<Value>Wed, 29 Jan 2014 06:58:01 +0000</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-corruptid</Name>
			<Value>401701</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-component</Name>
			<Value>N/A</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-product</Name>
			<Value>Visual Studio 2003</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-product-family</Name>
			<Value>Developer Tools, Runtimes, and Redistributables</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-modification-time</Name>
			<Value>Mon, 15 Apr 2019 04:56:37 +0000</Value>
		</MIMEField>
		<Delay>PT1S</Delay>
		<Action ID="Action1">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink><![CDATA[&nbsp; to initiate the deployment process.]]></PostLink>
			</Description>
			<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[prefetch VS7.1-KB841870-X86.exe sha1:ce4eff43db3f74fd101010059cb32f628554e775 size:2119480 http://download.microsoft.com/download/0/5/d/05d3fd51-4b60-49e1-a762-afa47ac5ec6b/VS7.1-KB841870-X86.exe sha256:2cf5298d0ffd3799ee13106d24ee77d916323462ae03c9bf9b5edbe80c05cd41

wait __download\VS7.1-KB841870-X86.exe /q

run "{pathname of client folder of site "BESSupport" & "\RunQuiet.exe"}" "{pathname of client folder of site "BESSupport" & "\qchain.exe"}"
action may require restart]]></ActionScript>
		</Action>
		<Action ID="Link2">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink><![CDATA[&nbsp; to view Microsoft Security Bulletin MS04-017.]]></PostLink>
			</Description>
			<ActionScript MIMEType="text/x-uri">http://www.microsoft.com/technet/security/Bulletin/MS04-017.mspx</ActionScript>
		</Action>
	</Fixlet>
</BES>
