<?xml version="1.0" encoding="UTF-8"?>
<BES xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="BES.xsd">
	<Fixlet>
		<Title>MS05-009: Vulnerability in PNG Processing Could Allow Remote Code Execution - Windows Messenger 5.0</Title>
		<Description><![CDATA[
<DIV class=FixletMessage>
<TABLE><TBODY><TR><TD> <P><FONT size=2>Microsoft has released a patch eliminating a remote code execution vulnerability in the processing of PNG image formats. An attacker who successfully exploited this vulnerability could take complete control of an affected system. After downloading and installing this patch, affected computers will no longer be susceptible to this vulnerability.</FONT></P> <P><FONT size=2><STRONG>Note:</STRONG> If this patch has already been installed on computers reporting relevant, it means that one or more files updated by the patch have been downgraded to unsafe versions. In order to ensure security, it is recommended that the patch be reinstalled.</FONT></P> <P><FONT size=2><B>Note:</B> Affected computers may report back as 'Pending Restart' once the patch has run successfully, but will not report back their final status until the computer has been restarted. <BR><BR><B>Note:</B> Client machines may briefly display progress windows during installation of this update. </FONT></P> <P><FONT size=2><FONT color=#ff0000><B>Important Note:</B></FONT> This action will fail if Windows Messenger 5.0 is running. To prevent this behavior, you may want to deploy this action with the user constraint "Run only when no user is present" or display a message box before action execution instructing the user to shut down Windows Messenger before applying the update.</FONT></P> <P><FONT size=2><FONT color=#ff0000><B>Important Note:</B></FONT> This action will download the MSI file for Windows Messenger 5.1, and copy the MSI file to the BES Client subfolder "\__BESData\__WinMessengerMSI" before upgrading to Windows Messenger 5.1. Windows Messenger 5.1 may require access to this file the first time it is run after the upgrade.</FONT></P><P><B>Note:</B> This Fixlet message does not have a default action. For more information on default actions, see BigFix KB #<a href="http://support.bigfix.com/cgi-bin/kbdirect.pl?id=474">474</a>.</P></TD></TR></TBODY></TABLE>
</DIV>
<DIV class=FixletProperty>
<H4>File Size:</H4>
7.09 MB
 </DIV>
]]></Description>
		<Relevance>(if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )</Relevance>
		<Relevance>(language of version block of file "kernel32.dll" of system folder contains "English") OR (exists value of key "HKLM\System\CurrentControlSet\Control\Nls\MUILanguages" of registry)</Relevance>
		<Relevance>not exists key "HKLM\Software\Wow6432Node\Microsoft\Windows\CurrentVersion" whose (exists value "ProductId" of it OR exists value "CommonFilesDir" of it) of registry AND not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry</Relevance>
		<Relevance>(name of operating system = "Win2003" and csd version of operating system = "") OR (name of operating system = "Win2000" AND csd version of operating system = "Service Pack 4") OR (name of operating system = "WinXP" AND (csd version of operating system = "Service Pack 1" OR csd version of operating system = "Service Pack 2"))</Relevance>
		<Relevance><![CDATA[exists regapp "msmsgs.exe" AND (version of regapp "msmsgs.exe" >= "5.0" AND version of regapp "msmsgs.exe" < "5.1.0.639")]]></Relevance>
		<Relevance><![CDATA[version of file "msiexec.exe" of system folder >= "3.0"]]></Relevance>
		<Relevance>language of version block of file "msgslang.dll" of parent folder of regapp "msmsgs.exe" contains "English"</Relevance>
		<Category>Security Hotfix</Category>
		<DownloadSize>7437312</DownloadSize>
		<Source>Microsoft</Source>
		<SourceID>KB890261</SourceID>
		<SourceReleaseDate>2005-02-08</SourceReleaseDate>
		<SourceSeverity>Moderate</SourceSeverity>
		<CVENames>CVE-2004-1244; CVE-2004-0597; CVE-2004-0598; CVE-2004-0599</CVENames>
		<SANSID>Unspecified</SANSID>
		<MIMEField>
			<Name>x-fixlet-first-propagation</Name>
			<Value>Wed, 29 Jan 2014 06:58:01 +0000</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-component</Name>
			<Value>PNG Processing</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-product</Name>
			<Value>WinXP|Win2003</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-product-family</Name>
			<Value>Windows</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-modification-time</Name>
			<Value>Wed, 17 Apr 2019 06:11:17 +0000</Value>
		</MIMEField>
		<Delay>PT1S</Delay>
		<Action ID="Action1">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> to initiate the deployment process.</PostLink>
			</Description>
			<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[// fail if messenger is running
continue if {not exists running application "msmsgs.exe"}

prefetch messenger.msi sha1:4e85d2369b59cc36200fdd99181b7029ab7db36e size:7437312 http://download.microsoft.com/download/e/b/3/eb3b95c6-b6e3-47f6-bcd1-466ad173f407/messenger.msi sha256:3d4f652b40355c950ca5f007ab01b225457607906df9f8d816ebef7960e12a06

dos mkdir "{pathname of parent folder of client folder of site "actionsite"}\__WinMessengerMSI"

delete "{pathname of parent folder of client folder of site "actionsite"}\__WinMessengerMSI\messenger.msi"

move "__Download\messenger.msi" "{pathname of parent folder of client folder of site "actionsite"}\__WinMessengerMSI\messenger.msi"

wait {pathname of system folder}\msiexec.exe /i "{pathname of parent folder of client folder of site "actionsite"}\__WinMessengerMSI\messenger.msi" /qn /norestart

run "{pathname of client folder of site "BESSupport" & "\RunQuiet.exe"}" "{pathname of client folder of site "BESSupport" & "\qchain.exe"}"
action may require restart]]></ActionScript>
		</Action>
		<Action ID="Link2">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> to view Microsoft Security Bulletin MS05-009.</PostLink>
			</Description>
			<ActionScript MIMEType="text/x-uri">http://www.microsoft.com/technet/security/Bulletin/MS05-009.mspx</ActionScript>
		</Action>
	</Fixlet>
</BES>
