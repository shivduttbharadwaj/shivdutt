<?xml version="1.0" encoding="UTF-8"?>
<BES xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="BES.xsd">
	<Fixlet>
		<Title>MS15-058: Vulnerabilities in SQL Server Could Allow Remote Code Execution - SQL Server 2012 SP1 - QFE Branch - KB3045317</Title>
		<Description><![CDATA[
<DIV class=FixletMessage>
<TABLE><TBODY><TR><TD>Microsoft has released a security update that resolves vulnerabilities in Microsoft SQL Server. The most severe vulnerabilities could allow remote code execution if an authenticated attacker runs a specially crafted query that is designed to execute a virtual function from a wrong address, leading to a function call to uninitialized memory. To exploit this vulnerability an attacker would need permissions to create or modify a database.<br><br>After downloading and installing this update, affected computers will no longer be susceptible to these vulnerabilities.<br><br><B>Note:</B> Affected computers may report back as 'Pending Restart' once the update has run successfully, but will not report back their final status until the computer has been restarted.<br><br><B>Note:</B> Microsoft has announced that this update may be included in a future service pack or update rollup.<br><br><B>Note:</B> This security update is also referenced under KB3045317.</TD></TR></TBODY></TABLE>
</DIV>
<DIV class=FixletProperty>
<H4>File Size:</H4>
485 MB
 </DIV>
]]></Description>
		<Relevance>(if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true )</Relevance>
		<Relevance>(language of version block of file "kernel32.dll" of system folder contains "English") OR (exists key "HKLM\System\CurrentControlSet\Control\Nls\MUILanguages" whose (exists value of it) of registry)</Relevance>
		<Relevance>not ia64 of operating system</Relevance>
		<Relevance><![CDATA[(exists keys whose (exists value "CurrentVersion" whose ((it = "11" AND it >= "11.00.3000") of (it as string as version)) of key "MSSQLServer\CurrentVersion" of it AND exists value "PatchLevel" whose ((it >= "11.1.3300" AND it <= "11.1.3492") of (it as string as version)) of key "Setup" of it) of (keys "HKLM\SOFTWARE\Microsoft\Microsoft SQL Server" of it) of (x32 registry) AND exists ((((if exists match (regex "\((.*)\)") of it then parenthesized part 1 of first match (regex "\((.*)\)") of it else it) of (if it contains "$" then following text of first "$" of it else it)) of display name of it) of services whose (exists file (first match (case insensitive regex "[^%22]*sqlservr.exe") of (image path of it)) whose ((it = "11" AND it >= "11.00.3000") of product version of it)) , names of values of keys "HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL" of (x32 registry)) whose (item 0 of it = item 1 of it))]]></Relevance>
		<Relevance><![CDATA[(((if (exists keys ((names of values of keys ("A353625011B522B48AB5ABDEB4E746F5") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (exists key "InstallProperties" whose ((it = "11.1.3000.0") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "806C3EF53EA538F439626468978D0AB9" of key "Patches" of it) of it) then (1) else (if (exists keys ("5F689E861F127DA449230CD68F06BF1B") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("CEF9C9293788A1A42A90A94F238E1E1D") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (not exists key "937B971BF5896BB40BD80A62BE34E30A" of key "Patches" of it) of it) then (1) else (if (exists keys ("F1115E1392FCD0F41B46F313702F5337") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("CEF9C9293788A1A42A90A94F238E1E1D") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (not exists key "4A42841E199DBF7459EDDD43E24E355D" of key "Patches" of it) of it) then (1) else (if (exists keys ("D490A7D09F8109A4D83F1A8F31AB7805") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("DA83A38C7F2500F4CB2D1ADE687EA0FC") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (not exists key "37C040746D168104DA71F49A72CA32FE" of key "Patches" of it) of it) then (1) else (if (exists keys ("B85D98A2C4EB1B6499FB44FA50675B3E") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("8739C29D42FCA014EBE2A269C2E43876") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (not exists key "98782BA5EA6A4CD4494CB0A775209536" of key "Patches" of it) of it) then (1) else (if (exists keys ("A8ADD4E3B39082F4BAE194A5244A1F4B") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("8739C29D42FCA014EBE2A269C2E43876") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (not exists key "7706D1A06684F154DA33DC88E85CBBEB" of key "Patches" of it) of it) then (1) else (if (exists keys ("4D3D0763A9037A54BA3AFF78D74210B6") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("919CDF19B4332B54899365456A8780E2") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (exists key "InstallProperties" whose ((it = "11.1.3000.0") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "4642CF33C9D934E49A6691444CA12677" of key "Patches" of it) of it) then (1) else (if (exists keys ("A632435D43F1769448BCA3E70F8A81A5") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("6961309E93DD52C4ABBE24F52F2897AE") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (exists key "InstallProperties" whose ((it = "11.1.3000.0") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "13F1F791C4E20E84AA085BBCC83EA18D" of key "Patches" of it) of it) then (1) else (if (exists keys ("14EE3A5743886FA4F871EA41E50F89B0") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("FD1E8D56102635B40A9F6E458F8EF079") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (exists key "InstallProperties" whose ((it = "11.1.3000.0") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "CBEF9DBA7771B754891A419436C35BFF" of key "Patches" of it) of it) then (1) else (if (exists keys ("DD778B628A8D84046A829D72ACC93937") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("167F57B58CABCB333A1864D4DD8D313A") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose ((name of it = "1926E8D15D0BCE53481466615F760A7F") AND exists key "InstallProperties" whose ((it = "10.0.40219") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "4D54076CED4F5BA32BBD3E5FAD1CD4C9" of key "Patches" of it) of it) then (1) else (if (exists keys ("1926E8D15D0BCE53481466615F760A7F") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("A2D1F4F1AD9DFC2399908484D50AD65D") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose ((name of it = "1D5E3C0FEDA1E123187686FED06E995A") AND exists key "InstallProperties" whose ((it = "10.0.40219") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "2D0058F6F08A743309184BE1178C95B2" of key "Patches" of it) of it) then (1) else (if (exists keys ("1D5E3C0FEDA1E123187686FED06E995A") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("92195A165D1E47944B17DEC79B149006") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (exists key "InstallProperties" whose ((it = "11.1.3000.0") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "3F5FADDA25964C34BB9F423247272FAE" of key "Patches" of it) of it) then (1) else (if (exists keys ("57E339FB6A4B88649A102B009E2A297E") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("F0ACD9490057793429DF53ED0962CC7E") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (exists key "InstallProperties" whose ((it = "11.1.3000.0") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "EF76720FF29A8FA4CBA3A0A9CACF35BD" of key "Patches" of it) of it) then (1) else (if (exists keys ("A246991D02B90C64EAA3DF9645410885") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("51BBDBB40F9AC774CB50DD7751B40289") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (exists key "InstallProperties" whose ((it = "11.1.3000.0") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "F53E9F69D6D0A854B8660E09F867948B" of key "Patches" of it) of it) then (1) else (if (exists keys ("661D5AEA2C0E8F446A4BF6D278C8B484") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("6FAAD9988C5D85145BD1FD34D522B2A0") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (exists key "InstallProperties" whose ((it = "11.0.2100.60") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "9AA157C065628354B8B5AF57A59A8DBE" of key "Patches" of it) of it) then (1) else (if (exists keys ("61A08A96E8128B843870BCA7F39AD6E7") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("29285EA24D4EDC24EB701B6A8AE0213C") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (exists key "InstallProperties" whose ((it = "11.0.2100.60") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "50030BC6006A25144A8C859187D6BF0C" of key "Patches" of it) of it) then (1) else (if (exists keys ("D3362818AB2D3BE40BACEB9806B71500") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("EDB280B27AFE1D84CB48E6EEE8DDD084") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (exists key "InstallProperties" whose ((it = "11.1.3000.0") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "72792DF72587DCE4A992DA96D712E808" of key "Patches" of it) of it) then (1) else (if (exists keys ("E5FC05014A821DF4CB1D8606BD4078A9") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("9BCD57287E3DBE2469EEB4D138C739E9") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (exists key "InstallProperties" whose ((it = "11.1.3000.0") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "F8E8A66EE7250B347B0D89784EB8725A" of key "Patches" of it) of it) then (1) else (if (exists keys ("8AF694524A94CB044BDB942E706298CD") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("BCF8B14C7F6EB3F4B80653D73CD93C5A") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (exists key "InstallProperties" whose ((it = "11.1.3000.0") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "799011D3FFB3CD248AFE7E087A32D5A7" of key "Patches" of it) of it) then (1) else (if (exists keys ("0689732AFC456884AA6224DE7867B45E") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("E47914A2BF58D244D80465013D9ABC3F") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (exists key "InstallProperties" whose ((it = "11.1.3000.0") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "4AE18CA78544596499A5902AAB97A1F6" of key "Patches" of it) of it) then (1) else (if (exists keys ("F6A04DED77CABB64EA8F2A0846CA138E") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("4F30261151460FD44A25DF14FE1E16F2") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (exists key "InstallProperties" whose ((it = "11.1.3000.0") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "CC45871AB5EF2DA4786F3F78908E6F3E" of key "Patches" of it) of it) then (1) else (if (exists keys ("685591045BF53BE4C8A79CC4C1568014") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("723E8BD27CB6ACE4A90933511E37CEB8") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (exists key "InstallProperties" whose ((it = "11.1.3000.0") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "ECBD88180461D094B979F87AD2C9B32C" of key "Patches" of it) of it) then (1) else (if (exists keys ("BDFD06D98A81E5848B7380484FD156EE") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("13A48F0B210A85241860A2259F57E101") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (exists key "InstallProperties" whose ((it = "11.1.3000.0") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "895F3D6EC4B432A4791E2641D480B816" of key "Patches" of it) of it) then (1) else (if (exists keys ("72A3E0780FCD3A64ABA169B4BB18B07D") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("DC89A2834C67C8F4CBFC0EA8711FE257") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (exists key "InstallProperties" whose ((it = "11.1.3000.0") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "85E6EF5BF04549A498D77C8BBE40CA8C" of key "Patches" of it) of it) then (1) else (if (exists keys ("B25B1E6F6BAED9C4FAE0052AB3C57EFA") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("07E861537D803C940A692F6DBAD5812C") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (exists key "InstallProperties" whose ((it = "11.1.3000.0") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "9015ABAEE798D2747A1F1F2FAE85E21A" of key "Patches" of it) of it) then (1) else (if (exists keys ("8626358D08C528B4885B967FF98DC5F5") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("B600262F9F21B0345A5860ED2E68847A") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (exists key "InstallProperties" whose ((it = "11.1.3000.0") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "29FB1FEF65322834B9248A752CA1EBF5" of key "Patches" of it) of it) then (1) else (if (exists keys ("FEB60E0397BBB42409CD1F9F6A9780DB") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("B93AA999B7DD2E846BF811B2D4CE5612") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (exists key "InstallProperties" whose ((it = "11.1.3000.0") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "40EF0AC86022F9F469BD4F20C87C104D" of key "Patches" of it) of it) then (1) else (if (exists keys ("E4EA167D4D84A074CB8DEF8C9906EEAC") of it) then (0) else (0)))) + ((if (exists keys ((names of values of keys ("E9851AC62D08D94429455FAEFEA516AA") of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UpgradeCodes" of native registry)) whose (exists key "InstallProperties" whose ((it = "11.1.3000.0") of (value "DisplayVersion" of it as string as version)) of it AND not exists key "2E61DE6B28685F84AB6007E2F0C7C2C5" of key "Patches" of it) of it) then (1) else (if (exists keys ("B606E9A26DD3FAC46BDDEA12D9286584") of it) then (0) else (0))))) of key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Products" of native registry > 0]]></Relevance>
		<Category>Security Update</Category>
		<DownloadSize>509131968</DownloadSize>
		<Source>Microsoft</Source>
		<SourceID>KB3045317</SourceID>
		<SourceReleaseDate>2015-07-14</SourceReleaseDate>
		<SourceSeverity>Important</SourceSeverity>
		<CVENames>CVE-2015-1761; CVE-2015-1762; CVE-2015-1763</CVENames>
		<MIMEField>
			<Name>x-fixlet-first-propagation</Name>
			<Value>Wed, 15 Jul 2015 03:45:43 +0000</Value>
		</MIMEField>
		<MIMEField>
			<Name>no-relevance-health-check</Name>
			<Value>false</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-cpe23-item-name</Name>
			<Value>cpe:2.3:a:microsoft:sql_server:2012:sp1:*:*:*:*:*:*</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-product-family</Name>
			<Value>SQL Server</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-component</Name>
			<Value>Unspecified</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-product</Name>
			<Value>SQL Server 2012</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-modification-time</Name>
			<Value>Wed, 22 Mar 2017 02:20:47 +0000</Value>
		</MIMEField>
		<Delay>PT1S</Delay>
		<Action ID="Action1">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> to initiate the deployment process.</PostLink>
			</Description>
			<ActionScript MIMEType="application/x-Fixlet-Windows-Shell">prefetch SQLServer2012-KB3045317-x86.exe sha1:ec5fc12a75627f26d21c0ead8752af37ff9162f4 size:509131968 http://download.microsoft.com/download/4/6/0/4606DFD6-1F1E-4DCF-8F0F-A0492929D31B/SQLServer2012-KB3045317-x86.exe sha256:4ca1eef6c860ca5a009753cd6041b7670dc88b026463ea0aec55ba378e00dd8b

waithidden __Download\SQLServer2012-KB3045317-x86.exe /quiet /allinstances /IAcceptSQLServerLicenseTerms

action may require restart "ec5fc12a75627f26d21c0ead8752af37ff9162f4"
</ActionScript>
		</Action>
		<Action ID="Link2">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> to view this Security Bulletin from Microsoft.</PostLink>
			</Description>
			<ActionScript MIMEType="text/x-uri">http://technet.microsoft.com/library/security/MS15-058</ActionScript>
		</Action>
	</Fixlet>
</BES>
