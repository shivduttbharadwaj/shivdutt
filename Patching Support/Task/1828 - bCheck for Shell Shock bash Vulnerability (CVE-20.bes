<?xml version="1.0" encoding="UTF-8"?>
<BES xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="BES.xsd">
	<Task>
		<Title>Check for "Shell Shock" bash Vulnerability (CVE-2014-7169)</Title>
		<Description><![CDATA[
<TABLE><TBODY><TR><TD>A critical vulnerability in bash has been identified. To determine if systems are vulnerable, run this task. This task will create a file "isBashVulnerable.txt" in the client folder with the state of vulnerability. You can also activate Analysis 1829 ""Shell Shock" bash Vulnerability (CVE-2014-7169) Status" to retrieve the results of this test. To re-evaluate the status, this task must be run again.</TD></TR></TBODY></TABLE>
]]></Description>
		<Relevance>(if exists property "in proxy agent context" then ( not in proxy agent context ) else true ) AND (if exists property "android" of type "operating system" then ( not android of operating system ) else true )  </Relevance>
		<Relevance>not (name of operating system contains "Linux TinyCore")</Relevance>
		<Relevance>(not windows of operating system) AND (if exists property "in proxy agent context" then (not in proxy agent context) else true) AND (if exists property "android" of type "operating system" then (not android of operating system) else true) and not (name of operating system starts with "AIX")</Relevance>
		<Category>Audit</Category>
		<Source>BigFix</Source>
		<SourceID><![CDATA[<Unspecified>]]></SourceID>
		<SourceSeverity></SourceSeverity>
		<MIMEField>
			<Name>x-fixlet-first-propagation</Name>
			<Value>Fri, 26 Sep 2014 00:07:46 +0000</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-modification-time</Name>
			<Value>Tue, 10 Oct 2017 07:35:07 +0000</Value>
		</MIMEField>
		<Delay>PT1S</Delay>
		<DefaultAction ID="Action1">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> to execute this action.</PostLink>
			</Description>
			<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[parameter "scriptFile" = "{parent folder of parent folder of client folder of current site}/detectBashVul.sh"
parameter "outputFile" = "{parent folder of parent folder of client folder of current site}/isBashVulnerable.txt"
delete "{parameter "scriptFile"}"

createfile until __end__
#!/bin/sh
env X="() {{ :;} ; echo vulnerable" /bin/sh -c "echo " > "{parameter "outputFile"}"
env X="() {{ :;} ; echo vulnerable" `which bash` -c "echo " >> "{parameter "outputFile"}"

rm -f echo && env -i  X='() {{ (a)=>\' /bin/sh -c 'echo echo vulnerable'; cat echo  >> "{parameter "outputFile"}"
rm -f echo && env -i  X='() {{ (a)=>\' `which bash` -c 'echo echo vulnerable'; cat echo  >> "{parameter "outputFile"}"

__end__

move __createfile "{parameter "scriptFile"}"
wait chmod 555 "{parameter "scriptFile"}"
wait /bin/sh "{parameter "scriptFile"}"]]></ActionScript>
		</DefaultAction>
	</Task>
</BES>
