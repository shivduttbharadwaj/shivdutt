<?xml version="1.0" encoding="UTF-8"?>
<BES xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="BES.xsd">
	<Fixlet>
		<Title>RealPlayer and IE Zero-day Exploit Patch Released</Title>
		<Description><![CDATA[
<DIV class=FixletMessage>
<TABLE><TBODY><TR><TD> <P>RealNetworks has issued a fix for a security vulnerability, identified <A href="http://www.symantec.com/connect/blogs/realplayer-exploit-loose">here</A> by Symantec. This vulnerability affects the import method of an ActiveX control, which can allow a buffer overflow to occur, and could provide the potential for an attacker to run arbitrary or malicious code on a user's PC.</P> <P>US-CERT also recommends, in addition to applying the RealNetworks patch, that a kill bit be set on a CLSID (FDC7A535-4070-4B92-A0EA-D9994BCC0DC5) related to this vulnerability. The second action below will allow you to set this kill bit.</FONT></P> <P><STRONG><FONT color=#ff0000>Important Note:</FONT> </STRONG>Follow the link for the vulnerability patch download on this <A href="http://service.real.com/realplayer/security/191007_player/en/">page</A>. Alternatively, the direct URL of the patch is "http://service.real.com/realplayer/security/191007_player/en/securitydb.rnx". The file "securitydb.rnx" must be downloaded and run manually once in a test environment with RealPlayer 10.5 installed. Once the patch has been run, the updated file "MPAMedia.dll" from the plug-ins directory of the RealPlayer folder must be renamed to "9dc12fb4500d25f4d4d2dbbd6b69986ed592f9c9" and placed in the BES Server download cache in order for this action to complete successfully. For more information about manually caching file downloads on the BES Server, please see the following BigFix Support Knowledge Base <A href="http://support.bigfix.com/cgi-bin/kbdirect.pl?id=390">article</A>.</P></TD></TR></TBODY></TABLE>
</DIV>
<DIV class=FixletProperty>
<H4>File Size:</H4>
440 KB
 </DIV>
<DIV class=FixletProperty>
<H4>CVE:</H4>
Unspecified
 
</DIV>]]></Description>
		<Relevance>(if( name of operating system starts with "Win" ) then platform id of operating system != 3 else false) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true ) </Relevance>
		<Relevance>name of operating system as lowercase starts with "win"</Relevance>
		<Relevance>exists regapp "realplay.exe"</Relevance>
		<Relevance>not exists values "PROCESSOR_ARCHITECTURE" whose (it as string as lowercase = "ia64") of keys "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" of registry</Relevance>
		<Relevance><![CDATA[(exists key "HKLM\SOFTWARE\Classes\SOFTWARE\RealNetworks\RealPlayer\CurrentVersion" of registry) AND (exists key ("HKLM\SOFTWARE\Classes\SOFTWARE\RealNetworks\RealPlayer\" & ((value of it as string) of key "HKLM\SOFTWARE\Classes\SOFTWARE\RealNetworks\RealPlayer\CurrentVersion" of registry) & "\Preferences\LangID") of registry) AND ((it contains "en" OR it contains "de" OR it contains "es" OR it contains "fr" OR it contains "it" OR it contains "br" OR it contains "cn" OR it contains "ja" OR it contains "ko" OR it contains "tw") of (value of it as string) of key ("HKLM\SOFTWARE\Classes\SOFTWARE\RealNetworks\RealPlayer\" & ((value of it as string) of key "HKLM\SOFTWARE\Classes\SOFTWARE\RealNetworks\RealPlayer\CurrentVersion" of registry) & "\Preferences\LangID") of registry )]]></Relevance>
		<Relevance>exists regapp "realplay.exe" whose (version of it = "6")</Relevance>
		<Relevance>exists regapp "iexplore.exe"</Relevance>
		<Relevance><![CDATA[exists file (preceding text of last "\" of pathname of regapp "realplay.exe" & "\plugins\MPAMedia.dll") whose (version of it < "1.0.4.2840")]]></Relevance>
		<Relevance>NOT exists running application "realplay.exe"</Relevance>
		<Relevance>not exists folder "lang" of parent folder of regapp "realplay.exe"</Relevance>
		<Category>Security Hotfix</Category>
		<DownloadSize>450560</DownloadSize>
		<Source>Real Networks</Source>
		<SourceID>Unspecified</SourceID>
		<SourceReleaseDate>2007-10-19</SourceReleaseDate>
		<SourceSeverity>Unspecified</SourceSeverity>
		<CVENames>Unspecified</CVENames>
		<SANSID>Unspecified</SANSID>
		<MIMEField>
			<Name>x-fixlet-first-propagation</Name>
			<Value>Fri, 15 Apr 2011 03:07:33 +0000</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-domain_attributes</Name>
			<Value>PatchManagement 3rdPartyApp Real RealPlayer</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-modification-time</Name>
			<Value>Mon, 04 Jan 2016 06:55:29 +0000</Value>
		</MIMEField>
		<Delay>PT1S</Delay>
		<DefaultAction ID="Action1">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> to deploy the patch.</PostLink>
			</Description>
			<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[prefetch MPAMedia.dll sha1:9dc12fb4500d25f4d4d2dbbd6b69986ed592f9c9 size:450560 http://service.real.com/MANUAL_BES_CACHING_REQUIRED/MPAMedia.dll

delete "{preceding text of last "\" of pathname of regapp "realplay.exe" & "\plugins\MPAMedia.dll"}"
copy "__Download\MPAMedia.dll" "{preceding text of last "\" of pathname of regapp "realplay.exe" & "\plugins\MPAMedia.dll"}"]]></ActionScript>
		</DefaultAction>
		<Action ID="Action2">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> to deploy the patch and set the kill bit {FDC7A535-4070-4B92-A0EA-D9994BCC0DC5}.</PostLink>
			</Description>
			<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[prefetch MPAMedia.dll sha1:9dc12fb4500d25f4d4d2dbbd6b69986ed592f9c9 size:450560 http://service.real.com/MANUAL_BES_CACHING_REQUIRED/MPAMedia.dll

delete "{preceding text of last "\" of pathname of regapp "realplay.exe" & "\plugins\MPAMedia.dll"}"
copy "__Download\MPAMedia.dll" "{preceding text of last "\" of pathname of regapp "realplay.exe" & "\plugins\MPAMedia.dll"}"

//set setting for pre-existing - if setting already exists then just reset to the same.
setting "{"__IEActiveXKillBit"& "%7bFDC7A535-4070-4B92-A0EA-D9994BCC0DC5%7d"}"="{if (exists setting ("__IEActiveXKillBit"&"%7bFDC7A535-4070-4B92-A0EA-D9994BCC0DC5%7d") whose (exists value of it) of client) then (value of setting ("__IEActiveXKillBit"&"%7bFDC7A535-4070-4B92-A0EA-D9994BCC0DC5%7d") of client) else (if (exists key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility" whose (exists key ("%7bFDC7A535-4070-4B92-A0EA-D9994BCC0DC5%7d") whose (exists value "Compatibility Flags" of it) of it) of registry) then (value "Compatibility Flags" of key ("%7bFDC7A535-4070-4B92-A0EA-D9994BCC0DC5%7d") of key "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility" of registry as integer as hexadecimal) else(""))}" on "{now}" for client

//set killbit
regset "[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{"%7bFDC7A535-4070-4B92-A0EA-D9994BCC0DC5%7d"}]" "Compatibility Flags"=dword:00000400]]></ActionScript>
		</Action>
		<Action ID="Link3">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> to view RealNetwork's release regarding this vulnerability.</PostLink>
			</Description>
			<ActionScript MIMEType="text/x-uri">http://service.real.com/realplayer/security/191007_player/en/</ActionScript>
		</Action>
		<Action ID="Link4">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> for security-related information from RealNetworks.</PostLink>
			</Description>
			<ActionScript MIMEType="text/x-uri">http://service.real.com/realplayer/security/security/</ActionScript>
		</Action>
		<Action ID="Link5">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> for more information from US-CERT regarding this issue.</PostLink>
			</Description>
			<ActionScript MIMEType="text/x-uri">http://www.kb.cert.org/vuls/id/871673</ActionScript>
		</Action>
		<Action ID="Link6">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> for more information from SANS on vulnerabilities in media player applications.</PostLink>
			</Description>
			<ActionScript MIMEType="text/x-uri">http://www.sans.org/top20/#c7</ActionScript>
		</Action>
	</Fixlet>
</BES>
