<?xml version="1.0" encoding="UTF-8"?>
<BES xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="BES.xsd">
	<Fixlet>
		<Title>Import Fixlet and Packages From Remote IEM Server</Title>
		<Description><![CDATA[<P><STRONG><FONT size=3>Action&nbsp;Parameters:</FONT></STRONG></P>
<P>&nbsp;<INPUT onfocus="if (this.value == '10.10.10.10') {this.value = '';}" onblur="if (this.value == '') {this.value = '10.10.10.10';}" id=RemoteIEM title="Enter IP Address or Hostname" value=10.10.10.10 name=RemoteIEM>&nbsp;<FONT color=#0080ff><STRONG>&lt;&lt;</STRONG></FONT> &nbsp;Enter the&nbsp;<U>Exporting</U> IEM Server IP Address or Hostname<BR>&nbsp;<INPUT onfocus="if (this.value == '52311') {this.value = '';}" onblur="if (this.value == '') {this.value = '52311';}" id=RemoteIEMPort title="Enter the IEM communication port" value=52311 name=RemoteIEMPort>&nbsp;<FONT color=#0080ff><STRONG>&lt;&lt;</STRONG></FONT>&nbsp; Enter the&nbsp;<U>Exporting/Importing</U> IEM Server Communication Port<BR>&nbsp;<INPUT onfocus="if (this.value == 'OP Name') {this.value = '';}" onblur="if (this.value == '') {this.value = 'OP Name';}" id=RemoteOP title="Enter the Exporting IEM Server Operator Name" value="OP Name" name=RemoteOP>&nbsp;<FONT color=#0080ff><STRONG>&lt;&lt;&nbsp;</STRONG></FONT> Enter the <U>Exporting</U> IEM Server Operator Name (<STRONG><FONT color=#ff0000>Note:</FONT></STRONG> This account must have <STRONG><EM>READ</EM></STRONG> access on the export site)<BR>&nbsp;<INPUT id=RemoteOPPass title="Enter the Exporting IEM Server Operator Password" type=password name=RemoteOPPass>&nbsp;&nbsp; <FONT color=#0080ff><STRONG>&lt;&lt;</STRONG></FONT>&nbsp; Enter the <U>Exporting</U> IEM Server Operator Password (<FONT color=#ff0000><STRONG>Note:</STRONG></FONT> This password will be <STRONG><EM>encrypted</EM></STRONG>)<BR>&nbsp;<INPUT onfocus="if (this.value == 'custom/<site>') {this.value = '';}" onblur="if (this.value == '') {this.value = 'custom/<site>';}" id=RemoteSite title="Enter the Exporting IEM Server Site" value="custom/<site>" name=RemoteSite>&nbsp;<FONT color=#0080ff><STRONG>&lt;&lt;</STRONG></FONT>&nbsp; Enter the <U>Exporting</U> IEM Server Site<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; (<FONT color=#ff0000><STRONG>Note:</STRONG></FONT> For the Master Action Site type: <EM><STRONG>master</STRONG> -<STRONG> </STRONG></EM>&nbsp;For Custom Sites use: <EM><STRONG>custom/<SITE> </STRONG>-<STRONG> </STRONG></EM>&nbsp; For External Sites use: <STRONG><EM>external/<SITE></EM></STRONG>)<BR>&nbsp;<INPUT onfocus="if (this.value == '6674') {this.value = '';}" onblur="if (this.value == '') {this.value = '6674';}" id=RemoteFixletID title="Enter the Exporting IEM Server Fixlet ID" value=6674 name=RemoteFixletID>&nbsp;<STRONG><FONT color=#0080ff>&lt;&lt;</FONT></STRONG>&nbsp; Enter the&nbsp;<U>Exporting</U> IEM Server Fixlet ID (Fixlet, Task, Analyses or Group ID) (<STRONG><FONT color=#ff0000>Note:</FONT></STRONG> for Groups, remove the '##-' prefix from the ID)<BR>&nbsp;<INPUT onfocus="if (this.value == 'custom/<site>') {this.value = '';}" onblur="if (this.value == '') {this.value = 'custom/<site>';}" id=LocalSite title="Enter the Importing IEM Server Site" value="custom/<site>" name=LocalSite>&nbsp;<STRONG><FONT color=#0080ff>&lt;&lt;</FONT></STRONG>&nbsp; Enter the <U>Importing</U> IEM Server Site<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;(<STRONG><FONT color=#ff0000>Note:</FONT></STRONG> For the Master Action Site type: <EM><STRONG>master</STRONG> -<STRONG> </STRONG></EM>&nbsp;For Custom Sites use: <EM><STRONG>custom/<SITE> </STRONG>-<STRONG> </STRONG></EM>&nbsp; For External Sites use: <STRONG><EM>external/<SITE></EM></STRONG>)<BR>&nbsp;<INPUT onfocus="if (this.value == 'OP Name') {this.value = '';}" onblur="if (this.value == '') {this.value = 'OP Name';}" id=LocalOP title="Enter the Importing IEM Server Operator Name" value="OP Name" name=LocalOP>&nbsp;<FONT color=#0080ff><STRONG>&lt;&lt;&nbsp;</STRONG><FONT color=#000000> Enter the&nbsp;<U>Importing</U> IEM Server Operator Name (</FONT><FONT color=#ff0000><STRONG>Note:</STRONG></FONT><FONT color=#000000> This account must have&nbsp;<EM><STRONG>WRITE</STRONG></EM> access on the import site)</FONT><BR></FONT>&nbsp;<INPUT id=LocalOPPass title="Enter the Importing IEM Server Operator Password" type=password name=LocalOPPass>&nbsp;&nbsp; <STRONG><FONT color=#0080ff>&lt;&lt;</FONT></STRONG>&nbsp; Enter the&nbsp;<U>Importing</U> IEM Server Operator Password (<FONT color=#ff0000><STRONG>Note:</STRONG></FONT> This password will be <STRONG><EM>encrypted</EM></STRONG>)<BR>&nbsp;<INPUT onfocus="if (this.value == 'no') {this.value = '';}" onblur="if (this.value == '') {this.value = 'no';}" id=ImportPkg title="Enter yes or no" value=no name=ImportPkg>&nbsp;<STRONG><FONT color=#0080ff>&lt;&lt;</FONT></STRONG> Import Pre-Cached Packages?<BR><script>
			document.body.ontakeaction = function() {
				var theRemoteIEM = document.getElementById( "RemoteIEM" ).value;
				var theRemoteIEMPort = document.getElementById( "RemoteIEMPort" ).value;
				var theRemoteOP = document.getElementById( "RemoteOP" ).value;
				var theRemoteOPPass = document.getElementById( "RemoteOPPass" ).value;
				var theRemoteSite = document.getElementById( "RemoteSite" ).value;
				var theRemoteFixletID = document.getElementById( "RemoteFixletID" ).value;
				var theLocalSite = document.getElementById( "LocalSite" ).value;
				var theLocalOP = document.getElementById( "LocalOP" ).value;
				var theLocalOPPass = document.getElementById( "LocalOPPass" ).value;
				var theImportPkg = document.getElementById( "ImportPkg" ).value;
				TakeSecureFixletAction( Relevance('id of current fixlet'), Relevance('id of current bes site'), "Action1", {}, { RemoteIEM: theRemoteIEM , RemoteIEMPort: theRemoteIEMPort , RemoteOP: theRemoteOP , RemoteOPPass: theRemoteOPPass , RemoteSite: theRemoteSite , RemoteFixletID: theRemoteFixletID , LocalSite: theLocalSite , LocalOP: theLocalOP , LocalOPPass: theLocalOPPass , ImportPkg: theImportPkg } );
				return false;
			}
			</script><BR><STRONG>_____________________________________________________________________________________________________</STRONG> </P>
<P><STRONG>Description:</STRONG></P>
<UL>
<LI>This Task will export a single&nbsp;Fixlet, Task, Baseline, Group&nbsp;or Analyses from a remote IEM Server&nbsp;and import it. 
<UL>
<LI>&nbsp;The&nbsp;action must be deployed on the Importing IEM Server&nbsp; <BR></LI></UL>
<LI>Fixlets and Tasks with packages that are pre-cached&nbsp;will also be downloaded and placed in the same directory structure as the Remote IEM Server (You must type 'yes' in the 'Import Pre-cached Packages' field&nbsp;to enable this option) 
<UL>
<LI>If more than 10 pre-cached packages are required, you will need to expand the tuple range in the action script 
<LI>This will work on Software Distribution Tasks utilizing SWDProtocol as well as task utilizing DOWNLOAD and PREFETCH commands. 
<LI>This will NOT import packages into the SWD Manage Software Distribution Dashboard 
<UL>
<LI>Imported SWD Tasks will be available in the&nbsp;Software Package Distribution Tasks<BR></LI></UL></LI></UL>
<LI>Download URL's for pre-cached packages that are not pointing to either 127.0.0.1 or localhost will be modified to point to 127.0.0.1<BR>
<LI>The logs <EM>import.txt</EM>, <EM>import_err.txt</EM> and <EM>export_err.txt</EM> located in <EM>C:\Import</EM> can be used for troubleshooting</LI></UL>
<P><STRONG>Use Case:<BR></STRONG>Can be used to propagate IEM content between different systems (eg: Development &gt; QA &gt; Production)</P>
<P><STRONG>Prerequisites:<BR></STRONG>Importing and Exporting IEM server must be version 9.x (This utilizes the REST API)<BR><BR>Importing IEM Server&nbsp;must have <A href="http://gnuwin32.sourceforge.net/packages/wget.htm">Wget for Windows</A>&nbsp;installed (default location: %ProgramFiles(x86)%\GnuWin32)<BR>(This is required as the REST API does not currently support exporting and the Action Script Download commands do not support HTTPS)<BR><BR>Importing IEM Sever must have directory C:\Imports (will be created if it does not exist)</P>
<P>Importing IEM Server must have Operator account with write permission on the site importing to.</P>
<P>Exporting IEM Server must have normal operator account with read permissions on site exporting from.<BR>(It may be best to create an 'EXPORT' operator account with read permission for all sites but manages no endpoints.)</P>
<P>&nbsp;</P>]]></Description>
		<Relevance>exists main gather service</Relevance>
		<Relevance>(if( name of operating system starts with "Win" ) then platform id of operating system != 3 else true) AND (if exists property "in proxy agent context" then ( not in proxy agent context ) else true ) </Relevance>
		<Relevance><![CDATA[version of client >= "9.0"]]></Relevance>
		<Category></Category>
		<Source>mike.english@us.ibm.com</Source>
		<SourceID></SourceID>
		<SourceReleaseDate>2013-11-19</SourceReleaseDate>
		<SourceSeverity></SourceSeverity>
		<CVENames></CVENames>
		<SANSID></SANSID>
		<MIMEField>
			<Name>bigfixme-added-time</Name>
			<Value>Sat, 05 Apr 2014 06:21:31 GMT</Value>
		</MIMEField>
		<MIMEField>
			<Name>bigfixme-modification-time</Name>
			<Value>Sat, 05 Apr 2014 06:21:31 GMT</Value>
		</MIMEField>
		<MIMEField>
			<Name>bigfixme-keywords</Name>
			<Value>Content Promotion from one IEM server to another</Value>
		</MIMEField>
		<MIMEField>
			<Name>bigfixme-ID</Name>
			<Value>3757</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-modification-time</Name>
			<Value>Tue, 30 Jul 2019 10:29:47 +0000</Value>
		</MIMEField>
		<Domain>BESC</Domain>
		<DefaultAction ID="Action3">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> to deploy this action.</PostLink>
			</Description>
			<ActionScript MIMEType="application/x-Fixlet-Windows-Shell">// Enter your action script here
//Check for C:\Import
if {not exist folder "c:\import"}
	wait mkdir "c:\import"
endif

</ActionScript>
		</DefaultAction>
		<Action ID="Action1">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> to deploy this action.</PostLink>
			</Description>
			<ActionScript MIMEType="application/x-Fixlet-Windows-Shell"><![CDATA[//Check for C:\Import
if {not exist folder "c:\import"}
	dos mkdir "c:\import"
endif

//Check for Wget installation
if {not exist file ((value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe")}
	dos echo "EXPORT ERROR: Wget is not installed" > "c:\import\export_err.txt"
endif

continue if {exist file ((value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe")}

//Export fixlet from remote IEM server
delete c:\IMPORT\{parameter "RemoteFixletID" of action}.xml
delete c:\IMPORT\{parameter "RemoteFixletID" of action}.bak
delete c:\IMPORT\import.txt
delete c:\IMPORT\import_err.txt
delete c:\IMPORT\export_err.txt
//wait {((value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe")} -a c:\import\import.txt -O c:\IMPORT\{parameter "RemoteFixletID" of action}.xml --user={parameter "RemoteOP" of action} --password={parameter "RemoteOPPass" of action} "https:{"//"}{parameter "RemoteIEM" of action}:{parameter "RemoteIEMPort" of action}/api/fixlet/{parameter "RemoteSite" of action}/{parameter "RemoteFixletID" of action}" --no-check-certificate
wait {("%22" & (value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe" & "%22")} -a c:\import\import.txt -O c:\IMPORT\{parameter "RemoteFixletID" of action}.xml --user={parameter "RemoteOP" of action} --password={parameter "RemoteOPPass" of action} "https:{"//"}{parameter "RemoteIEM" of action}:{parameter "RemoteIEMPort" of action}/api/fixlet/{parameter "RemoteSite" of action}/{parameter "RemoteFixletID" of action}" --no-check-certificate

//check for errors
if {size of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml") = 0}
	dos echo "EXPORT ERROR: Check username/password, Site Name and Fixlet ID" > "c:\import\export_err.txt"
endif

continue if {size of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml") > 0}

//iterate through the xml replacing hostname where necessary
delete __appendfile
appendfile {concatenation "%0d%0a" of ( if (it contains (tuple string item 0 of concatenation ", " of (preceding texts of firsts (":" & (parameter "RemoteIEMPort" of action)) of (following texts of firsts "://" of (lines whose (it as lowercase contains "uploads" and it contains (":" & (parameter "RemoteIEMPort" of action))) of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) | false then ((preceding text of first (tuple string item 0 of concatenation ", " of (preceding texts of firsts (":" & (parameter "RemoteIEMPort" of action)) of (following texts of firsts "://" of (lines whose (it as lowercase contains "uploads" and it contains (":" & (parameter "RemoteIEMPort" of action))) of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml"))))) of it) & "127.0.0.1" & (following text of first (tuple string item 0 of concatenation ", " of (preceding texts of firsts (":" & (parameter "RemoteIEMPort" of action)) of (following texts of firsts "://" of (lines whose (it as lowercase contains "uploads" and it contains (":" & (parameter "RemoteIEMPort" of action))) of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml"))))) of it) ) else it ) of lines of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")}
// backup the old file
move {("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")} {("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".bak")}
// replace with the new file
move __appendfile {("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")}


//Login API
//dos {preceding text of last "\" of (expand environment string of (image path of service "FILLDB")) & "\IEM CLI\iem.exe%22"} login -q --server=localhost --user={parameter "LocalOP" of action} --password={parameter "LocalOPPass" of action} 2> c:\import\import_err.txt
dos {preceding text of last "\" of (expand environment string of (image path of service "FILLDB")) & "\IEM CLI\iem.exe%22"} login -q --server=https://10.53.19.248:52311 --user={parameter "LocalOP" of action} --password={parameter "LocalOPPass" of action} 2> c:\import\import_err.txt

//check for login errors errors
//continue if {exist file "c:\import\import_err.txt" whose (not exist line 1 of it)}
continue if {(not exists file "c:\import\import_err.txt") or (exist file "c:\import\import_err.txt" whose (not exist line 1 of it))}

//Import Fixlet
dos {preceding text of last "\" of (expand environment string of (image path of service "FILLDB")) & "\IEM CLI\iem.exe%22"} post c:\import\{parameter "RemoteFixletID" of action}.xml import/{parameter "LocalSite" of action} 1>> c:\import\import.txt 2> c:\import\import_err.txt

//check for invalid local site
//continue if {exist file "c:\import\import_err.txt" whose (not exist line 1 of it)}
continue if {(not exists file "c:\import\import_err.txt") or (exist file "c:\import\import_err.txt" whose (not exist line 1 of it))}

//Import packages pre-cached on remote IEM Server
if {parameter "ImportPkg" of action = "yes"}
	
	if {exists tuple string item 0 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml"))}
		if {(it as lowercase = "localhost" or it = "127.0.0.1") of (preceding text of first (":" & (parameter "RemoteIEMPort" of action)) of (following text of first "http://" of ("http://" & (following text of first "://" of (tuple string item 0 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml"))))))))}
			wait { ((value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe")} -a c:\import\import.txt -P {(concatenation "/" of  (substrings separated by "\" of (preceding text of last "\" of (expand environment string of (image path of service "FILLDB")) & "\wwwrootbes\" & ( (preceding text of last "/" of following text of first (":" & (parameter "RemoteIEMPort" of action) & "/") of tuple string item 0 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) & "/%22")} {concatenation (parameter "RemoteIEM" of action) of (substrings separated by (preceding text of first (":" & (parameter "RemoteIEMPort" of action)) of (following text of first "//" of (tuple string item 0 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) of ("http://" & (following text of first "://" of (tuple string item 0 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))))}
		else 
			wait { ((value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe")} -a c:\import\import.txt -P {(concatenation "/" of (substrings separated by "\" of (preceding text of last "\" of (expand environment string of (image path of service "FILLDB")) & "\wwwrootbes\" & ( (preceding text of last "/" of following text of first (":" & (parameter "RemoteIEMPort" of action) & "/") of tuple string item 0 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) & "/%22")} {"http://" & (parameter "RemoteIEM" of action) & ":" & (parameter "RemoteIEMPort" of action) &  (following text of first ":52311" of (tuple string item 0 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))}
		endif
	endif
	
	if {exists tuple string item 1 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml"))}
		if {(it as lowercase = "localhost" or it = "127.0.0.1") of (preceding text of first (":" & (parameter "RemoteIEMPort" of action)) of (following text of first "http://" of ("http://" & (following text of first "://" of (tuple string item 1 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml"))))))))}
			wait { ((value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe")} -a c:\import\import.txt -P {(concatenation "/" of  (substrings separated by "\" of (preceding text of last "\" of (expand environment string of (image path of service "FILLDB")) & "\wwwrootbes\" & ( (preceding text of last "/" of following text of first (":" & (parameter "RemoteIEMPort" of action) & "/") of tuple string item 1 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) & "/%22")} {concatenation (parameter "RemoteIEM" of action) of (substrings separated by (preceding text of first (":" & (parameter "RemoteIEMPort" of action)) of (following text of first "//" of (tuple string item 1 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) of ("http://" & (following text of first "://" of (tuple string item 1 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))))}
		else 
			wait { ((value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe")} -a c:\import\import.txt -P {(concatenation "/" of (substrings separated by "\" of (preceding text of last "\" of (expand environment string of (image path of service "FILLDB")) & "\wwwrootbes\" & ( (preceding text of last "/" of following text of first (":" & (parameter "RemoteIEMPort" of action) & "/") of tuple string item 1 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) & "/%22")} {"http://" & (parameter "RemoteIEM" of action) & ":" & (parameter "RemoteIEMPort" of action) &  (following text of first ":52311" of (tuple string item 1 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))}
		endif
	endif

	if {exists tuple string item 2 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml"))}
		if {(it as lowercase = "localhost" or it = "127.0.0.1") of (preceding text of first (":" & (parameter "RemoteIEMPort" of action)) of (following text of first "http://" of ("http://" & (following text of first "://" of (tuple string item 2 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml"))))))))}
			wait { ((value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe")} -a c:\import\import.txt -P {(concatenation "/" of  (substrings separated by "\" of (preceding text of last "\" of (expand environment string of (image path of service "FILLDB")) & "\wwwrootbes\" & ( (preceding text of last "/" of following text of first (":" & (parameter "RemoteIEMPort" of action) & "/") of tuple string item 2 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) & "/%22")} {concatenation (parameter "RemoteIEM" of action) of (substrings separated by (preceding text of first (":" & (parameter "RemoteIEMPort" of action)) of (following text of first "//" of (tuple string item 2 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) of ("http://" & (following text of first "://" of (tuple string item 2 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))))}
		else 
			wait { ((value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe")} -a c:\import\import.txt -P {(concatenation "/" of (substrings separated by "\" of (preceding text of last "\" of (expand environment string of (image path of service "FILLDB")) & "\wwwrootbes\" & ( (preceding text of last "/" of following text of first (":" & (parameter "RemoteIEMPort" of action) & "/") of tuple string item 2 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) & "/%22")} {"http://" & (parameter "RemoteIEM" of action) & ":" & (parameter "RemoteIEMPort" of action) &  (following text of first ":52311" of (tuple string item 2 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))}
		endif
	endif
	
	if {exists tuple string item 3 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml"))}
		if {(it as lowercase = "localhost" or it = "127.0.0.1") of (preceding text of first (":" & (parameter "RemoteIEMPort" of action)) of (following text of first "http://" of ("http://" & (following text of first "://" of (tuple string item 3 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml"))))))))}
			wait { ((value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe")} -a c:\import\import.txt -P {(concatenation "/" of  (substrings separated by "\" of (preceding text of last "\" of (expand environment string of (image path of service "FILLDB")) & "\wwwrootbes\" & ( (preceding text of last "/" of following text of first (":" & (parameter "RemoteIEMPort" of action) & "/") of tuple string item 3 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) & "/%22")} {concatenation (parameter "RemoteIEM" of action) of (substrings separated by (preceding text of first (":" & (parameter "RemoteIEMPort" of action)) of (following text of first "//" of (tuple string item 3 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) of ("http://" & (following text of first "://" of (tuple string item 3 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))))}
		else 
			wait { ((value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe")} -a c:\import\import.txt -P {(concatenation "/" of (substrings separated by "\" of (preceding text of last "\" of (expand environment string of (image path of service "FILLDB")) & "\wwwrootbes\" & ( (preceding text of last "/" of following text of first (":" & (parameter "RemoteIEMPort" of action) & "/") of tuple string item 3 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) & "/%22")} {"http://" & (parameter "RemoteIEM" of action) & ":" & (parameter "RemoteIEMPort" of action) &  (following text of first ":52311" of (tuple string item 3 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))}
		endif
	endif
	
	if {exists tuple string item 4 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml"))}
		if {(it as lowercase = "localhost" or it = "127.0.0.1") of (preceding text of first (":" & (parameter "RemoteIEMPort" of action)) of (following text of first "http://" of ("http://" & (following text of first "://" of (tuple string item 4 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml"))))))))}
			wait { ((value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe")} -a c:\import\import.txt -P {(concatenation "/" of  (substrings separated by "\" of (preceding text of last "\" of (expand environment string of (image path of service "FILLDB")) & "\wwwrootbes\" & ( (preceding text of last "/" of following text of first (":" & (parameter "RemoteIEMPort" of action) & "/") of tuple string item 4 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) & "/%22")} {concatenation (parameter "RemoteIEM" of action) of (substrings separated by (preceding text of first (":" & (parameter "RemoteIEMPort" of action)) of (following text of first "//" of (tuple string item 4 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) of ("http://" & (following text of first "://" of (tuple string item 4 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))))}
		else 
			wait { ((value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe")} -a c:\import\import.txt -P {(concatenation "/" of (substrings separated by "\" of (preceding text of last "\" of (expand environment string of (image path of service "FILLDB")) & "\wwwrootbes\" & ( (preceding text of last "/" of following text of first (":" & (parameter "RemoteIEMPort" of action) & "/") of tuple string item 4 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) & "/%22")} {"http://" & (parameter "RemoteIEM" of action) & ":" & (parameter "RemoteIEMPort" of action) &  (following text of first ":52311" of (tuple string item 4 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))}
		endif
	endif
	
	if {exists tuple string item 5 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml"))}
		if {(it as lowercase = "localhost" or it = "127.0.0.1") of (preceding text of first (":" & (parameter "RemoteIEMPort" of action)) of (following text of first "http://" of ("http://" & (following text of first "://" of (tuple string item 5 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml"))))))))}
			wait { ((value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe")} -a c:\import\import.txt -P {(concatenation "/" of  (substrings separated by "\" of (preceding text of last "\" of (expand environment string of (image path of service "FILLDB")) & "\wwwrootbes\" & ( (preceding text of last "/" of following text of first (":" & (parameter "RemoteIEMPort" of action) & "/") of tuple string item 5 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) & "/%22")} {concatenation (parameter "RemoteIEM" of action) of (substrings separated by (preceding text of first (":" & (parameter "RemoteIEMPort" of action)) of (following text of first "//" of (tuple string item 5 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) of ("http://" & (following text of first "://" of (tuple string item 5 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))))}
		else 
			wait { ((value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe")} -a c:\import\import.txt -P {(concatenation "/" of (substrings separated by "\" of (preceding text of last "\" of (expand environment string of (image path of service "FILLDB")) & "\wwwrootbes\" & ( (preceding text of last "/" of following text of first (":" & (parameter "RemoteIEMPort" of action) & "/") of tuple string item 5 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) & "/%22")} {"http://" & (parameter "RemoteIEM" of action) & ":" & (parameter "RemoteIEMPort" of action) &  (following text of first ":52311" of (tuple string item 5 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))}
		endif
	endif
	
	if {exists tuple string item 6 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml"))}
		if {(it as lowercase = "localhost" or it = "127.0.0.1") of (preceding text of first (":" & (parameter "RemoteIEMPort" of action)) of (following text of first "http://" of ("http://" & (following text of first "://" of (tuple string item 6 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml"))))))))}
			wait { ((value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe")} -a c:\import\import.txt -P {(concatenation "/" of  (substrings separated by "\" of (preceding text of last "\" of (expand environment string of (image path of service "FILLDB")) & "\wwwrootbes\" & ( (preceding text of last "/" of following text of first (":" & (parameter "RemoteIEMPort" of action) & "/") of tuple string item 6 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) & "/%22")} {concatenation (parameter "RemoteIEM" of action) of (substrings separated by (preceding text of first (":" & (parameter "RemoteIEMPort" of action)) of (following text of first "//" of (tuple string item 6 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) of ("http://" & (following text of first "://" of (tuple string item 6 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))))}
		else 
			wait { ((value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe")} -a c:\import\import.txt -P {(concatenation "/" of (substrings separated by "\" of (preceding text of last "\" of (expand environment string of (image path of service "FILLDB")) & "\wwwrootbes\" & ( (preceding text of last "/" of following text of first (":" & (parameter "RemoteIEMPort" of action) & "/") of tuple string item 6 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) & "/%22")} {"http://" & (parameter "RemoteIEM" of action) & ":" & (parameter "RemoteIEMPort" of action) &  (following text of first ":52311" of (tuple string item 6 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))}
		endif
	endif
	
	if {exists tuple string item 7 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml"))}
		if {(it as lowercase = "localhost" or it = "127.0.0.1") of (preceding text of first (":" & (parameter "RemoteIEMPort" of action)) of (following text of first "http://" of ("http://" & (following text of first "://" of (tuple string item 7 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml"))))))))}
			wait { ((value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe")} -a c:\import\import.txt -P {(concatenation "/" of  (substrings separated by "\" of (preceding text of last "\" of (expand environment string of (image path of service "FILLDB")) & "\wwwrootbes\" & ( (preceding text of last "/" of following text of first (":" & (parameter "RemoteIEMPort" of action) & "/") of tuple string item 7 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) & "/%22")} {concatenation (parameter "RemoteIEM" of action) of (substrings separated by (preceding text of first (":" & (parameter "RemoteIEMPort" of action)) of (following text of first "//" of (tuple string item 7 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) of ("http://" & (following text of first "://" of (tuple string item 7 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))))}
		else 
			wait { ((value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe")} -a c:\import\import.txt -P {(concatenation "/" of (substrings separated by "\" of (preceding text of last "\" of (expand environment string of (image path of service "FILLDB")) & "\wwwrootbes\" & ( (preceding text of last "/" of following text of first (":" & (parameter "RemoteIEMPort" of action) & "/") of tuple string item 7 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) & "/%22")} {"http://" & (parameter "RemoteIEM" of action) & ":" & (parameter "RemoteIEMPort" of action) &  (following text of first ":52311" of (tuple string item 7 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))}
		endif
	endif
	
	if {exists tuple string item 8 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml"))}
		if {(it as lowercase = "localhost" or it = "127.0.0.1") of (preceding text of first (":" & (parameter "RemoteIEMPort" of action)) of (following text of first "http://" of ("http://" & (following text of first "://" of (tuple string item 8 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml"))))))))}
			wait { ((value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe")} -a c:\import\import.txt -P {(concatenation "/" of  (substrings separated by "\" of (preceding text of last "\" of (expand environment string of (image path of service "FILLDB")) & "\wwwrootbes\" & ( (preceding text of last "/" of following text of first (":" & (parameter "RemoteIEMPort" of action) & "/") of tuple string item 8 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) & "/%22")} {concatenation (parameter "RemoteIEM" of action) of (substrings separated by (preceding text of first (":" & (parameter "RemoteIEMPort" of action)) of (following text of first "//" of (tuple string item 8 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) of ("http://" & (following text of first "://" of (tuple string item 8 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))))}
		else 
			wait { ((value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe")} -a c:\import\import.txt -P {(concatenation "/" of (substrings separated by "\" of (preceding text of last "\" of (expand environment string of (image path of service "FILLDB")) & "\wwwrootbes\" & ( (preceding text of last "/" of following text of first (":" & (parameter "RemoteIEMPort" of action) & "/") of tuple string item 8 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) & "/%22")} {"http://" & (parameter "RemoteIEM" of action) & ":" & (parameter "RemoteIEMPort" of action) &  (following text of first ":52311" of (tuple string item 8 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))}
		endif
	endif
	
	if {exists tuple string item 9 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml"))}
		if {(it as lowercase = "localhost" or it = "127.0.0.1") of (preceding text of first (":" & (parameter "RemoteIEMPort" of action)) of (following text of first "http://" of ("http://" & (following text of first "://" of (tuple string item 9 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml"))))))))}
			wait { ((value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe")} -a c:\import\import.txt -P {(concatenation "/" of  (substrings separated by "\" of (preceding text of last "\" of (expand environment string of (image path of service "FILLDB")) & "\wwwrootbes\" & ( (preceding text of last "/" of following text of first (":" & (parameter "RemoteIEMPort" of action) & "/") of tuple string item 9 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) & "/%22")} {concatenation (parameter "RemoteIEM" of action) of (substrings separated by (preceding text of first (":" & (parameter "RemoteIEMPort" of action)) of (following text of first "//" of (tuple string item 9 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) of ("http://" & (following text of first "://" of (tuple string item 9 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))))}
		else 
			wait { ((value of variable "ProgramFiles" of environment) & "\GnuWin32\bin\wget.exe")} -a c:\import\import.txt -P {(concatenation "/" of (substrings separated by "\" of (preceding text of last "\" of (expand environment string of (image path of service "FILLDB")) & "\wwwrootbes\" & ( (preceding text of last "/" of following text of first (":" & (parameter "RemoteIEMPort" of action) & "/") of tuple string item 9 of (concatenation ", " of unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))) & "/%22")} {"http://" & (parameter "RemoteIEM" of action) & ":" & (parameter "RemoteIEMPort" of action) &  (following text of first ":52311" of (tuple string item 9 of (concatenation ", " of (unique values of lines whose ((it does not start with "//" and it does not start with "%09%09//") and it contains (":" & (parameter "RemoteIEMPort" of action)) and it as lowercase contains "uploads") of file ("C:\IMPORT\" & (parameter "RemoteFixletID" of action) & ".xml")))))}
		endif
	endif

endif]]></ActionScript>
		</Action>
		<Action ID="Action2">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> to review this task in the bigfix.me Content Database.</PostLink>
			</Description>
			<ActionScript MIMEType="text/x-uri">https://bigfix.me/cdb/fixlet/3757</ActionScript>
		</Action>
	</Fixlet>
</BES>
