<?xml version="1.0" encoding="UTF-8"?>
<BES xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="BES.xsd">
	<Task>
		<Title>Sample Task: Send an Email Notification</Title>
		<Description><![CDATA[
<TABLE><TBODY><TR><TD> <P>Use this Task to send a Baseline email notification using the Notification Service if the BigFix server is not directly reachable from the endpoint(s) on which the Baseline will run, for example, if there are relays between the endpoints and the server.</P> <P><STRONG>Prerequisites:</STRONG></P> <UL> <LI>The email notification service must be installed before running this Task. To install the email notification service use the <?relevance (link of fixlet 2238 of bes site whose( name of it contains "BES Support" ))?> Task to install on a Windows server or the <?relevance (link of fixlet 2241 of bes site whose( name of it contains "BES Support" ))?> Task to install on a Linux server. </LI> <LI>The SMTP notification settings must also be configured before running this Task.To configure the SMTP settings, run Task <?relevance (link of fixlet 2240 of bes site whose( name of it contains "BES Support" ))?> to configure SMTP Settings for the Notification Service.</LI> </UL> <BR> <STYLE> table, th, td { border: 2px solid black; border-collapse: collapse; padding: 10px; } .code { font-family:Courier New; } .blue { color: blue; } .nowrap { white-space: nowrap; } .valhead { font-weight: bold; color: green; } </STYLE> <P>The text in the action script of this Task is designed to be detected by the Notification Service. When you take action, the Notification Service detects and processes the details contained in the resulting action and uses them to send an email. Do not add this text to the action script of your own custom Fixlets or Tasks.</P> <P>To use this Task, copy the Task and modify the following details in the action script of the copy by entering your email notification details:</P> <P class="code">// NOTIFICATION_START<BR> // <I><B class="blue">&lt;key&gt;</B></I>: "<I><B class="blue">&lt;value&gt;</B></I>"<BR> &nbsp;&nbsp;&nbsp;...<BR> // NOTIFICATION_END</P> <P>where the possible inputs for <B class="blue">&lt;key&gt;</B></I> and <I><B class="blue">&lt;value&gt;</B></I> are described below:<BR> <BR> <TABLE> <TR> <TH>Key</TH> <TH>Description</TH> <TH>Required</TH> </TR> <TR> <TD class="code nowrap">to</TD> <TD>The email addresses to whom the notification shall be sent.<BR> <SPAN class="valhead">Valid Values:</SPAN> A comma (,) separated list of valid email addresses.</TD> <TD>Yes</TD> </TR> <TR> <TD class="code nowrap">from</TD> <TD>The email address that will appear as the sender of the notification email.<BR> <SPAN class="valhead">Valid Values:</SPAN> The email address does not have to actually exist, but the value specified must be in the format of a valid email address.</TD> <TD>Yes</TD> </TR> <TR> <TD class="code nowrap">subject</TD> <TD>The notification summary that will appear as the subject of the email.<BR> <SPAN class="valhead">Valid Values:</SPAN> Any text (this text may include tokens that are replaced at runtime - see below.)</TD> <TD>Yes</TD> </TR> <TR> <TD class="code nowrap">body</TD> <TD>The main notification text content for the email.<BR> <SPAN class="valhead">Valid Values:</SPAN> Any text (this text may include tokens that are replaced at runtime - see below.)</TD> <TD>Yes</TD> </TR> <TR> <TD class="code nowrap">failure-trigger</TD> <TD>This defines the number of failures that will cause the notification to be sent. When this key is specified, it means that the notification shall be sent when the specified number of failures occurs. When this key is omitted, it means that the notification shall be sent when it completes.<BR> <SPAN class="valhead">Valid Values:</SPAN> A whole number greater than zero.</TD> <TD>No</TD> </TR> <TR> <TD class="code nowrap">scope</TD> <TD>Determines which action will be examined for result statuses when determining if an action has failed or completed.<BR> When this key is omitted, the results of the action containing these notification comments shall be examined.<BR> <SPAN class="valhead">Valid Values:</SPAN><BR> <SPAN class="code">&quot;parent&quot;</SPAN>: means the results of the parent baseline will be examined instead of the action containing the notification comments.</TD> <TD>No</TD> </TR> </TABLE> <BR><BR> At a minimum, the notification comments MUST contain at least:<BR> <BR> <SPAN style="font-family:Courier New;"> // NOTIFICATION_START<BR> // to: "<I><B style="color=blue;">&lt; your comma separated list of recipient email addresses goes here &gt;</B></I>"<BR> // from: "<I><B style="color=blue;">&lt; your single email address that will be shown as the sender of the email goes here &gt;</B></I>"<BR> // subject: "<I><B style="color=blue;">&lt; your email title goes here &gt;</B></I>"<BR> // body: "<I><B style="color=blue;">&lt; your main email detail content goes here &gt;</B></I>"<BR> // NOTIFICATION_END</SPAN><BR> <BR><BR> <P><B>Special tokens for <SPAN class="code">subject</SPAN> and <SPAN class="code">body</SPAN> text values:</B><BR> <BR> The following tokens get replaced with real values from the running action at runtime.<BR> The token values correspond to the action whose results are examined, which can actually be the parent baseline action. <UL> <LI><SPAN class="code">{actionId}</SPAN> - The ID of the action whose results are examined for failure/successful completion.</LI> <LI><SPAN class="code">{actionName}</SPAN> - The name of the action whose results are examined for failure/successful completion.</LI> <LI><SPAN class="code">{serverIp}</SPAN> - The IPv4 address of the BES server.</LI> </UL> </P> <P><B>EXAMPLES:</B></P> <UL> <LI>When a Task consisting of the following notification comments is added as a component in a baseline, it will send an email when this Task (component) completes:<BR> (for example, this may be useful if added to the middle of a baseline)<BR> <BR> <SPAN style="font-family:Courier New;"> // NOTIFICATION_START<BR> // to: "me@me.com, you@you.com"<BR> // from: "noreply@bigfixteam.mycompany.com"<BR> // subject: "Your baseline component '{actionName}' has completed!"<BR> // body: "Your baseline is 50% complete now"<BR> // NOTIFICATION_END</SPAN><BR><BR></LI> <LI>When a Task consisting of the following notification comments is added as a component in a baseline, it will send an email when that overall baseline completes:<BR> <BR> <SPAN style="font-family:Courier New;"> // NOTIFICATION_START<BR> // to: "me@me.com, you@you.com"<BR> // from: "noreply@bigfixteam.mycompany.com"<BR> // subject: "Your baseline '{actionName}' with ID {actionId} has completed!"<BR> // body: "The entire baseline is complete and eveything went according to plan ..."<BR> // <B>scope: "parent"</B><BR> // NOTIFICATION_END</SPAN></LI> </UL> <P><B>NOTE:</B> The two examples above can only be added to baselines that are <I><B>statically</B></I> targeted.<BR> Baselines targeted by group, property or name list will not cause a notification to be sent.<BR> (The next example can be specified in baselines targeted <I>statically</I> OR <I>dynamically</I>)</P> <BR> <UL> <LI>When a Task consisting of the following notification comments is added as a component in a baseline, it will send an email if 5 or more targeted endpoints report a failure:<BR> <BR> <SPAN style="font-family:Courier New;"> // NOTIFICATION_START<BR> // to: "me@me.com, you@you.com"<BR> // from: "noreply@bigfixteam.mycompany.com"<BR> // subject: "Your baseline '{actionName}' with ID {actionId} has failed on 5 or more computers"<BR> // body: "Please review the results of baseline '{actionName}' (ID: {actionId})"<BR> // <B>failure-trigger: "5"</B><BR> // NOTIFICATION_END</SPAN></LI> </UL> <P>After you have modified the action script in the copied Task, save the copy and then add it to the Baseline for which you want to send email notifications.</P></TD></TR></TBODY></TABLE>
]]></Description>
		<Relevance>exists relay service OR exists main gather service</Relevance>
		<Relevance>exists main gather service</Relevance>
		<Relevance><![CDATA[version of main gather service >= "9"]]></Relevance>
		<Relevance>true</Relevance>
		<Category>Notification</Category>
		<Source>IBM</Source>
		<SourceID>201505201200</SourceID>
		<SourceReleaseDate>2015-06-30</SourceReleaseDate>
		<SourceSeverity></SourceSeverity>
		<CVENames></CVENames>
		<SANSID></SANSID>
		<MIMEField>
			<Name>x-fixlet-first-propagation</Name>
			<Value>Thu, 17 Dec 2015 21:33:00 +0000</Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-modification-time</Name>
			<Value>Sat, 11 Mar 2017 00:28:25 +0000</Value>
		</MIMEField>
		<Delay>PT1S</Delay>
		<DefaultAction ID="Action1">
			<Description>
				<PreLink>Click </PreLink>
				<Link>here</Link>
				<PostLink> to deploy this action.</PostLink>
			</Description>
			<ActionScript MIMEType="application/x-Fixlet-Windows-Shell">// NOTIFICATION_START
// to: "recipientOne@mycompany.com,recipientTwo@mycompany.com"
// from: "me@mycompany.com"
// subject: "Something happened that you should know about ..."
// body: "Here are the details of that ..."
// NOTIFICATION_END</ActionScript>
		</DefaultAction>
	</Task>
</BES>
