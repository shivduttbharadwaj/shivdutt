<?xml version="1.0" encoding="UTF-8"?>
<BES xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="BES.xsd">
	<Task>
		<Title>Parameterized Fixlet Library</Title>
		<Description><![CDATA[
<TABLE><TBODY><TR><TD>This fixlet is used as a mechanism to make the parameterized fixlet library available to other fixlets. It has no action associated with it and can't be targeted to any computer.  <br>			<DIV id=globalizationMessageDiv  style="display:none;"><br>				HEADER_VALIDATION = "Validation";<br>				HEADER_OVERRIDE = "Override";<br>				HEADER_TAKE_CONTROL = "Take control";<br>				HEADER_PARAM_NAME = "Parameter name";<br>				HEADER_PARAM_VALUE = "Parameter value";<br>				ENCRYPTION_WARN = "The value you enter will not be encrypted";<br>				CONFIG_PASSWORD_MGM_EXT = "You must configure the management extender with your Windows administrator password before you can work with this task. Click here";<br>				VALIDATION_TOOL_TIP_TEXT[0] = "Click here to turn off validation";<br>				VALIDATION_TOOL_TIP_TEXT[1] = "Click here to turn on validation.";<br>				VALIDATION_TOO_TIP_PARENT_DISABLED = "You can not enable validation unless validation is enabled for <FIELDNAME>";<br>				msg_notValidText = "<FIELDNAME> contains characters that cannot be used. Use only alpha numeric characters, (-) and (_) in your <FIELDNAME>. To complete the form, ensure your <FIELDNAME> contains no special characters";<br>				msg_notValidNumber = "<FIELDNAME> contains characters that cannot be used. Only an integer value is allowed";<br>				msg_notValidDecimal = "<FIELDNAME> contains characters that cannot be used. Only a decimal value is allowed";<br>				msg_valueRequired = "You must enter a <FIELDNAME> to proceed with submitting the form.";<br>				msg_relError = "Ensure that the fixlet does not contain any outstanding warning messages. All warning messages must be resolved before you can proceed. If you have activated the analysis, note that it can take several minutes to gather. To return to the fixlet, click OK.";<br>				msg_correctProblems = "You must correct the following problem(s) before you can continue with submitting the form.";<br>				noDataFound = "No data retrieved";<br>				msg_please_select = "---Please select---" ;<br>				msg_AnalysisNotFound = "Analysis not found";<br>				msg_warning = "Warning";<br>				msg_analysisNotActiveNotExists = "The following analysis is either not active or does not exist";<br>				msg_notPresent = "Not present";<br>				msg_notActive = "Not Active";<br>				msg_activate = "Activate";<br>				msg_mustActivateAnalysis = "You cannot complete the form without activating this analysis. Activate or create the analysis to complete the form. <br/> When you click Activate, it can take a few minutes for the form to update.";<br>				msg_selectBinaryFile = "Select a binary file";<br>				msg_binaryFileHelpMsg ="Select a binary file to populate the URL,SHA-1 and Size fields below automatically. This data is only available for files uploaded using the dashboard datastore";<br>				msg_errorExtractingDataFromDashBoard = "Error extracting file helper data from dashboard";<br>			</Div></TD></TR></TBODY></TABLE>
]]></Description>
		<Relevance>false</Relevance>
		<Relevance>false</Relevance>
		<Category>Library</Category>
		<Source>IBM</Source>
		<SourceID></SourceID>
		<SourceReleaseDate>2012-09-09</SourceReleaseDate>
		<SourceSeverity></SourceSeverity>
		<CVENames></CVENames>
		<SANSID></SANSID>
		<MIMEField>
			<Name>x-fixlet-first-propagation</Name>
			<Value>Tue, 01 Jul 2014 17:26:53 +0000</Value>
		</MIMEField>
		<MIMEField>
			<Name>vrt_utils.js</Name>
			<Value><![CDATA[var BASE_PATH=getBaseScriptPath();var vrtEval=window.eval;var setHTML=function(el,contents){if(el) el["inner"+"HTML"]=contents;return el;};var vrtSetInterval=window.setInterval;var vrtSetAttribute=function(el,attribute,value){if(el&&attribute) el["set"+"Attribute"](attribute,value);return el;};var PE_CURRENT_VERSION_VRT={major:-1,minor:-1};var vrt_getCurrentVersion=function(){if(PE_CURRENT_VERSION_VRT.major!==-1){return PE_CURRENT_VERSION_VRT;} var relevanceQuery='substrings separated by "." of (version of datastore inspectors as string)';var version=EvaluateRelevance(relevanceQuery);PE_CURRENT_VERSION_VRT.major=version[0];PE_CURRENT_VERSION_VRT.minor=version[1];return PE_CURRENT_VERSION_VRT;};var FixletUtils=FixletUtils||{};FixletUtils.TemHelper=FixletUtils.TemHelper||{};var gMetaDataObjects;var gAnalysisJson;var HEADER_VALIDATION="<?jxlat Validation?>";var HEADER_OVERRIDE="<?jxlat Override?>";var HEADER_TAKE_CONTROL="<?jxlat Take control?>";var HEADER_PARAM_NAME="<?jxlat Parameter name?>";var HEADER_PARAM_VALUE="<?jxlat Parameter value?>";var ENCRYPTION_WARN="<?jxlat The value you enter will not be encrypted?>";var CONFIG_PASSWORD_MGM_EXT="<?jxlat You must configure the management extender with your Windows administrator password before you can work with this task. Click here?>";var VALIDATION_TOOL_TIP_TEXT=new Array();VALIDATION_TOOL_TIP_TEXT[0]="<?jxlat Click here to turn off validation.?>";VALIDATION_TOOL_TIP_TEXT[1]="<?jxlat Click here to turn on validation.?>";VALIDATION_TOO_TIP_PARENT_DISABLED="<?jxlat You can not enable validation unless validation is enabled for <FIELDNAME>?>";var msg_notValidText="<?jxlat <FIELDNAME> parameter contains characters that cannot be used. Use only alpha numeric characters, (-) and (_) in your <FIELDNAME>. To complete the form, ensure your <FIELDNAME> contains no special characters?>";var msg_notValidNumber="<?jxlat <FIELDNAME> parameter contains characters that cannot be used. Only an integer value is allowed?>";var msg_notValidDecimal="<?jxlat <FIELDNAME> parameter contains characters that cannot be used. Only a decimal value is allowed?>";var msg_valueRequired="<?jxlat You must enter a value for <FIELDNAME> parameter to proceed with submitting the form.?>";var msg_relError="<?jxlat Ensure that the fixlet does not contain any outstanding warning messages. All warning messages must be resolved before you can proceed. If you have activated the analysis, note that it can take several minutes to gather. To return to the fixlet, click OK.?>";var msg_correctProblems="<?jxlat You must correct the following problem(s) before you can continue with submitting the form.?>";var noDataFound="<?jxlat No data retrieved?>";var msg_please_select="<?jxlat ---Please select---?>";var msg_AnalysisNotFound="<?jxlat Analysis not found?>";var msg_warning="<?jxlat Warning?>";var msg_analysisNotActiveNotExists="<?jxlat The following analysis is either not active or does not exist?>";var msg_notPresent="<?jxlat Not present?>";var msg_notActive="<?jxlat Not Active?>";var msg_activate="<?jxlat Activate?>";var msg_mustActivateAnalysis="<?jxlat You cannot complete the form without activating this analysis. Activate or create the analysis to complete the form. <br/> When you click Activate, it can take a few minutes for the form to update.?>";var msg_selectBinaryFile="<?jxlat Select a binary file?>";var msg_binaryFileHelpMsg="<?jxlat Select a binary file to populate the URL,SHA-1 amd Size fields below automatically. This data is only available for files uploaded using the dashboard datastore?>";var msg_errorExtractingDataFromDashBoard="<?jxlat Error extracting file helper data from dashboard?>";FixletUtils.getCurrentFixletKey=function(){};FixletUtils.initFixletRender=function(){};FixletUtils.validateParams=function(metaObject){};FixletUtils.getParamTableValues=function(metaObject){};FixletUtils.renderForm=function(fixletId,siteUrl){};FixletUtils.renderForm=function(mimeData,uniqueSuffix,divName,parameterTypeFailureStep){};FixletUtils.getActionScriptAsJson=function(fixletId,siteUrl){};FixletUtils.getCurrentVersion=function(){return vrt_getCurrentVersion();};FixletUtils.strf=function(str,o){if(typeof str==='undefined'){return"";} var p=/{([^{]*)}/ig;var tokens=str.match(p);var result=str;if(tokens!==null){for(var i=0;i<tokens.length;i++){var token=tokens[i];var prop=token.substring(1,token.length-1);result=result.replace(token,o[prop]);}} return result;};FixletUtils.formatError=function(){var strKey=arguments[0];var errorObj={};var argArray=[];for(var i=1;i<arguments.length;i++){argArray.push(arguments[i]);} errorObj["errorKey"]=strKey;errorObj["argArray"]=argArray;return errorObj;};FixletUtils.trimStr=function(text){if(text!=='undefined'||text!==null){text=text.replace(/^\s+|\s+$/g,"");} return text;};FixletUtils.startFixletRender=function(libFixletSiteName){if(typeof libFixletSiteName==="undefined"){libFixletSiteName="BES Support";} var relQuery="(messages of it) of bes fixlets whose (name of it = \"Parameterized Fixlet Library\" and ((name of it ) of site of it = \""+libFixletSiteName+"\" ))";var messages=EvaluateRelevance(relQuery);var regex=/\s*<DIV id=globalizationMessageDiv [^>]*([\x00-\x7F]+)\s*<\/Div>/i;var matches=regex.exec(messages);var str=matches[1].substring(1,matches[1].length);eval(str);FixletUtils.initFixletRender();};FixletUtils.uniqueForm=null;(function(){FixletUtils.getActionScriptAsJson=function(fixletId,siteUrl){var fixletActionScriptQuery=FixletUtils.strf('(id of it, name of it, (script of it) of actions of it) ' +'of bes fixlets whose (id of it = {0} and (url of site of it) = "{1}")',[fixletId,siteUrl]);var fixletActionScript=EvaluateRelevance(fixletActionScriptQuery);var actionParams=extractParams(fixletActionScript[0]);var actionParamArray=[];var jsonString="[ ";for(var ap=0;ap<actionParams.length;ap++){actionParamInMeta=false;if(ap>0){jsonString=jsonString+",";} var s='{' +FixletUtils.strf(' name:"{name}", default_value:"{default_value}", description:"{description}" ',actionParams[ap])+'}';jsonString+=s;} jsonString=jsonString+"]";return jsonString;};FixletUtils.getActionScriptAsJson=function(fixletId,siteUrl){var fixletActionScriptQuery=FixletUtils.strf('(id of it, name of it, (script of it) of actions of it) ' +'of bes fixlets whose (id of it = {0} and (url of site of it) = "{1}")',[fixletId,siteUrl]);var fixletActionScript=EvaluateRelevance(fixletActionScriptQuery);var actionParams=extractParams(fixletActionScript[0]);var actionParamArray=[];var jsonString="[ ";for(var ap=0;ap<actionParams.length;ap++){actionParamInMeta=false;if(ap>0){jsonString=jsonString+",";} var s='{' +FixletUtils.strf(' name:"{name}", default_value:"{default_value}", description:"{description}" ',actionParams[ap])+'}';jsonString+=s;} jsonString=jsonString+"]";return jsonString;};FixletUtils.validateParams=function(metaObject){if(typeof metaObject.uniqueForm!="undefined"){FixletUtils.uniqueForm=metaObject.uniqueForm;} validator=new Validator();var errorDO=[];var errorFound=false;var relevanceError=false;var isAnalysisActive=false;var fixletAnalysis=getAnalysisListOf(gMetaDataObjects.analysisJson);isAnalysisActive=hasActiveAnalysis(fixletAnalysis);if(isAnalysisActive){renderAnalysisInfo(fixletAnalysis,null,metaObject.idSuffix);isAnalysisActive=true;} var allParamsArray=FixletUtils.getParamTableValues(metaObject,false);var fieldErrorFound=false;for(var p=0;p<allParamsArray.length&&!isAnalysisActive;p++){if(allParamsArray[p].visible==false){continue;} var paramDefault=allParamsArray[p].defaultValue;var paramValue=allParamsArray[p].value==undefined?"":allParamsArray[p].value;var paramTitle=allParamsArray[p].title;if(paramTitle){paramTitle=paramTitle.replace(/:|:/i,"");} if(allParamsArray[p].visible==true&&allParamsArray[p].required&&((!paramValue.match(/\S/))||paramValue=="NoRelevanceResult")){errorFound=true;fieldErrorFound=true;errorDOInfo={name:allParamsArray[p].title,errorStr:msg_valueRequired.replace(/<FIELDNAME>/gi,paramTitle),id:allParamsArray[p].name};errorDO.push(errorDOInfo);} else if(allParamsArray[p].dataType!=null&&paramValue.match(/\S/)){var isValid=true;var validationErrorStr="";if(allParamsArray[p].dataType.toLowerCase()=="text"){isValid=isText(paramValue);validationErrorStr=msg_notValidText.replace(/<FIELDNAME>/gi,paramTitle);} else if(allParamsArray[p].dataType.toLowerCase()=="number"){isValid=isNumber(paramValue);validationErrorStr=msg_notValidNumber.replace(/<FIELDNAME>/gi,paramTitle);} else if(allParamsArray[p].dataType.toLowerCase()=="decimal"){isValid=isDecimal(paramValue);validationErrorStr=msg_notValidDecimal.replace(/<FIELDNAME>/gi,paramTitle);} if(isValid==false){errorFound=true;fieldErrorFound=true;errorDOInfo={name:allParamsArray[p].title,errorStr:validationErrorStr,id:allParamsArray[p].name};errorDO.push(errorDOInfo);}} if(paramValue.match("NoRelevanceResult")&&allParamsArray[p].visible==true){relevanceError=true;}} for(var p=0;p<allParamsArray.length&&!isAnalysisActive&&fieldErrorFound==false;p++){if(allParamsArray[p].customValidator){var validationDO={};validationDO["currentValue"]=validationDO["currentValue"]=allParamsArray[p].value==undefined?"":allParamsArray[p].value;validationDO["initialValue"]=allParamsArray[p].initialValue["value"];var validationError=eval(allParamsArray[p].customValidatorFunc)(validationDO,metaObject);if(validationError!=null){validationError=getLocalizedCustomError(validationError,metaObject);errorDOInfo={name:allParamsArray[p].title,errorStr:validationError,id:allParamsArray[p].name};errorFound=true;errorDO.push(errorDOInfo);}}} renderErrors(errorDO,metaObject,allParamsArray);if(errorFound==true){return false;} if(relevanceError==true||isAnalysisActive){alert(msg_relError);return false;} var result={};for(q=0;q<allParamsArray.length;q++){if(!allParamsArray[q].formOnly){var paramName=allParamsArray[q].name;var index=paramName.indexOf(metaObject.idSuffix);if(index!=-1){paramName=paramName.substr(0,index);} result[paramName]=allParamsArray[q].value;}} return result;};FixletUtils.getParamTableValues=function(metaObject,defaultSettings){var allParamsArray=metaObject.metaDataInfos;var paramValue;for(p=0;p<allParamsArray.length;p++){var paramField=document.getElementById(allParamsArray[p].name);if(paramField.type=="select-one"){if(paramField.selectedIndex!==-1){paramValue=paramField.options[paramField.selectedIndex].value;}else{paramValue="";}}else{paramValue=paramField.value;} allParamsArray[p].value=paramValue;if(!defaultSettings){if(allParamsArray[p].customEvents["onFormSubmit"]){var returnedValue=eval(allParamsArray[p].customEvents["onFormSubmit"]) (allParamsArray[p].value,metaObject);if(allParamsArray[p].required!==true&&allParamsArray[p].value!=="NoRelevanceResult"){allParamsArray[p].value=returnedValue;}}}else{var suffixIndex=allParamsArray[p].name.indexOf(metaObject.idSuffix);var lastIndex=allParamsArray[p].name.lastIndexOf();allParamsArray[p].name=allParamsArray[p].name.substring(suffixIndex,lastIndex);}} return allParamsArray;};FixletUtils.getCurrentFixletKey=function(){var result=null;try{var query='(id of it, url of site of it) of current fixlet';result=EvaluateRelevance(query);}catch(error){} return result;};FixletUtils.initFixletRender=function(){var fixletKeys=FixletUtils.getCurrentFixletKey();if(fixletKeys!=null){var fixletKeyArray=fixletKeys.split(', ');_renderForm(fixletKeyArray[0],fixletKeyArray[1]);}};var _renderForm=function(fixletId,siteUrl){var mimeDataTagsObj={};var mimeDataTags=["ParameterMetadataTag","ParameterValidatorTag","ParameterCustomEventsTag","Analysis-Dependencies","ParameterMessagesTag","ParameterFixletInfoTag"];for(var i=0;i<mimeDataTags.length;i++){mimeDataTagsObj[mimeDataTags[i]]=FixletUtils.TemHelper.readMimeField(mimeDataTags[i],fixletId,siteUrl);} mimeDataTagsObj["FixletActionParams"]=FixletUtils.getActionScriptAsJson(fixletId,siteUrl);FixletUtils.renderForm(mimeDataTagsObj,"vrt","fixletMessage2");};FixletUtils.renderForm=function(mimeDataTagsObj,uniqueSuffix,divName,parameterTypeFailureStep,stepFixlet,defaultSettings){_loadExternalJs(mimeDataTagsObj);_loadContentsJs("vrt_contents.js");var overrideMentioned=false;var metadataObjects=new MetaDataObjects();gMetaDataObjects=metadataObjects;if(parameterTypeFailureStep==undefined){parameterTypeFailureStep=false;} if(uniqueSuffix!=undefined||uniqueSuffix!=null){metadataObjects.idSuffix="vrt_"+uniqueSuffix;uniqueSuffix=metadataObjects.idSuffix;} var guiRenderer=new GuiRenderer(parameterTypeFailureStep,metadataObjects);if(divName!=undefined){if(typeof divName=="string"){guiRenderer.anchorDiv=document.getElementById(divName);}else{guiRenderer.anchorDiv=divName;}} metadataObjects.uniqueContainerId=FixletUtils.uniqueForm+metadataObjects.idSuffix;var divContainer=new DivsElementsContainer();divContainer=guiRenderer.createDivs(divContainer,uniqueSuffix);guiRenderer.createParamForm();guiRenderer.createStyleSheet();MetaDataObjects.prototype.analysisJson=mimeDataTagsObj["Analysis-Dependencies"];renderAnalysisInfo(getAnalysisListOf(metadataObjects.analysisJson),divContainer,uniqueSuffix);metadataObjects.fromJsonToMetaDataObj(mimeDataTagsObj,stepFixlet);if(metadataObjects.uiContainers.length>0){for(conatinerIndex in metadataObjects.uiContainers){var containerElement=metadataObjects.uiContainers[conatinerIndex];if(containerElement.getType()=="accordion"){var accordion=newAccordion(guiRenderer,containerElement);containerElement.container=accordion;}}} else{var page=newPage(metadataObjects.uniqueContainerId);page.getPage().className="section";guiRenderer.fixletForm.appendChild(page.getPage());} for(var parent=0;parent<metadataObjects.metaDataInfos.length;parent++){var theParent=metadataObjects.metaDataInfos[parent];if(theParent.override==true){overrideMentioned=true;} for(var childs=0;childs<metadataObjects.metaDataInfos.length;childs++){var theChild=metadataObjects.metaDataInfos[childs];if((typeof metadataObjects.metaDataInfos[childs].parent)!=undefined&&metadataObjects.metaDataInfos[childs].parent===theParent.name){if(theParent.override==true){theChild.override=guiRenderer.isOverrideable(theChild);} metadataObjects.metaDataInfos[parent].dependents.push(theChild.name);}} if(theParent.binaryHelper!=null&&stepFixlet&&stepFixlet.parameters){theParent.binaryHelper.rawDefaultSettings=stepFixlet.parameters;} var generatedElem=guiRenderer.renderGUI(theParent);if(metadataObjects.metaDataInfos[parent].dependents.length>0){generatedElem.attachEvent('onchange',makeHandler(theParent.name,metadataObjects.metaDataInfos[parent].dependents,guiRenderer));} _attachCustomEvents(generatedElem,theParent,metadataObjects);} var deleteOverride=function(){if(document.getElementById(metadataObjects.uniqueContainerId)){if(defaultSettings==="ds"){delColDefaultSettings(metadataObjects,guiRenderer.paramTable.id);}else{deleteColumn(guiRenderer.paramTable.id);}} for(cIndex in metadataObjects.uiContainers){if(defaultSettings==="ds"){delColDefaultSettings(metadataObjects,"tbl_"+metadataObjects.uiContainers[cIndex].getName());}else{deleteColumn("tbl_"+metadataObjects.uiContainers[cIndex].getName());} childPages=metadataObjects.uiContainers[cIndex].getChildren();for(childPage in childPages){if(defaultSettings==="ds"){delColDefaultSettings("tbl_"+childPages[childPage].getName());}else{deleteColumn("tbl_"+childPages[childPage].getName());}}}};if(overrideMentioned==false||defaultSettings==="ds"){deleteOverride();} if(defaultSettings==="ta"){addDefaultIcon(metadataObjects);} metadataObjects.uniqueForm=FixletUtils.uniqueForm;if(gMetaDataObjects.onFixletRender!==undefined){gMetaDataObjects.onFixletRender();} return metadataObjects;};var _loadContentsJs=function(fileName){var head=document.getElementsByTagName("head")[0];var script=document.createElement('script');script.type='text/javascript';script.src=fileName;head.appendChild(script);};var _loadExternalJs=function(mimeDataTagsObj){if(typeof mimeDataTagsObj["ParameterFixletInfoTag"]!=='undefined'){if(typeof mimeDataTagsObj["ParameterFixletInfoTag"]=="string"){fixletInfo=vrtEval('(' +mimeDataTagsObj["ParameterFixletInfoTag"]+')');}else{fixletInfo=mimeDataTagsObj["ParameterFixletInfoTag"];} var fixletInfoObj=fixletInfo["FixletInfo"];fileName=fixletInfoObj["messageFileName"];var head=document.getElementsByTagName("head")[0];var script=document.createElement('script');script.type='text/javascript';script.src=fileName;head.appendChild(script);var externalJs=fixletInfoObj["importFiles"];if(externalJs){for(var ind=0;ind<externalJs.length;ind++){var extJsScript=document.createElement('script');extJsScript.type='text/javascript';extJsScript.src=externalJs[ind];head.appendChild(extJsScript);}}}};}());FixletUtils.TemHelper.readMimeField=function(fieldName,fixletId,siteUrl){};(function(){var _readMimeField=function(fieldName,fixletId,siteUrl){var relQuery=FixletUtils.strf('(mime field "{0}" of it) ' +'of bes fixlets whose (exists mime field "{0}" of it ' +'and id of it ={1} ' +'and (url of it ) of site of it = "{2}")',[fieldName,fixletId,siteUrl]);relQueryResult=(EvaluateRelevance(relQuery)[0]);return relQueryResult;};FixletUtils.TemHelper.readMimeField=function(fieldName,fixletId,siteUrl){return _readMimeField(fieldName,fixletId,siteUrl);};})();function GuiRenderer(parameterTypeFailureStep,metaDataObjects){this.metaDataObjects=metaDataObjects;this.formBorder=0;this.formBorderColor="blue";if(parameterTypeFailureStep==true){FixletUtils.uniqueForm="paramTableFailureSteps";}else{FixletUtils.uniqueForm="paramTable";} this.containerUniqueSuffix=FixletUtils.uniqueForm+metaDataObjects.idSuffix;this.fixletForm=document.createElement("form");this.paramTable=document.createElement("table");this.anchorDiv=document.createElement("div");this.anchorDiv.id="fixletMessage";this.createParamForm=createParamForm;this.createStyleSheet=createStyleSheet;this.createDivs=createDivs;this.renderGUI=renderGUI;this.resolveRelevanceFor=resolveRelevanceFor;this.refreshDependents=refreshDependents;this.createOverriddenObj=createOverriddenObj;this.createControl=createControl;this.swapControl=swapControl;this.isOverrideable=isOverrideable;this.createRow=createRow;this.populateSelectList=populateSelectList;this.populateTextBox=populateTextBox;this.populateMultiLineText=populateMultiLineText;this.createSection=createSection;this.addSelectList=addSelectList;this.addTextBox=addTextBox;this.addMultiLineText=addMultiLineText;this.addTextArea=addTextArea;this.addBinaryControl=addBinaryControl;this.createOverrideControl=createOverrideControl;} function MetaDataInfo(){this.name=null;this.title=null;this.description=null;this.uiType=null;this.valueType=null;this.values=null;this.defaultValue=null;this.parent=null;this.dataType=null;this.binaryHelper=null;this.keys=null;this.subUIType=null;this.override=false;this.disabled=false;this.formOnly=false;this.required=false;this.visible=true;this.encrypt=false;this.sort=false;this.customValidator="";this.customValidatorFunc="";this.customEvents={};this.dependents=[];this.initialValue={};this.useDefaultOnRender=false;this.defaultSetting=null;this.defaultDisabled=false;} function MetaDataObjects(){this.uiContainers=[];this.metaDataInfos=[];this.idSuffix="";this.fixletMessages;this.fixletInfo;this.overriddenObjects={};this.encryptables={};this.fromJsonToMetaDataObj=fromJsonToMetaDataObj;this.addObject=addObject;this.replaceObject=replaceObject;this._extractMetaData=_extractMetaData;this.addUIContainer=addUIContainer;this.getUIContainer=getUIContainer;} addObject=function(_metadataInfo){if(_metadataInfo&&_metadataInfo instanceof MetaDataInfo){if(typeof this.overriddenObjects[_metadataInfo.name]==='undefined'){var o=createOverriddenObj(_metadataInfo);this.overriddenObjects[o.name]=o;}}};replaceObject=function(_ObjectName){if(typeof this.overriddenObjects[_ObjectName]!=='undefined'){for(var i=0;i<this.metaDataInfos.length;++i){if(this.metaDataInfos[i].name===_ObjectName){break;}} var o=this.overriddenObjects[_ObjectName];this.overriddenObjects[_ObjectName]=this.metaDataInfos[i];if(o.disabled!=this.metaDataInfos[i].disabled){o.disabled=this.metaDataInfos[i].disabled;} this.metaDataInfos[i]=o;var elem=document.getElementById(_ObjectName);if(elem.type=='select-one'){o.controlBuffer={};for(var i=0;i<elem.options.length;++i){o.controlBuffer[elem.options[i].text]=elem.options[i].value;}} return o;} return null;};FixletUtils._objectToCss=function(o){var result="{";for(var name in o){var value=o[name];if(value instanceof Array){for(var i=0;i<value.length;i++){result+=name+":"+value[i]+"; ";}}else{result+=name+":"+value+"; ";}} result+="}\n";return result;};function createStyleSheet(){var vrtStyleId="vrt_fixletUtils_stylesheet";var style=document.getElementById(vrtStyleId);if(style){return;} var style=document.createElement('style');var head=document.getElementsByTagName('head');head[0].appendChild(style);style.type='text/css';style.media='screen';style.id=vrtStyleId;var cssClass={"width":"100%","text-align":"center","background-color":"red","border":"1px solid grey","filter":["progid:DXImageTransform.Microsoft.gradient(startColorstr='#FFCC33', endColorstr='#FFFFFF') filter:alpha(opacity=90)"],"opacity":0.9};var fixletMessage={"padding-bottom":"8px","font-size":"11px"};var toolTipCSS={"border":"1px solid black"};var overrideOn={"background":"#ccccff","cursor":"pointer","color":"black","filter":["progid:DXImageTransform.Microsoft.gradient(startColorstr='white', endColorstr='#AF97F7',GradientType=0) filter:alpha(opacity=90)"],"padding":"2px 4px","font-weight":"bold","vertical-align":"middle","height":"20px","line-height":"20px","width":"32px"};var overrideOff={"background":"#999966","cursor":"pointer","filter":["progid:DXImageTransform.Microsoft.gradient(startColorstr='white', endColorstr='#999966',GradientType=0) filter:alpha(opacity=90)"],"color":"#999966","padding":"2px 4px","vertical-align":"middle","border":"1px solid #999966","height":"20px","line-height":"20px","width":"32px"};var overrideCheckbox={"width":"19px","height":"25px","padding":"0 5px 0 0"};var tableHeader={"background-color":"#f6f9ff","filter":["progid:DXImageTransform.Microsoft.gradient(startColorstr='#f6f9ff', endColorstr='#BBDFF8') filter:alpha(opacity=90)"],"color":"#2B638C","font":"bold 13px / 14px Helvetica, Geneva, Arial, SunSans-Regular, sans-serif","overflow":"hidden"};var formSection={"background-color":"#ffffff","border":"solid 1px #4297d7"};var hidden={"position":"absolute !important","left":"-9999px !important"};var vrtsectionHeader={"margin":"0","padding":"5px 6px 7px","position":"center","color":"#2B638C","font":"bold 13px / 14px Helvetica, Geneva, Arial, SunSans-Regular, sans-serif","background-image":"url(sectionHeader.png)","background-repeat":"repeat-x","background-position":"0 0","display":"block"};var vrtSubsection={"padding":"0px 0px","background-color":"#f6f9ff"};var section={"background-color":"#ffffff","margin-left":"24px","border":"solid 1px #4297d7"};var wizardCenter={"background-color":"yellow","border":"solid 1px #4297d7","float":"left","width":"20%","height":"100%"};var floatRight={"float":"right"};var floatLeft={"float":"left"};var noborder={"border":"0"};if(style.styleSheet){style.styleSheet.cssText=".cssClass " +FixletUtils._objectToCss(cssClass);style.styleSheet.cssText+=".FixletMessage td " +FixletUtils._objectToCss(fixletMessage);style.styleSheet.cssText+=".toolTipCSS " +FixletUtils._objectToCss(toolTipCSS);style.styleSheet.cssText+=".overridcheckbox" +FixletUtils._objectToCss(overrideCheckbox);style.styleSheet.cssText+=".tableHeader" +FixletUtils._objectToCss(tableHeader);style.styleSheet.cssText+=".formSection" +FixletUtils._objectToCss(formSection);style.styleSheet.cssText+=".overrideOn" +FixletUtils._objectToCss(overrideOn);style.styleSheet.cssText+=".overrideOff" +FixletUtils._objectToCss(overrideOff);style.styleSheet.cssText+=".hidden" +FixletUtils._objectToCss(hidden);style.styleSheet.cssText+=".vrtsectionHeader" +FixletUtils._objectToCss(vrtsectionHeader);style.styleSheet.cssText+=".vrtSubsection" +FixletUtils._objectToCss(vrtSubsection);style.styleSheet.cssText+=".section" +FixletUtils._objectToCss(section);style.styleSheet.cssText+=".noborder" +FixletUtils._objectToCss(noborder);style.styleSheet.cssText+=".wizardCenter" +FixletUtils._objectToCss(wizardCenter);style.styleSheet.cssText+=".flr" +FixletUtils._objectToCss(floatRight);style.styleSheet.cssText+=".fl" +FixletUtils._objectToCss(floatLeft);}else{}} function addUniqueSuffixToId(base_id,uniqueSuffix){var id=FixletUtils.uniqueForm+base_id+"-"+uniqueSuffix;return id;} function getAnalysisInfoDivId(uniqueSuffix){return addUniqueSuffixToId("analysis-info-div",uniqueSuffix);} function getEmptyDivId(uniqueSuffix){return addUniqueSuffixToId("empty-div",uniqueSuffix);} function getErrorDivId(uniqueSuffix){return addUniqueSuffixToId("error-div",uniqueSuffix);} function createSection(uniqueSuffix){var divSection=document.createElement('div');divSection.id=uniqueSuffix;return divSection;} function createDivs(divContainer,uniqueSuffix){elem=this.anchorDiv;var div=document.createElement('div');var emptyDiv=document.createElement('div');errorDiv=document.createElement('div');elem.insertBefore(errorDiv,elem.firstChild);elem.insertBefore(emptyDiv,elem.firstChild);elem.insertBefore(div,elem.firstChild);div.id=getAnalysisInfoDivId(uniqueSuffix);div.innerText="";div.className="cssClass";div.style.display="none";emptyDiv.id=getEmptyDivId(uniqueSuffix);emptyDiv.className="subsection";vrtSetAttribute(emptyDiv,"align","center");emptyDiv.style.display="none";errorDiv.id=getErrorDivId(uniqueSuffix);vrtSetAttribute(errorDiv,"align","center");errorDiv.className="cssClass";errorDiv.style.display="none";divContainer.divs.push(div);divContainer.divs.push(emptyDiv);divContainer.divs.push(errorDiv);return divContainer;} function createParamForm(){this.fixletForm.id="fixletForm"+gMetaDataObjects.idSuffix;this.fixletForm.name="fixletForm"+gMetaDataObjects.idSuffix;var mainSectionId="appMainPage"+this.containerUniqueSuffix;this.paramTable.id="tbl_"+this.containerUniqueSuffix;tableBody=this.paramTable.appendChild(document.createElement('tbody'));this.anchorDiv.appendChild(this.fixletForm);} resolveRelevanceFor=function(control){var relQuery="";if(control.valueType==="hybrid"){relQuery=control.values["relevance"];}else{relQuery=control.values;} if(control.parent){var parent=control.parent;var parentField=document.getElementById(parent);var parentValue="";if(parentField.type=="select-one"){parentValue=parentField.options[parentField.selectedIndex].value;}else{parentValue=parentField.hiddenValue;} if(parentValue==="norelevanceresult"||parentValue===""){parentValue="99999-99999-99999-999999";} relQuery=relQuery.replace(/<PARENT>/i,parentValue);} try{var patt1=/\$([0-9a-zA-Z_\-]*)/ig;var tokens=relQuery.match(patt1);if(tokens!=undefined&&tokens!=null){for(var len=0;len<tokens.length;len++){var elemId=tokens[len].substring(1);var element=document.getElementById(elemId +this.metaDataObjects.idSuffix);if(element.type=="select-one"){var paramValue=element.options[element.selectedIndex].value;}else{paramValue=element.hiddenValue;} if(paramValue.toLowerCase()==="norelevanceresult"||paramValue.toLowerCase()===""){paramValue="99999-99999-99999-999999";} relQuery=relQuery.replace(tokens[len],paramValue);}} var relQueryResult=EvaluateRelevance(relQuery);if(control.customEvents["onRelevanceResult"]&&typeof control.valueType!='undefined'){var eventObject={};if(control.parent){eventObject["parentValue"]=parentValue;} eventObject["relevanceResult"]=relQueryResult;relQueryResult=eval(control.customEvents["onRelevanceResult"])(eventObject,this.metaDataObjects);}}catch(e){relQueryResult=[];if(control.customEvents["onRelevanceResult"]&&typeof control.valueType!='undefined'&&parentValue&&parentValue!=''){var eventObject={};if(control.parent){eventObject["parentValue"]=parentValue;} eventObject["relevanceResult"]=relQueryResult;relQueryResult=eval(control.customEvents["onRelevanceResult"])(eventObject,this.metaDataObjects);}} return relQueryResult;};var addUIContainer=function(parent,jsonMetadata){var found=false;var _name=jsonMetadata.Name+this.uniqueContainerId;var _uiType=jsonMetadata.UIType;var _title=jsonMetadata.Title||"";var _description=jsonMetadata.Description||"";var newContainer=uiContainer(parent,_name,_uiType,_title,_description);for(var index in this.uiContainers){var name=this.uiContainers[index].getName();if(name===parent){this.uiContainers[index].addChild(newContainer);found=true;}} if(!found){this.uiContainers.push(newContainer);}};var getUIContainer=function(uiContainerName){found=uiContainerName;for(var index in this.uiContainers){if(this.uiContainers[index].getName()===uiContainerName){return this.uiContainers[index];}}};isOverrideable=function(control){var result=(!(control.override==false)&&!(control.uiType==="select"&&(control.valueType=="specified"||control.valueType=="hybrid")));return result;};buildBufferFromRelevanceResult=function(relResultArray){var obj={};if(relResultArray&&relResultArray!=undefined){for(var i=0;i<relResultArray.length;++i){var relQueryResultArr=String(relResultArray[i]).split(',');var resultKey=relQueryResultArr[0];var resultValue=relQueryResultArr[1]!==undefined?relQueryResultArr[1]:relQueryResultArr[0];obj[resultKey]=resultValue;}}else{obj=undefined;} return obj;};function addTextBox(control){var elementType='text';var elementSize=30;var input=document.createElement('input');if(control.subUIType){elementType=control.subUIType;} input.type=elementType;this.populateTextBox(input,control);input.name=control.name;input.id=control.name;if(control.useDefaultOnRender){input.readOnly=control.defaultDisabled;if(control.defaultDisabled||control.formOnly){input.style.backgroundColor="#D8D8D8";} if(control.defaultDisabled&&control.formOnly){input.style.backgroundColor="#F0F5F5";input.style.border="none";}}else{input.readOnly=control.disabled;if(control.disabled||control.formOnly){input.style.backgroundColor="#D8D8D8";} if(control.disabled&&control.formOnly){input.style.backgroundColor="#F0F5F5";input.style.border="none";}} return input;};function addTextArea(_metadataInfo){var input=document.createElement('textarea');input.name=_metadataInfo.name;input.id=_metadataInfo.name;input.readOnly=_metadataInfo.disabled;input.maxLength="5000";input.cols="30";input.rows="5";this.populateTextBox(input,_metadataInfo);if(_metadataInfo.disabled||_metadataInfo.formOnly){input.style.backgroundColor="#D8D8D8";} if(_metadataInfo.disabled&&_metadataInfo.formOnly){input.style.backgroundColor="#F0F5F5";input.style.border="none";} return input;};function addMultiLineText(_metadataInfo){var select=addSelectList(_metadataInfo);select.multiple=true;select.disabled=false;select.className="noborder";this.populateMultiLineText(select,_metadataInfo);return select;};function addSelectList(control){control.valueType=="hybrid"?noDataFound=msg_please_select:noDataFound=noDataFound;var select=document.createElement('select');select.name=control.name;select.id=control.name;this.populateSelectList(select,control);if(control.defaultValue){select.value=control.defaultValue;} if(control.useDefaultOnRender){select.readOnly=control.defaultDisabled;select.disabled=control.defaultDisabled;var bgColor=select.disabled==true?"#D8D8D8":"WHITE";select.style.backgroundColor=bgColor;}else{select.readOnly=control.disabled;select.disabled=control.disabled;var bgColor=select.disabled==true?"#D8D8D8":"WHITE";select.style.backgroundColor=bgColor;} return select;} function populateTextBox(textElement,metadataInfo){var elementSize=30;if(metadataInfo.defaultValue){textElement.hiddenValue=textElement.value=metadataInfo.defaultValue;metadataInfo.initialValue["value"]=metadataInfo.defaultValue;} if(metadataInfo.useDefaultOnRender){textElement.hiddenValue=textElement.value=metadataInfo.defaultSetting;} if(metadataInfo.valueType=="relevance"||metadataInfo.valueType=="hybrid"){var relQueryResult=this.resolveRelevanceFor(metadataInfo);if(relQueryResult&&relQueryResult.length>0){var relQueryResultArr=String(relQueryResult[0]).split(',');textElement.value=relQueryResultArr[0];metadataInfo.initialValue["value"]=relQueryResultArr[0];textElement.hiddenValue=relQueryResultArr[1]!==undefined?relQueryResultArr[1]:relQueryResultArr[0];metadataInfo.controlBuffer=buildBufferFromRelevanceResult(relQueryResult);}else{textElement.hiddenValue=undefined;textElement.value="";if(metadataInfo.defaultValue){textElement.hiddenValue=textElement.value=metadataInfo.defaultValue;metadataInfo.initialValue["value"]=metadataInfo.defaultValue;}}} if(textElement.value.length>textElement.size){textElement.size=textElement.value.length+10;}} function populateMultiLineText(selectElement,metadataInfo){var slctElemIndex=0;var noDataFound="";var optionsArray=new Array();selectElement.options.length=0;if(metadataInfo.valueType=="relevance"||metadataInfo.valueType=="hybrid"){var relQueryResult=this.resolveRelevanceFor(metadataInfo);if(relQueryResult!=""&&relQueryResult.length>0){var keyIndex=0;for(slctElemIndex=0;slctElemIndex<relQueryResult.length;slctElemIndex++){var relQueryResultArr=String(relQueryResult[slctElemIndex]).split(',');var resultKey=relQueryResultArr[0];var resultValue=relQueryResultArr[1]!==undefined?relQueryResultArr[1]:relQueryResultArr[0];optionsArray[slctElemIndex]=new Array();var valuesArray=resultValue.split(";");var keysArray=resultKey.split(";");for(var keysArrayCount=0,keysArrayLen=keysArray.length;keysArrayCount<keysArrayLen;++keysArrayCount){optionsArray[keyIndex]=new Array();optionsArray[keyIndex][0]=keysArray[keysArrayCount];optionsArray[keyIndex][1]=valuesArray[keysArrayCount];keyIndex+=1;}}}} for(var elemCount=0;elemCount<optionsArray.length;++elemCount){selectElement.options[elemCount]=new Option(optionsArray[elemCount][0],optionsArray[elemCount][1]);} if(selectElement.options.length>0){selectElement.style.width="auto";selectElement.style.height="auto";}else{selectElement.style.width="0";selectElement.style.height="0";}};function populateSelectList(selectElement,metadataInfo){var slctElemIndex=0;var optionsArray=new Array();if(metadataInfo.valueType=="relevance"||metadataInfo.valueType=="hybrid"){var relQueryResult=this.resolveRelevanceFor(metadataInfo);if(relQueryResult!=""&&relQueryResult.length>0){for(slctElemIndex=0;slctElemIndex<relQueryResult.length;slctElemIndex++){var relQueryResultArr=String(relQueryResult[slctElemIndex]).split(',');var resultKey=relQueryResultArr[0];var resultValue=relQueryResultArr[1]!==undefined?relQueryResultArr[1]:relQueryResultArr[0];optionsArray[slctElemIndex]=new Array();optionsArray[slctElemIndex][0]=getLocalizedContentString(resultKey);optionsArray[slctElemIndex][1]=resultValue;metadataInfo.initialValue["key"]=resultKey;metadataInfo.initialValue["value"]=resultValue;}}else{optionsArray[slctElemIndex]=new Array();optionsArray[slctElemIndex][0]=noDataFound;optionsArray[slctElemIndex][1]="NoRelevanceResult";slctElemIndex++;}} if(metadataInfo.valueType=="specified"||metadataInfo.valueType=="hybrid"){var specifiedValues=[];var resultKey;var specifiedObj={};if(metadataInfo.valueType=="hybrid"){specifiedValues=metadataInfo.values["specified"];}else{specifiedValues=metadataInfo.values;} for(y in specifiedValues){var parentKey=null;var parentValue=null;if(specifiedValues[y]instanceof Object){resultKey=getLocalizedContentString(specifiedValues[y].key);if(metadataInfo.parent){var parentElement=document.getElementById(metadataInfo.parent);if(parentElement&&parentElement.selectedIndex>=0){parentKey=parentElement.options[parentElement.selectedIndex].text;} parentValue=parentElement.value;} if(specifiedValues[y].parentValue&&specifiedValues[y].parentValue!==parentValue){continue;} if(specifiedValues[y].parentKey&&getLocalizedContentString(specifiedValues[y].parentKey)!==parentKey){continue;} if(!(specifiedValues[y].key in specifiedObj)){optionsArray[slctElemIndex]=new Array();optionsArray[slctElemIndex][0]=resultKey;optionsArray[slctElemIndex][1]=specifiedValues[y].value;specifiedObj[specifiedValues[y].key]=specifiedValues[y].value;}}else{if(!(specifiedValues[y]in specifiedObj)){optionsArray[slctElemIndex]=new Array();optionsArray[slctElemIndex][0]=getLocalizedContentString(specifiedValues[y]);optionsArray[slctElemIndex][1]=specifiedValues[y];specifiedObj[resultKey]=specifiedValues[y];}else{--slctElemIndex;}} slctElemIndex++;}} if(optionsArray.length>0){if(optionsArray[0][0]==noDataFound&&optionsArray.length>1){optionsArray.splice(0,1);}else{var selectedValue=optionsArray[0][1];}} if(metadataInfo.sort==true){optionsArray.sort();} for(var elemCount=0;elemCount<optionsArray.length;++elemCount){selectElement.options[elemCount]=new Option(optionsArray[elemCount][0],optionsArray[elemCount][1]);} if(metadataInfo.useDefaultOnRender){selectElement.value=metadataInfo.defaultSetting;}else{selectElement.value=selectedValue;}} var createOverrideControl=function(control){var that=this;var wrapperDiv=document.createElement('div');var overrideLabel=document.createElement('label');var textOn=getLocalizedContentString("ON")||"On";var textOff=getLocalizedContentString("OFF")||"Off";var spanOn=document.createElement('span');spanOn.className="overrideOn";spanOn.innerText=textOn;spanOn.id="overrideSpanOn_"+control.name;spanOn.aligh="center";spanOn.toolTipIndex=0;spanOn.hiddenText=textOn;spanOn.title=VALIDATION_TOOL_TIP_TEXT[spanOn.toolTipIndex];var spanOff=document.createElement('span');spanOff.className="overrideOff";spanOff.id="overrideSpanOff_"+control.name;spanOff.align="center";spanOff.toolTipIndex=0;spanOff.innerText="    ";spanOff.hiddenText=textOff;spanOff.title=VALIDATION_TOOL_TIP_TEXT[spanOff.toolTipIndex];var checkbox=document.createElement('input');checkbox.type="checkbox";checkbox.name="override_"+control.name;checkbox.className="hidden";checkbox.checked=false;checkbox.id="override_"+control.name;checkbox.attachEvent('onclick',handleCheckboxEvent);wrapperDiv.appendChild(spanOn);wrapperDiv.appendChild(spanOff);overrideLabel.appendChild(checkbox);overrideLabel.appendChild(wrapperDiv);if(control.overrideType&&control.overrideType==='parentonly'){overrideLabel.className="hidden";checkbox.style.display="none";} function handleCheckboxEvent(){return that.swapControl(control);} return overrideLabel;};createOverriddenObj=function(control){if(!control&&!control instanceof MetaDataInfo){alert("Overriding obejct - not a correct type of to override");return;} var o=ObjectHandler.getCloneOfObject(control);if(control.uiType!=='textarea'){o.uiType="textbox";}else{o.uiType=control.uiType;} o.customValidator=undefined;o.override=false;if(o.parent&&o.disabled){o.defaultValue="";} return o;};function AnalysisInfo(isPresent,isActive,analysisName,analysisId,siteName){this.isActive=isActive;this.isPresent=isPresent;this.analysisName=analysisName;this.analysisId=analysisId;this.siteName=siteName;} function _extractMetaData(jsonMetadataObjs,validators,events,stepFixlet,containerId){var bh=new BinaryHelpers();var jsonMetadataObjs;var actionParams;var events;var fixletMessages;var fixletInfo;for(p in jsonMetadataObjs){var jsonMetadataObj=jsonMetadataObjs[p];var cntId=jsonMetadataObj.Name+this.uniqueContainerId;if(jsonMetadataObj.UIType&&jsonMetadataObj.UIType.toLowerCase()=="wizard"){this.addUIContainer(containerId,jsonMetadataObj);this._extractMetaData(jsonMetadataObj.Values,validators,events,stepFixlet,cntId);} else if(jsonMetadataObj.UIType&&jsonMetadataObj.UIType.toLowerCase()=="wizardpage"){this.addUIContainer(containerId,jsonMetadataObj);this._extractMetaData(jsonMetadataObj.Values,validators,events,stepFixlet,cntId);} else if(jsonMetadataObj.UIType&&jsonMetadataObj.UIType.toLowerCase()=="accordion"){this.addUIContainer(containerId,jsonMetadataObj);this._extractMetaData(jsonMetadataObj.Values,validators,events,stepFixlet,cntId);} else{var metaDataObj=new MetaDataInfo();containerId=containerId||this.uniqueContainerId;metaDataObj.uiContainerId=containerId;metaDataObj.name=jsonMetadataObj.Name+this.idSuffix;metaDataObj.title=getLocalizedString(jsonMetadataObj.Name,jsonMetadataObj.Title,"Title",gMetaDataObjects);var defaultValue=null;if(typeof stepFixlet!='undefined'){if(stepFixlet.parameters){var params=JSON.parse(stepFixlet.parameters);for(var i=0,len=params.length;i<len;i++){if(jsonMetadataObj.Name===params[i].name){defaultValue=params[i].default_value;metaDataObj.defaultDisabled=params[i].disabled;break;}}}} if(defaultValue!=null){metaDataObj.defaultSetting=defaultValue;metaDataObj.useDefaultOnRender=true;}else{metaDataObj.defaultValue=jsonMetadataObj.Default;} if('1'==jsonMetadataObj.Required){metaDataObj.title=metaDataObj.title;metaDataObj.required=true;} if(jsonMetadataObj.UIType){metaDataObj.uiType=jsonMetadataObj.UIType.toLowerCase();} metaDataObj.values=jsonMetadataObj.Values;metaDataObj.dataType=jsonMetadataObj.DataType;metaDataObj.keys=jsonMetadataObj.Values;if(jsonMetadataObj.Description){metaDataObj.description=getLocalizedString(jsonMetadataObj.Name,jsonMetadataObj.Description,"Description",gMetaDataObjects);}else{metaDataObj.description=metaDataObj.title;} if(jsonMetadataObj.BinaryHelper){var h=jsonMetadataObj.BinaryHelper.toLowerCase();if(h.length>4&&h.substr(0,4)=="url-"){var inst=h.substr(4);if(bh.helpers[inst]==undefined){bh.helpers[inst]=new BinaryHelper();} bh.helpers[inst].urlID=jsonMetadataObj.Name+this.idSuffix;metaDataObj.binaryHelper=bh.helpers[inst];}else if(h.length>5&&h.substr(0,5)=="sha1-"){var inst=h.substr(5);if(bh.helpers[inst]==undefined){bh.helpers[inst]=new BinaryHelper();} bh.helpers[inst].sha1ID=jsonMetadataObj.Name+this.idSuffix;} else if(h.length>5&&h.substr(0,5)=="sha2-"){var inst=h.substr(5);if(bh.helpers[inst]==undefined){bh.helpers[inst]=new BinaryHelper();} bh.helpers[inst].sha2ID=jsonMetadataObj.Name+this.idSuffix;} else if(h.length>5&&h.substr(0,5)=="size-"){var inst=h.substr(5);if(bh.helpers[inst]==undefined){bh.helpers[inst]=new BinaryHelper();} bh.helpers[inst].sizeID=jsonMetadataObj.Name+this.idSuffix;}} if(jsonMetadataObj.Override&&jsonMetadataObj.Override.toLowerCase()!=='false'){metaDataObj.override=true;metaDataObj.overrideType=jsonMetadataObj.Override.toLowerCase();} if(jsonMetadataObj.Disabled&&jsonMetadataObj.Disabled.toLowerCase()==='true'){metaDataObj.disabled=true;} if(jsonMetadataObj.Visible&&jsonMetadataObj.Visible.toLowerCase()==='false'){metaDataObj.visible=false;} if(jsonMetadataObj.Sort&&jsonMetadataObj.Sort.toLowerCase()==='true'){metaDataObj.sort=true;} if(jsonMetadataObj.CustomValidator){metaDataObj.customValidator=jsonMetadataObj.CustomValidator;metaDataObj.customValidatorFunc=validators[jsonMetadataObj.CustomValidator];if(!metaDataObj.customValidatorFunc){metaDataObj.customValidatorFunc=eval(jsonMetadataObj.CustomValidator);}} if(jsonMetadataObj.CustomEvents){for(var eventLen=0;eventLen<jsonMetadataObj.CustomEvents.length;eventLen++){theEventFunc=events[jsonMetadataObj.CustomEvents[eventLen].action];if(theEventFunc){metaDataObj.customEvents[jsonMetadataObj.CustomEvents[eventLen].event]=events[jsonMetadataObj.CustomEvents[eventLen].action];}else{metaDataObj.customEvents[jsonMetadataObj.CustomEvents[eventLen].event]=jsonMetadataObj.CustomEvents[eventLen].action;}}} if(jsonMetadataObj.Parent){metaDataObj.parent=jsonMetadataObj.Parent+this.idSuffix;} if(jsonMetadataObj.ValueType){metaDataObj.valueType=jsonMetadataObj.ValueType.toLowerCase();} if(!metaDataObj.title){metaDataObj.title=jsonMetadataObj.Name;} if(jsonMetadataObj.Encrypt&&jsonMetadataObj.Encrypt==='true'){metaDataObj.encrypt=jsonMetadataObj.Encrypt;gMetaDataObjects.encryptables[jsonMetadataObj.Name]="";} if(jsonMetadataObj.SubUIType){metaDataObj.subUIType=jsonMetadataObj.SubUIType.toLowerCase();} if(jsonMetadataObj.FormOnly&&jsonMetadataObj.FormOnly.toLowerCase()==='true'){metaDataObj.formOnly=true;} this.metaDataInfos.push(metaDataObj);}}} function fromJsonToMetaDataObj(mimeDataTagsObj,stepFixlet){var jsonMetadataObjs;var actionParams;var validators;var events;var fixletMessages;var fixletInfo;if(typeof mimeDataTagsObj["ParameterMetadataTag"]!=undefined){if(typeof mimeDataTagsObj["ParameterMetadataTag"]=="string"){jsonMetadataObjs=vrtEval('(' +mimeDataTagsObj["ParameterMetadataTag"]+')');}else{jsonMetadataObjs=mimeDataTagsObj["ParameterMetadataTag"];}} if(typeof mimeDataTagsObj["FixletActionParams"]!=undefined){if(typeof mimeDataTagsObj["FixletActionParams"]=="string"){actionParams=vrtEval('('+mimeDataTagsObj["FixletActionParams"] +')');}else{actionParams=mimeDataTagsObj["FixletActionParams"];}} if(typeof mimeDataTagsObj["ParameterValidatorTag"]!=undefined){if(typeof mimeDataTagsObj["ParameterValidatorTag"]=="string"){validators=vrtEval('('+mimeDataTagsObj["ParameterValidatorTag"] +')');}else{validators=mimeDataTagsObj["ParameterValidatorTag"];}} if(typeof mimeDataTagsObj["ParameterCustomEventsTag"]!=undefined){if(typeof mimeDataTagsObj["ParameterCustomEventsTag"]=="string"){events=vrtEval('('+mimeDataTagsObj["ParameterCustomEventsTag"] +')');}else{events=mimeDataTagsObj["ParameterCustomEventsTag"];} if(events&&typeof events["onFixletRender"]!=="undefined"){gMetaDataObjects.onFixletRender=events["onFixletRender"];}} if(typeof mimeDataTagsObj["ParameterFixletInfoTag"]!=undefined){if(typeof mimeDataTagsObj["ParameterFixletInfoTag"]=="string"){fixletInfo=vrtEval('(' +mimeDataTagsObj["ParameterFixletInfoTag"]+')');}else{fixletInfo=mimeDataTagsObj["ParameterFixletInfoTag"];} gMetaDataObjects.fixletInfo=fixletInfo;} if(typeof mimeDataTagsObj["ParameterMessagesTag"]!=undefined){if(typeof mimeDataTagsObj["ParameterMessagesTag"]=="string"){fixletMessages=vrtEval('(' +mimeDataTagsObj["ParameterMessagesTag"]+')');}else{fixletMessages=mimeDataTagsObj["ParameterMessagesTag"];} gMetaDataObjects.fixletMessages=fixletMessages;} this._extractMetaData(jsonMetadataObjs,validators,events,stepFixlet);for(var i=0;i<actionParams.length;i++){actionParamInMeta=false;var mdInfoLen=this.metaDataInfos.length;for(mp=0;mp<mdInfoLen&&actionParamInMeta==false;mp++){if((actionParams[i].name+this.idSuffix).toLowerCase()==this.metaDataInfos[mp].name.toLowerCase()){actionParamInMeta=true;}} if(!actionParamInMeta){mdInfo=new MetaDataInfo();mdInfo.name=actionParams[i].name+this.idSuffix;mdInfo.title=actionParams[i].name;if(typeof stepFixlet!='undefined'){if(stepFixlet.parameters){var params=JSON.parse(stepFixlet.parameters);for(var j=0;j<params.length;j++){if(actionParams[i].name==params[j].name){mdInfo.defaultSetting=params[j].default_value;mdInfo.defaultDisabled=params[j].disabled;mdInfo.useDefaultOnRender=true;}}}} mdInfo.value=actionParams[i].default_value;mdInfo.description=actionParams[i].description;mdInfo.uiType="textbox";this.metaDataInfos.push(mdInfo);}} if(stepFixlet){stepFixlet["metaDataObjects"]=gMetaDataObjects;}} function DivsElementsContainer(){this.divs=[];} function hasActiveAnalysis(analysisInfo){var isError=false;if(analysisInfo!=undefined){for(var i=0;i<analysisInfo.length&&!isError;i++){if(analysisInfo[i].isPresent==false){isError=true;} else if(analysisInfo[i].isActive==false){isError=true;}}} return isError;} function getAnalysisListOf(jsonAnalysisObj){if(jsonAnalysisObj==undefined){return;}else{jsonAnalysisObj=vrtEval('('+jsonAnalysisObj+')');} var analysisRelQuery="";var analysisInfoArray=[];for(p in jsonAnalysisObj){try{var currentSite=EvaluateRelevance("(name of it ) of current bes site");var analysisIdQuery='(id of it ) of bes fixlet whose (name of it = \"' +jsonAnalysisObj[p].Name +'\" and site of it = current bes site)';var analysisId=EvaluateRelevance(analysisIdQuery);analysisRelQuery='(active flag of it) of best activations of fixlets whose (analysis flag of it and name of it = \"' +jsonAnalysisObj[p].Name+'\" ) of current bes site';var relQueryResult=EvaluateRelevance(analysisRelQuery)[0];if(relQueryResult=="True"||relQueryResult=="true"){analysisInfoArray.push(new AnalysisInfo(true,true,jsonAnalysisObj[p].Name,analysisId,currentSite));}else{analysisInfoArray.push(new AnalysisInfo(true,false,jsonAnalysisObj[p].Name,analysisId,currentSite));}}catch(ex){analysisInfoArray.push(new AnalysisInfo(false,false,jsonAnalysisObj[p].Name,analysisId,currentSite));}} return analysisInfoArray;} function swapControl(_metadataInfoObj){var that=this;if(typeof _metadataInfoObj==='undefined'){return null;} var elem=document.getElementById(_metadataInfoObj.name);var chkElemParent=document.getElementById("override_" +_metadataInfoObj.name);if(elem!=null){var swapedControl=this.metaDataObjects.replaceObject(_metadataInfoObj.name);if(swapedControl){var newElem=this.createControl(swapedControl);var parent=elem.parentNode;var existingValue;var existingText;if(elem.type=="select-one"){existingText=elem.options[elem.selectedIndex].text;existingValue=elem.options[elem.selectedIndex].value;}else{existingText=elem.value;existingValue=elem.hiddenValue;} parent.removeChild(elem);parent.appendChild(newElem);if(swapedControl.formOnly==true&&swapedControl.disabled==true&&swapedControl.override==false){newElem.value=elem.value;}else{if(newElem.type=="select-one"){for(var i=0;i<newElem.options.length;i++){if(newElem.options[i].value==existingValue){newElem.options[i].selected=true;break;}}}else{newElem.value=existingText;newElem.hiddenValue=existingValue;}} newElem.attachEvent('onchange',makeHandler(swapedControl.name,swapedControl.dependents,this));_attachCustomEvents(newElem,swapedControl,this.metaDataObjects);if(document.createEventObject){var evt=document.createEventObject();newElem.fireEvent('onChange',evt);} var parentChkElem=document.getElementById("override_" +_metadataInfoObj.name);var parentSpanOn=document.getElementById("overrideSpanOn_" +_metadataInfoObj.name);var parentSpanOff=document.getElementById("overrideSpanOff_" +_metadataInfoObj.name);var temp=parentSpanOff.className;parentSpanOff.className=parentSpanOn.className;parentSpanOn.className=temp;if(parentSpanOn.toolTipIndex==0){parentSpanOn.toolTipIndex=1;}else{parentSpanOn.toolTipIndex=0;} if(parentChkElem.checked){setHTML(parentSpanOff,parentSpanOff.hiddenText);parentSpanOn.innerText="    ";}else{setHTML(parentSpanOn,parentSpanOn.hiddenText);parentSpanOff.innerText="    ";} parentSpanOn.title=VALIDATION_TOOL_TIP_TEXT[parentSpanOn.toolTipIndex];parentSpanOff.title=VALIDATION_TOOL_TIP_TEXT[parentSpanOn.toolTipIndex];swapDependents(parentChkElem.checked);}} function swapDependents(parentState){var dependents=_metadataInfoObj.dependents;for(var i=0;i<dependents.length;i++){var theDependent=FixletUtils.getMetadataInfoObj(dependents[i],that.metaDataObjects);var isOverridden=(swapedControl.override||theDependent.override);var chkElem=document.getElementById("override_" +theDependent.name);var childSpanOn=document.getElementById("overrideSpanOn_" +theDependent.name);;var childSpanOff=document.getElementById("overrideSpanOff_" +theDependent.name);;;if((chkElem==null&&isOverridden==false)||typeof that.metaDataObjects.overriddenObjects[theDependent.name]==='undefined'){continue;} if(parentState){var infoObj=_metadataInfoObj;while(infoObj.overrideType&&infoObj.overrideType=="parentonly"){infoObj=FixletUtils.getMetadataInfoObj(infoObj.parent,that.metaDataObjects);} var toolTipText=VALIDATION_TOO_TIP_PARENT_DISABLED.replace(/<FIELDNAME>/i,infoObj.title);toolTipText=toolTipText.replace(/:/i,"");if(chkElem.checked){chkElem.disabled=true;childSpanOff.style.color="grey";childSpanOff.title=toolTipText;childSpanOn.title=toolTipText;}else{chkElem.disabled=false;chkElem.click();chkElem.disabled=true;childSpanOff.style.color="grey";childSpanOn.title=toolTipText;childSpanOff.title=toolTipText;}}else{if(chkElem.checked){chkElem.disabled=false;childSpanOff.style.color="black";childSpanOff.title=VALIDATION_TOOL_TIP_TEXT[1];childSpanOn.title=VALIDATION_TOOL_TIP_TEXT[1];chkElem.click();}}}}} refreshDependents=function(parent,dependentsArray){var element=document.getElementById(parent);var parentInfoObj=FixletUtils.getMetadataInfoObj(parent,this.metaDataObjects);var parentSelected='';if(element){if(element.type=="select-one"&&element.selectedIndex>-1){parentSelected=element.options[element.selectedIndex].text;}else{parentSelected=element.value;if(parentInfoObj.controlBuffer){element.hiddenValue=parentInfoObj.controlBuffer[element.value];}}} for(var i=0;i<dependentsArray.length;i++){var theDependent=FixletUtils.getMetadataInfoObj(dependentsArray[i],this.metaDataObjects);theDependent.useDefaultOnRender=false;theDependent.defaultSetting=null;var uiControl=document.getElementById(theDependent.name);if(theDependent.valueType&&theDependent.valueType.toLowerCase()=="hybrid"){noDataFound=msg_please_select;} var uiType=theDependent.uiType;if(uiType.toLowerCase()=="textbox"||uiType.toLowerCase()=="textarea"){this.populateTextBox(uiControl,theDependent);}else if(uiType.toLowerCase()==="select"){uiControl.options.length=0;this.populateSelectList(uiControl,theDependent);}else if(uiType.toLowerCase()==="multilinetext"){this.populateMultiLineText(uiControl,theDependent);} if(document.createEventObject){var evt=document.createEventObject();uiControl.fireEvent('onChange',evt);}}};function makeHandler(parent,dependents,guiRenderer){return function(){guiRenderer.refreshDependents(parent,dependents);};} function renderErrors(errorDO,metadataObj,allParamsArray){var uniqueSuffix=metadataObj.idSuffix;var errorDivID=getErrorDivId(uniqueSuffix);var errorDiv=document.getElementById(errorDivID);var msg_errorStr="<br/> <b>"+msg_correctProblems+"  </b> <br/> ";for(var ap=0;ap<allParamsArray.length;++ap){var element=document.getElementById("elementErrorDiv_" +allParamsArray[ap].name);if(element){element.style.display="none";}} if(errorDO.length>0){setHTML(errorDiv,msg_errorStr);theHtmlStr="<div style=\"text-align: left; margin: 1em auto; width: 98%;\"> <ul > ";for(index in errorDO){var field=errorDO[index].type!=null?errorDO[index].type:errorDO[index].name;var errorStr=FixletUtils.trimStr(errorDO[index].errorStr);if(errorStr!==""){theHtmlStr=theHtmlStr+"<li> <b> "+field+"</b> " +errorStr+"</li> ";} var elemWithError=document.getElementById("elementErrorDiv_" +errorDO[index].id);var mdInfo=FixletUtils.getMetadataInfoObj(errorDO[index].id,metadataObj);if(elemWithError&&errorStr!==""){setHTML(elemWithError,FixletUtils.trimStr(errorDO[index].errorStr));elemWithError.style.display="block";} var container=metadataObj.getUIContainer(mdInfo.uiContainerId);if(container&&typeof container.container.handleError!=="undefined"){container.container.handleError();}} setHTML(errorDiv,errorDiv.innerHTML+theHtmlStr+"</ul> </div>");errorDiv.style.display="block";} else{errorDiv.style.display="none";errorDiv.innerText="";}} function isNumber(n){var parsedint=parseInt(n);return((!isNaN(parsedint))&&parsedint+""===n&&isFinite(n));} function isDecimal(n){var parsedFloat=parseFloat(n);return((!isNaN(parsedFloat))&&parsedFloat==n&&isFinite(n));} function isText(t){return(/^[a-z0-9\s\-\_]+$/i.test(t));} document.body.ontakeaction=function(event){var jsonParamsObj=FixletUtils.validateParams(gMetaDataObjects);if(!jsonParamsObj){return false;} var currentVersion=vrt_getCurrentVersion();var toEncryptParamsObj={};if(typeof TakeSecureFixletAction!=="undefined"){for(toEncrypt in gMetaDataObjects.encryptables){toEncryptParamsObj[toEncrypt]=jsonParamsObj[toEncrypt];delete jsonParamsObj[toEncrypt];} var action = event.contentID; if ( typeof action === 'undefined' ){action = 'Action1';} try{TakeSecureFixletAction(EvaluateRelevance('id of current fixlet'),0xffffffff&EvaluateRelevance('id of current bes site'),action,jsonParamsObj,toEncryptParamsObj,function(id){});}catch(e){TakeSecureFixletAction(EvaluateRelevance('id of current fixlet'),EvaluateRelevance('id of current bes site'),action,jsonParamsObj,toEncryptParamsObj,function(id){});}}else{try{TakeFixletAction(EvaluateRelevance('id of current fixlet'),0xffffffff&EvaluateRelevance('id of current bes site'),action,jsonParamsObj,function(id){});}catch(e){TakeFixletAction(EvaluateRelevance('id of current fixlet'),EvaluateRelevance('id of current bes site'),action,jsonParamsObj,function(id){});}} return false;};createControl=function(_metadataInfo){var generatedElem=null;if(_metadataInfo.uiType==="select"){generatedElem=this.addSelectList(_metadataInfo);} else if(_metadataInfo.uiType==="textbox"){generatedElem=this.addTextBox(_metadataInfo);} else if(_metadataInfo.uiType==="multilinetext"){generatedElem=this.addMultiLineText(_metadataInfo);} else if(_metadataInfo.uiType==="textarea"){generatedElem=this.addTextArea(_metadataInfo);} return generatedElem;};renderGUI=function(control){if(!control instanceof MetaDataInfo){alert("Not correct type of object to render");return;} if(control.binaryHelper!=null){this.addBinaryControl(control.binaryHelper);} var generatedElem=null;var overriddenElem=null;var elements=[];generatedElem=this.createControl(control);if(generatedElem!=null){if(control.override==true){this.metaDataObjects.addObject(control);overriddenElem=this.createOverrideControl(control);elements.push(overriddenElem);}else{elements.push(document.createTextNode(""));} if(control.subUIType&&control.subUIType.toLowerCase()=="password"){var titleNode=document.createTextNode("*"+control.title);var c=document.createElement('div');c.id="title_"+control.name;c.appendChild(titleNode);if(vrt_getCurrentVersion().major<9||!control.encrypt||control.encrypt.toLowerCase()!="true"){var d=document.createElement('div');var w=document.createTextNode(ENCRYPTION_WARN);d.style.color='red';d.appendChild(w);c.appendChild(d);} elements.push(c);}else{var titleDiv=document.createElement('div');titleDiv.id="title_"+control.name;var titleText=control.required==true?"*"+control.title:control.title;var titleNode=document.createTextNode(titleText);titleDiv.appendChild(titleNode);elements.push(titleDiv);} var generatedElemDiv=document.createElement('div');var errorSpan=document.createElement('div');errorSpan.style.color="red";errorSpan.id="elementErrorDiv_"+control.name;generatedElemDiv.appendChild(errorSpan);generatedElemDiv.appendChild(generatedElem);elements.push(generatedElemDiv);} if(elements.length>0){var rows=this.createRow(elements.length,control.name,((control.uiContainerId)?"tbl_"+control.uiContainerId:control.uiContainerId));for(var i=0;i<elements.length;++i){rows[0].align="center";rows[0].style.verticalAlign='middle';rows[0].width="10%";rows[0].style.whiteSpace="nowrap";rows[1].style.paddingLeft="10px";rows[1].style.verticalAlign='middle';rows[2].style.paddingLeft="10px";rows[2].style.verticalAlign='middle';rows[i].style.border="1px solid white";rows[i].style.background="#F0F5F5";rows[i].appendChild(elements[i]);} rows[1].onmouseover=function(event){tooltip.show(control.description,200);};rows[1].onmouseout=function(event){tooltip.hide();};if(control.encrypt==true){_setVisible(false,control.name);} if(control.visible==false){_setVisible(false,control.name);}} return generatedElem;};function renderAnalysisInfo(analysisInfo,divContainer,uniqueSuffix){var div=null;if(divContainer){div=divContainer.divs[0];}else{div=document.getElementById(getAnalysisInfoDivId(uniqueSuffix));} if(div==undefined||div==null||analysisInfo==undefined){return;} listHtml="<b>"+msg_AnalysisNotFound+"</b> <br/>";listHtml=listHtml +"<strong>"+msg_warning+": </strong> "+msg_analysisNotActiveNotExists+":<br/> &nbsp;";listHtml=listHtml +"<div style=\"width:100%; align:left\"><table  style=\"text-align:left;\"> <tr> <td> ";var isError=false;for(var i=0;i<analysisInfo.length;i++){if(i>0){listHtml=listHtml+"<tr><td>";} if(analysisInfo[i].isPresent==false){isError=true;listHtml=listHtml+"<li>"+analysisInfo[i].analysisName +" - "+msg_notPresent+" </li>";} else if(analysisInfo[i].isActive==false){isError=true;linkRelQuery='(links of it) of fixlets (' +analysisInfo[i].analysisId +') of bes site whose (name of it = \"' +analysisInfo[i].siteName+'\")';listHtml=listHtml+"<li>"+EvaluateRelevance(linkRelQuery) +" -  </li>";} if(i==0){listHtml+=FixletUtils.strf('</td><td style="padding-left: 50px" rowspan="{0}"><button type="button" onclick="activateAnalysis(\'{1}\')"> '+msg_activate+'</button></td></tr>',[analysisInfo.length,uniqueSuffix]);}else{listHtml=listHtml+"</td> </tr>";}} if(isError==true){listHtml=listHtml+"</table></div> ";listHtml=listHtml +"<br/>"+msg_mustActivateAnalysis+"</div>";setHTML(div,listHtml);div.style.display="block";}else{div.style.display="none";div.innerText="";}} function activateAnalysis(uniqueSuffix){if(gMetaDataObjects.analysisJson==undefined){return;} var analysisInfo=getAnalysisListOf(gMetaDataObjects.analysisJson);nonActiveAnalysis=[];for(var i=0;i<analysisInfo.length;i++){try{var currentSiteID=EvaluateRelevance("(id of it) of bes site whose (name of it = \"" +analysisInfo[i].siteName+"\")");}catch(analysisEx){currentSiteID=0;} if(analysisInfo[i].isPresent==true&&analysisInfo[i].isActive==false){nonActiveAnalysis.push(currentSiteID+":" +analysisInfo[i].analysisId);}} if(nonActiveAnalysis.length>0){ActivateAnalyses(nonActiveAnalysis);renderAnalysisInfo(getAnalysisListOf(gMetaDataObjects.analysisJson),null,uniqueSuffix);}} function createRow(numCol,fieldName,tableId){var rowIdPrefix="row_";tableId=tableId||this.paramTable.id;var ptable=document.getElementById(tableId);var row=ptable.insertRow(ptable.rows.length);row.id=rowIdPrefix+fieldName;var colArray=new Array(numCol);for(var i=0;i<colArray.length;i++){colArray[i]=row.insertCell(i);} return colArray;} FixletUtils.isVisible=function(elementName,metadataObj){var prefix="row_";if(typeof metadataObj==='undefined'||metadataObj==null){metadataObj=gMetaDataObjects;} elementName=prefix+elementName+metadataObj.idSuffix;return _isVisible(elementName);};function _isVisible(elementName){var element=document.getElementById(elementName);var visible=true;if(element&&(element.style.display=='none'||element.style.visibility=='hidden')){visible=false;} return visible;};FixletUtils.setVisible=function(shouldVisible,elementName,metadataObj){if(typeof metadataObj==='undefined'||metadataObj==null){metadataObj=gMetaDataObjects;} elementName=elementName+metadataObj.idSuffix;var infoObj=FixletUtils.getMetadataInfoObj(elementName,metadataObj);infoObj.visible=shouldVisible;_setVisible(shouldVisible,elementName);};function _setVisible(shouldVisible,elementName){rowIdPrefix="row_";elementName=rowIdPrefix+elementName;var element=document.getElementById(elementName);if(element&&typeof element!=="undefined"){if(shouldVisible==false){element.style.display='none';}else{element.style.display='block';}}} function deleteColumn(tableId){var ptable=document.getElementById(tableId);for(var i=ptable.rows.length-1;i>=0;i--){ptable.rows[i].deleteCell(0);}} function addDefaultIcon(metadataObjects){for(var j=0;j<metadataObjects.metaDataInfos.length;j++){if(metadataObjects.metaDataInfos[j].defaultSetting&&metadataObjects.metaDataInfos[j].defaultSetting!=""){var element=document.getElementById(metadataObjects.metaDataInfos[j].name);if(element.nodeName==="OPTION"||element.nodeName==="INPUT"||element.nodeName==="SELECT"){var img=document.createElement("IMG");img.src="bullet_green.png";img.title=Messages.getMessage("saveDefaultsParamTooltip").replace(new RegExp('\"',"gi"),'&#34;');element.parentElement.appendChild(img);}}}} function delColDefaultSettings(metadataObjects,tableID){var version=vrt_getCurrentVersion();if(version.major>="9"){for(var j=0;j<metadataObjects.metaDataInfos.length;j++){if(metadataObjects.metaDataInfos[j].encrypt=="true"){var element=document.getElementById(metadataObjects.metaDataInfos[j].name);element.disable=true;element.readOnly=true;element.style.backgroundColor="#D8D8D8";element.title=Messages.getMessage("saveDefaultsSecureParam").replace(new RegExp('\"',"gi"),'&#34;');}}} var ptable=document.getElementById(tableID);for(var i=ptable.rows.length-1;i>=0;i--){if(ptable.rows[i].cells.length>2){ptable.rows[i].deleteCell(0);}}} function Validator(){var errorStr="";this.setErrorStr=function(errorVal){errorStr=errorVal;};this.getErrorStr=function(){return errorStr;};} function extractParams(scriptText){var parameterPattern=/\s*action\s+parameter\s+query\s+"([0-9a-zA-Z_\-]+)"\s*(.*)/i;var descriptionPattern=/with\s+description\s+"([^"]+)"/i;var defaultPattern=/with\s+default\s+(value\s+)*"([^"]+)"/i;var result=[];var lines=scriptText.split('\n');for(li=0;li<lines.length;li++){var line=lines[li];var commentPos=line.indexOf("//");if(commentPos!=-1){line=line.substring(0,commentPos);} var matches=line.match(parameterPattern);if(matches!=null){var paramRec={name:matches[1],description:null,default_value:null};var paramOptions=matches[2];var descriptionMatch=paramOptions.match(descriptionPattern);if(descriptionMatch!=null){paramRec.description=descriptionMatch[1];} var defaultMatch=paramOptions.match(defaultPattern);if(defaultMatch!=null){paramRec.default_value=defaultMatch[defaultMatch.length-1];} result.push(paramRec);}} return result;} function getLocalizedContentString(key,controlName,metadataObjects){var result=null;var fixletId=null;if(typeof metadataObjects!=='undefined'&&typeof metadataObjects.fixletInfo!=='undefined'){var fixletInfo=metadataObjects.fixletInfo["FixletInfo"];fixletId=fixletInfo["fixletInfoId"];} if(typeof vrt_contents!='undefined'&&key){var keyToSend=String(key).toLowerCase();keyToSend=keyToSend.replace(/[^\w]/gi,'_');keyToSend=keyToSend+"_";if(typeof controlName!=='undefined'&&fixletId!=null){result=vrt_contents[fixletId+"_"+controlName+"_" +keyToSend];} if(!result&&fixletId!=null){result=vrt_contents[fixletId+"_"+keyToSend];} if(!result){result=vrt_contents[keyToSend];} if(!result){result=key;}}else{result=key;} return result;} function getLocalizedString(controlName,controlField,propertyName,metadataObjects){var localizedString=controlField;if(typeof vrt_localized!=='undefined'&&typeof metadataObjects.fixletInfo!=='undefined'){var fixletInfo=metadataObjects.fixletInfo["FixletInfo"];var str=fixletInfo["fixletInfoId"]+"_Param_"+controlName+"_" +propertyName;localizedString=vrt_localized[str];if(typeof localizedString==='undefined'||(localizedString===str)){localizedString=controlField;}} return localizedString;} function getLocalizedCustomError(keyName,metadataObjects){var localizedString;var errorKey;var argArray=[];if(keyName instanceof Object){errorKey=keyName["errorKey"];argArray=keyName["argArray"];localizedString=FixletUtils.strf(errorKey,argArray);}else{localizedString=errorKey=keyName;} if(typeof vrt_localized!=='undefined'&&typeof metadataObjects.fixletInfo!=='undefined'){var fixletInfo=metadataObjects.fixletInfo["FixletInfo"];var str=errorKey;localizedString=FixletUtils.strf(vrt_localized[str],argArray);if(typeof localizedString==='undefined'||(localizedString===str)){var theMessage=metadataObjects.fixletMessages["FixletGlobalMessages"];if(theMessage!=undefined){localizedString=FixletUtils.strf(theMessage[errorKey],argArray);}} if(typeof localizedString==='undefined'||localizedString==""){localizedString=errorKey;}} return localizedString;} function getParamTableValue(metaObject,fieldName){if(typeof metaObject==='undefined'||metaObject==null){metaObject=gMetaDataObjects;} fieldName=fieldName+metaObject.idSuffix;var allParamsArray=metaObject.metaDataInfos;var paramValue="";var p=0;for(;p<allParamsArray.length;p++){var paramField=document.getElementById(allParamsArray[p].name);if(paramField.name===fieldName){if(paramField.type=="select-one"&&paramField.selectedIndex>-1){paramValue=paramField.options[paramField.selectedIndex].value;}else{if(typeof allParamsArray[p].controlBuffer!=='undefined'){paramValue=allParamsArray[p].controlBuffer[paramField.value];if(typeof paramValue==='undefined'){paramValue="norelevanceresult";}}else{paramValue=paramField.value;}} break;}} if(paramValue.toLowerCase()==="norelevanceresult"){paramValue=-1;} return paramValue;};FixletUtils.getDomElement=function(elementName,metadataObj){if(typeof metadataObj==='undefined'||metadataObj==null){metadataObj=gMetaDataObjects;} elementName=elementName+metadataObj.idSuffix;var element=document.getElementById(elementName);return element;};FixletUtils.setRequired=function(strElementName,boolRequired,metadataObj){if(typeof metadataObj==='undefined'||metadataObj==null){metadataObj=gMetaDataObjects;} strElementName=strElementName+metadataObj.idSuffix;if(typeof strElementName==='undefined'){return;} var infoObj=FixletUtils.getMetadataInfoObj(strElementName,metadataObj);infoObj.required=boolRequired;var textContainer=document.getElementById("title_"+strElementName);var textNode=textContainer.firstChild;if(boolRequired){textNode.data=FixletUtils.trimStr(textNode.data).charAt(0)!=='*'?'*'+textNode.data:textNode.data;} else{textNode.data=FixletUtils.trimStr(textNode.data).charAt(0)==='*'?textNode.data.slice(1,textNode.data.lenght):textNode.data;}};FixletUtils.disableField=function(elementName,disabled,metadataObj){if(typeof metadataObj==='undefined'||metadataObj==null){metadataObj=gMetaDataObjects;} elementName=elementName+metadataObj.idSuffix;var element=document.getElementById(elementName);if(typeof element!=='undefined'){var infoObj=FixletUtils.getMetadataInfoObj(elementName,metadataObj);infoObj.disabled=disabled;if(element.type=="select-one"){element.disabled=disabled;}else{if(infoObj.defaultValue&&infoObj.defaultValue!=""){element.value=infoObj.defaultValue;}else{element.value="";} element.readOnly=disabled;} var bgColor=disabled==true?"#D8D8D8":"WHITE";element.style.backgroundColor=bgColor;}};roundNumber=function(num,dec){var result=Math.round(num*Math.pow(10,dec))/Math.pow(10,dec);return result;};bytesToGigaBytes=function(bytes){return roundNumber(bytes/1073741824,2);};gigaBytesToKiloBytes=function gigaBytesToKiloBytes(gBytes){return gBytes*1048576;};kiloBytesToGigaBytes=function(kBytes){return kBytes/1048576;};function setFormValue(formName,name,val){var form=getForm(formName);var value="";if(null!=form&&form.elements){var field="";for(var i=0;i<form.elements.length;i++){var field=form.elements[i];if(!field.disabled&&field.name==name){field.value=val;return true;}}}else{alert("Form is null or elements not found");} return false;} function getForm(formName){if(document.getElementsByTagName){var forms=document.getElementsByTagName("FORM");for(var i=0;i<forms.length;i++){if(forms[i].name==formName){return forms[i];}else{}}}else{return document.forms[formName];} return null;} function BinaryHelper(){this.urlID=null;this.sha1ID=null;this.sha2ID=null;this.sizeID=null;this.updateFields=function(val){var jsobj=vrtEval('('+val+')');var fixletForm="fixletForm"+jsobj.idSuffix;var fileUrl='';var temVersion=FixletUtils.getCurrentVersion();if(jsobj.size){fileUrl=EvaluateRelevance("url of current bes server") +"/Uploads/"+jsobj.sha1.toLowerCase()+"/"+jsobj.filename;if(temVersion.major>=9&&temVersion.minor>=1){if(_isVisible(this.sha1ID)){setFormValue(fixletForm,this.sha1ID,jsobj.sha1);} setFormValue(fixletForm,this.urlID,fileUrl);setFormValue(fixletForm,this.sizeID,jsobj.size);var that=this;CompleteHashSet('sha1',jsobj.sha1,{success:function(resp){if(_isVisible(that.sha2ID)){setFormValue(fixletForm,that.sha2ID,resp.sha256);}},failure:function(err){}});} else if(jsobj.size){setFormValue(fixletForm,this.urlID,fileUrl);setFormValue(fixletForm,this.sha1ID,jsobj.sha1);setFormValue(fixletForm,this.sizeID,jsobj.size);}}};} function BinaryHelpers(){this.helpers=[];} function addBinaryControl(binaryHelper){var control=new MetaDataInfo();control.name="binaryHelper_"+binaryHelper.urlID;var defaultValue="";if(binaryHelper.rawDefaultSettings&&binaryHelper.rawDefaultSettings!=""){var rawDefSettings=eval(binaryHelper.rawDefaultSettings);for(var i=0;i<rawDefSettings.length;i++){if(rawDefSettings[i].name==control.name){defaultValue=rawDefSettings[i].default_value;break;}}} control.title=msg_selectBinaryFile;control.description=msg_binaryFileHelpMsg;control.uiType="Select";control.valueType="relevance";rowCells=this.createRow(3);rowCells[0].align="center";rowCells[0].style.verticalAlign='middle';rowCells[0].width="80px";rowCells[0].style.border="1px solid white";rowCells[0].style.paddingTop="10px";rowCells[0].style.background="#F0F5F5";rowCells[1].style.paddingLeft="10px";rowCells[1].width="250px";rowCells[1].style.verticalAlign='middle';rowCells[1].style.border="1px solid white";rowCells[1].style.paddingTop="10px";rowCells[1].style.background="#F0F5F5";rowCells[2].style.paddingLeft="10px";rowCells[2].style.verticalAlign='middle';rowCells[2].style.border="1px solid white";rowCells[2].style.paddingTop="10px";rowCells[2].style.background="#F0F5F5";var textNode=document.createTextNode(control.title);rowCells[1].onmouseover=function(event){tooltip.show(control.description,200);};rowCells[1].onmouseout=function(event){tooltip.hide();};rowCells[1].appendChild(textNode);var select=document.createElement(control.uiType);select.name=control.name;select.id=control.name;select.onchange=function(){binaryHelper.updateFields(this.value);};var relQueryResult=EvaluateRelevance('values of variables whose (name of it starts with "SWD_Package") of bes wizards whose(dashboard id of it = "SoftwareDistribution.ojo")');try{var inc=0;var attr=msg_please_select;var val='{"sha1" : "" , "filename" : "" , "size" : "" }';select.options[inc++]=new Option(attr,val);for(var i=0;i<relQueryResult.length;i++){var jsobj=vrtEval('('+relQueryResult[i]+')');for(var j=0;j<jsobj.files.length;j++){attr=jsobj.vendor+"-"+jsobj.product+" (" +jsobj.version+") ["+jsobj.files[j].filename+"]";val='{"sha1" : "'+jsobj.files[j].sha1 +'" , "filename" : "'+jsobj.files[j].filename +'.bfswd" , "size" : "'+jsobj.files[j].size+'", ' +'idSuffix: "'+gMetaDataObjects.idSuffix+'" ' +'}';var newOption=new Option(attr,val);if(val==defaultValue){newOption.selected=true;} select.options[inc++]=newOption;}}}catch(e){var er=msg_errorExtractingDataFromDashBoard;alert(er);} rowCells[2].appendChild(select);} var tooltip=function(){var id='tooltip';var top=3;var left=3;var maxw=300;var speed=10;var timer=20;var endfade=95;var afade=0;var tt,t,c,b,h;var ie=document.all?true:false;return{show:function(v,w){if(tt==null){tt=document.createElement('div');vrtSetAttribute(tt,'id',id);tt.style.display='block';tt.style.position='absolute';tt.style.zIndex='5000';t=document.createElement('div');vrtSetAttribute(t,'id',id+'top');t.style.display='block';t.style.height='5px';t.style.overflow='hidden';c=document.createElement('div');vrtSetAttribute(c,'id',id+'cont');c.style.display='block';c.style.margin='5px';c.style.color='black';c.style.wordWrap='break-word';c.style.background='#F2F5A9';c.className="toolTipCSS";c.style.borderWidth;b=document.createElement('div');vrtSetAttribute(b,'id',id+'bot');b.style.display='block';b.style.height='5px';b.style.overflow='hidden';tt.appendChild(t);tt.appendChild(c);tt.appendChild(b);document.body.appendChild(tt);tt.style.opacity=0;tt.style.filter='alpha(opacity=0)';document.onmousemove=this.pos;} tt.style.display='block';setHTML(c,v);tt.style.width=w?w+'px':'auto';if(!w&&ie){t.style.display='none';b.style.display='none';tt.style.width=tt.offsetWidth;t.style.display='block';b.style.display='block';} if(tt.offsetWidth>maxw){tt.style.width=maxw+'px';} h=parseInt(tt.offsetHeight)+top;clearInterval(tt.timer);tt.timer=vrtSetInterval(function(){tooltip.fade(1);},timer);},pos:function(e){var u=ie?event.clientY +((document.documentElement&&document.documentElement.scrollTop)||document.body.scrollTop):e.pageY;var l=ie?event.clientX +((document.documentElement&&document.documentElement.scrollLeft)||document.body.scrollLeft):e.pageX;tt.style.top=(u-h)+'px';tt.style.left=(l+left)+'px';},fade:function(d){var a=afade;if((a!=endfade&&d==1)||(a!=0&&d==-1)){var i=speed;if(endfade-a<speed&&d==1){i=endfade-a;}else if(afade<speed&&d==-1){i=a;} afade=a+(i*d);tt.style.opacity=afade*.01;tt.style.filter='alpha(opacity='+afade+')';}else{clearInterval(tt.timer);if(d==-1){tt.style.display='none';}}},hide:function(){if(tt&&tt.timer){clearInterval(tt.timer);tt.timer=vrtSetInterval(function(){tooltip.fade(-1);},timer);}}};}();FixletUtils.getLocalizedContentString=function(str){return getLocalizedContentString(str);};FixletUtils.getElementText=function(elementName,metadataObj){var element=FixletUtils.getDomElement(elementName,metadataObj);var elementText='';if(element){if(element.type=="select-one"&&element.selectedIndex!=-1){elementText=element.options[element.selectedIndex].text;}else{elementText=element.value;}} return elementText;};FixletUtils.getElementValue=function(elementName,metadataObj){var element=FixletUtils.getDomElement(elementName,metadataObj);var elementValue='';if(element){if(element.type=="select-one"&&element.selectedIndex!=-1){elementValue=element.options[element.selectedIndex].value;}else{if(element.hiddenValue){elementValue=element.hiddenValue;}else{elementValue=element.value;}}} return elementValue;};FixletUtils.setElementValue=function(elementName,textString,metadataObj){if(typeof metadataObj==='undefined'||metadataObj==null){metadataObj=gMetaDataObjects;} var element=null;var infoObj=FixletUtils.getMetadataInfoObj(elementName +metadataObj.idSuffix,metadataObj);if(!infoObj){return;} element=FixletUtils.getDomElement(elementName,metadataObj);if(element){if(element.type=="select-one"){element.value=textString;}else{element.hiddenValue=textString;}}else{infoObj.defaultValue=textString;}};FixletUtils.setElementTextValue=function(elementName,textValueArray,metadataObj){var text=textValueArray[0];var value=textValueArray[1];FixletUtils.setElementText(elementName,text,metadataObj);FixletUtils.setElementValue(elementName,text,metadataObj);};FixletUtils.compareFields=function(srcElementName,destElementName,metadataObj){var srcText=FixletUtils.getElementText(srcElementName,metadataObj);var destText=FixletUtils.getElementText(srcElementName,metadataObj);return srcText===destText;};FixletUtils.setElementText=function(elementName,textString,metadataObj){if(typeof metadataObj==='undefined'||metadataObj==null){metadataObj=gMetaDataObjects;} var element=null;var infoObj=FixletUtils.getMetadataInfoObj(elementName +metadataObj.idSuffix,metadataObj);if(!infoObj){return;} infoObj.initialValue["value"]=textString;element=FixletUtils.getDomElement(elementName,metadataObj);if(element){if(element.type=="select-one"){element.options[element.selectedIndex].text=textString;}else{element.value=textString;element.hiddenValue=textString;infoObj.defaultValue=textString;} var evt=document.createEventObject();element.fireEvent('onChange',evt);}else{infoObj.defaultValue=textString;}};FixletUtils.getElementDefaultValue=function(eleName,metadataObj){var infoObj=FixletUtils.getMetadataInfoObj(eleName+metadataObj.idSuffix,metadataObj);var retValue=null;if(infoObj){retValue=infoObj.defaultValue;} return retValue;};FixletUtils.getMetadataInfoObj=function(objectName,metadataObj){if(!metadataObj instanceof MetaDataObjects){alert("Invalid type of metadat Objects");} var allParamsArray=metadataObj.metaDataInfos;var p=0;for(;p<allParamsArray.length;p++){if(objectName===allParamsArray[p].name){return allParamsArray[p];}} return null;};var ObjectHandler={getCloneOfObject:function(oldObject){var tempClone={};if(typeof(oldObject)=="object") for(prop in oldObject){if((typeof(oldObject[prop])=="object")&&(oldObject[prop])instanceof Array){tempClone[prop]=this.getCloneOfArray(oldObject[prop]);} else if(oldObject[prop]&&typeof(oldObject[prop])=="object"){tempClone[prop]=this.getCloneOfObject(oldObject[prop]);}else{tempClone[prop]=oldObject[prop];}} return tempClone;},getCloneOfArray:function(oldArray){var tempClone=[];for(var arrIndex=0;arrIndex<oldArray.length;arrIndex++){if(oldArray[arrIndex]&&typeof(oldArray[arrIndex])=="object"){tempClone.push(this.getCloneOfObject(oldArray[arrIndex]));}else{tempClone.push(oldArray[arrIndex]);}} return tempClone;}};function debug_alert(o,header){if(header==undefined){header="";} if(o&&typeof o=='object'){var strObj=header+"\n";for(v in o){strObj+=v+":"+o[v]+"\n";} alert(strObj);}} var _attachCustomEvents=function(domElem,metaDataInfo,metadataObjects){for(evtType in metaDataInfo.customEvents){_addEventTo(domElem,evtType,metaDataInfo.customEvents[evtType],metadataObjects);}};var _addEventTo=function(element,type,handlerFunc,metadataObjects){if(!element.eventContainer){element.eventContainer={};} if(!element.eventContainer[type]){element.eventContainer[type]=[];element[type]=function(){for(var i=0;i<element.eventContainer[type].length;i++){if(typeof eval(element.eventContainer[type][i])!=='undefined'){eval(element.eventContainer[type][i])(element,metadataObjects);}}};} element.eventContainer[type].push(handlerFunc);};FixletUtils.setSelectList=function(elementName,optionsArray,metadataObj){var element=FixletUtils.getDomElement(elementName,metadataObj);element.options.length=0;if(element&&element.type=="select-one"){for(var elemCount=0;elemCount<optionsArray.length;++elemCount){var key=optionsArray[elemCount];var value=optionsArray[elemCount][1]!==undefined?optionsArray[elemCount][1]:optionsArray[elemCount];element.options[elemCount]=new Option(key,value);}}};function uiContainer(parentId,name,uiType,title,description){var children=new Array();return{getName:function(){return name;},getType:function(){return uiType;},getTitle:function(){return title;},getDescription:function(){return description;},getParent:function(){return parentId;},addChild:function(child){children.push(child);},getChildren:function(){return children;}};} function newPage(pageName){var thePage=document.createElement('div');thePage.style.width='100%';thePage.id=pageName;var pageTable=document.createElement("table");pageTable.id="tbl_"+pageName;var tableBody=pageTable.appendChild(document.createElement('tbody'));createHeaderRow();thePage.appendChild(pageTable);pageTable.style.width="100%";thePage.getTable=function(){return pageTable;};function createHeaderRow(){var row=pageTable.insertRow(pageTable.rows.length);row.id="header_"+pageTable.id;var colArray=new Array(3);for(var i=0;i<colArray.length;i++){colArray[i]=row.insertCell(i);colArray[i].style.paddingLeft="10px";colArray[i].style.paddingRight="5px";colArray[i].style.background="F0F5F5";colArray[i].style.paddingTop="10px";} setHTML(colArray[0],"<b>"+HEADER_VALIDATION+"</b>");colArray[0].style.width="10%";colArray[0].style.whiteSpace="nowrap";setHTML(colArray[1],"<b>"+HEADER_PARAM_NAME+"</b>");colArray[1].style.width="30%";setHTML(colArray[2],"<b>"+HEADER_PARAM_VALUE+"</b>");colArray[2].style.width='60%';return colArray;};var insertColumn=function(columnHeader,colIndex){var tblBodyObj=document.getElementById(pageTable.id).tBodies[0];for(var i=0;i<tblBodyObj.rows.length;i++){var newCell=tblBodyObj.rows[i].insertCell(colIndex);}};return{getPage:function(){return thePage;}};};var newAccordion=function(guiRenderer,containerElement){var hasClass=function(node,name){var className=node.className;if(className.indexOf(' ')==-1) return className==name;var classNames=className.split(/\s+/);for(i in classNames){if(classNames[i]==name) return true;} return false;};var myToggleSectionVisibility=function(){myToggleSectionVisibilityOfImage(window.event.srcElement,true);};var collaps=function(el,scroll){var collapseImg=BASE_PATH+"collapse.gif";var expandImg=BASE_PATH+"expand.gif";var im=el;while(im.tagName!='IMG') im=el.firstChild;while(!hasClass(el,'sectionHeader')) el=el.parentNode;while(!hasClass(el,'sectionBody')) el=el.nextSibling;while(!hasClass(el,'sectionContents')) el=el.firstChild;if(el.style.display==''){el.style.display='none';im.src=expandImg;expanded=false;}};var expand=function(el,scroll){var collapseImg=BASE_PATH+"collapse.gif";var expandImg=BASE_PATH+"expand.gif";var im=el;while(im.tagName!='IMG') im=el.firstChild;while(!hasClass(el,'sectionHeader')) el=el.parentNode;while(!hasClass(el,'sectionBody')) el=el.nextSibling;while(!hasClass(el,'sectionContents')) el=el.firstChild;var oldScrollHeight=document.body.scrollHeight;el.style.display='';im.src=collapseImg;if(!scroll) return;var sectionParent=el;while(!hasClass(sectionParent,'section')) sectionParent=sectionParent.parentElement;var parentTop=sectionParent.offsetTop;while(sectionParent=sectionParent.offsetParent) parentTop+=sectionParent.offsetTop;var ot=el.offsetTop;while(el=el.offsetParent) ot+=el.offsetTop;var elBottom=ot+(document.body.scrollHeight-oldScrollHeight);var visibleBottom=document.body.scrollTop+document.body.clientHeight;if(visibleBottom<elBottom){if(document.body.scrollTop+elBottom-visibleBottom>ot) document.body.scrollTop=parentTop;else document.body.scrollTop+=elBottom-visibleBottom;} expanded=true;};var myToggleSectionVisibilityOfImage=function(el,scroll){if(expanded==true){collaps(el,scroll);}else{expand(el,scroll);}};var expanded=true;var mainSection=guiRenderer.createSection("accordion_"+containerElement.getName());var sectionHeader=document.createElement("h2");var sectionBody=guiRenderer.createSection("secBody_"+containerElement.getName());var sectionContent=guiRenderer.createSection("secContent_"+containerElement.getName());var page=newPage(containerElement.getName());var ecImage=document.createElement('img');ecImage.id="ecImg_"+containerElement.getName();ecImage.className='collapse';ecImage.src=BASE_PATH+"collapse.gif";ecImage.onclick=myToggleSectionVisibility;mainSection.className='section';sectionHeader.className='sectionHeader';sectionHeader.appendChild(ecImage);sectionHeader.appendChild(document.createTextNode(containerElement.getTitle()));sectionBody.className='sectionBody';sectionContent.className='sectionContents';page.getPage().className="vrtSubsection";mainSection.appendChild(sectionHeader);mainSection.appendChild(sectionBody);sectionBody.appendChild(sectionContent);sectionContent.appendChild(page.getPage());guiRenderer.fixletForm.appendChild(mainSection);return{getPage:function(){return page;},isExpanded:function(){return expanded;},setExpanded:function(boolState){if(boolState==true){expand(ecImage,false);} else if(boolState==false){collaps(ecImage,false);}},handleError:function(errorToHandle){if(ecImage){expand(ecImage,false);}}};};function getBaseScriptPath(){var scriptsTag=document.getElementsByTagName("script");for(scriptIndex in scriptsTag){basePath=scriptsTag[scriptIndex].src;if(basePath&&basePath.indexOf("wizards.js")>0){return(basePath.substring(0,basePath.indexOf("wizards.js")));}}}               ]]></Value>
		</MIMEField>
		<MIMEField>
			<Name>x-fixlet-modification-time</Name>
			<Value>Mon, 07 Dec 2015 19:38:53 +0000</Value>
		</MIMEField>
		<Delay>P28D</Delay>
	</Task>
</BES>
